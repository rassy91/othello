!function(){const t=function(t){this.ctx=t,this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.color="#ffffff",this.isWhite=1,this.board=[],this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let o=1;o<t.LINE_NUMBER;o++){let o=[];for(let e=1;e<t.LINE_NUMBER;e++)o.push({});t.board.push(o)}},drawBoard:function(){const t=this,o=t.GRID_SIZE*(t.LINE_NUMBER-1);let e=0,i=0;t.drawRect(e,i,o,o,"#008833");for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(e,0,e,o),e+=t.GRID_SIZE;for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(0,i,o,i),i+=t.GRID_SIZE},drawRect:function(t,o,e,i,n){this.ctx.fillStyle=void 0!==n?n:"#000000",this.ctx.fillRect(t,o,e,i)},drawLine:function(t,o,e,i,n,s){this.ctx.strokeStyle=void 0!==n?n:"#000000",this.ctx.lineWidth=void 0!==s?s:1,this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,o=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),e=t.GRID_SIZE/2;let i,n,s=-1,c=-1,h=1,l={r:t.R};function r(r){for(let f=0;f<2;f++){i=o+s*e,n=o+c*e,l.x=i,l.y=n,l.color=r;let f=new window.myOthello.Stone(t.ctx,l);f.drawArc(l);let a=t.board[Math.floor(n/t.GRID_SIZE)][Math.floor(i/t.GRID_SIZE)];a.instance=f,a.isWhite=h,s*=-1,c*=-1}}r("#ffffff"),s*=-1,h*=-1,r("#000000"),console.log(t.board)},putStone:function(t,o){let e=Math.floor(t/this.GRID_SIZE),i=Math.floor(o/this.GRID_SIZE);this.isWhite*=-1,color=this.isWhite>0?"#ffffff":"#000000";let n={x:this.GRID_SIZE*e+this.GRID_SIZE/2,y:this.GRID_SIZE*i+this.GRID_SIZE/2,r:this.R,color:color},s=new window.myOthello.Stone(this.ctx,n);s.drawArc(n);let c=this.board[i][e];c.instance=s,c.isWhite=this.isWhite},checkVacancy:function(t,o){return this.stonePoses.filter(function(e){return e.pos[0]===t&&e.pos[1]===o}).length},checkNeighbor:function(t,o){const e=this;let i=!1,n=[[t,o+1],[t+1,o+1],[t+1,o],[t+1,o-1],[t,o-1],[t-1,o-1],[t-1,o],[t-1,o+1]];for(let s=0,c=e.stonePoses.length;s<c;s++){for(let t=0,o=n.length;t<o;t++)if(e.stonePoses[s].pos[0]===n[t][0]&&e.stonePoses[s].pos[1]===n[t][1]){i=!0;break}if(i)break}return i},checkAvailability:function(t,o){const e=this,i=7;let n=0,s=!1;!function(){n=0;let c=!1;for(let n=0,h=e.stonePoses.length;n<h;n++){for(let h=0;h<i&&!(o-h<0);h++)if(e.stonePoses[n].pos[0]===t&&e.stonePoses[n].pos[1]===o-h&&e.stonePoses[n].isWhite===-1*e.isWhite){console.log(e.stonePoses[n]);for(let t=1;t<h;t++)if(e.stonePoses[n].pos[1]===o-t&&e.stonePoses[n].isWhite===e.isWhite){console.log(e.stonePoses[n]),c=!0,s=!0;break}}if(c)break}}()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,o){this.canvas=t,this.color=o.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,o){this.ctx=t,this.color=o.color};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const o=document.getElementById("wrapper"),e=t.getContext("2d");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJHUklEX1NJWkUiLCJMSU5FX05VTUJFUiIsIlIiLCJjb2xvciIsImlzV2hpdGUiLCJib2FyZCIsImluaXQiLCJwcm90b3R5cGUiLCJzZWxmIiwidHJhbnNsYXRlIiwiZHJhd0JvYXJkIiwiaSIsInJvdyIsImoiLCJwdXNoIiwiZmllbGRTaXplIiwieCIsInkiLCJkcmF3UmVjdCIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJzdGFydEdhbWUiLCJjZW50ZXIiLCJkaWZmIiwicG9zWCIsInBvc1kiLCJkaXIxIiwiZGlyMiIsImRhdGEiLCJyIiwic2V0Rmlyc3RTdG9uZSIsInN0b25lIiwid2luZG93IiwibXlPdGhlbGxvIiwiU3RvbmUiLCJkcmF3QXJjIiwib2JqIiwiTWF0aCIsImZsb29yIiwiaW5zdGFuY2UiLCJjb25zb2xlIiwibG9nIiwicHV0U3RvbmUiLCJjbGlja2VkWCIsImNsaWNrZWRZIiwibnRoR3JpZFgiLCJudGhHcmlkWSIsImNoZWNrVmFjYW5jeSIsIm50aFgiLCJudGhZIiwic3RvbmVQb3NlcyIsImZpbHRlciIsInZhbCIsInBvcyIsImxlbmd0aCIsImNoZWNrTmVpZ2hib3IiLCJoYXNOZWlnaGJvciIsIm5laWdoYm9ycyIsImxlbiIsImNoZWNrQXZhaWxhYmlsaXR5IiwiTUFYX0NPVU5UIiwiY291bnQiLCJpc0F2YWlsYWJsZSIsInRtcEZsYWciLCJrIiwiY2hlY2tUb3AiLCJQbGF5ZXIiLCJjYW52YXMiLCJzdG9uZXMiLCJzZXRFdmVudCIsImdldENsaWNrUG9zIiwiYXJjIiwiUEkiLCJmaWxsIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwid3JhcHBlciIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZSIsIm9mZnNldFgiLCJvZmZzZXRZIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUVBLE1BQUFBLEVBQUEsU0FBQUMsR0FDQUMsS0FFQUQsSUFBQUEsRUFGQUMsS0FJQUMsVUFBQSxHQUpBRCxLQUtBRSxZQUFBLEVBTEFGLEtBTUFHLEVBQUEsR0FOQUgsS0FNQUMsVUFOQUQsS0FRQUksTUFBQSxVQVJBSixLQVNBSyxRQUFBLEVBVEFMLEtBV0FNLFNBWEFOLEtBYUFPLFFBR0FULEVBQUFVLFdBS0FELEtBQUEsV0FDQSxNQUFBRSxFQUFBVCxLQUdBUyxFQUFBVixJQUFBVyxVQUFBLEVBQUEsR0FFQUQsRUFBQUUsWUFFQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUgsRUFBQVAsWUFBQVUsSUFBQSxDQUNBLElBQUFDLEtBRUEsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEVBQUFMLEVBQUFQLFlBQUFZLElBQ0FELEVBQUFFLFNBR0FOLEVBQUFILE1BQUFTLEtBQUFGLEtBS0FGLFVBQUEsV0FDQSxNQUFBRixFQUFBVCxLQUVBZ0IsRUFBQVAsRUFBQVIsV0FBQVEsRUFBQVAsWUFBQSxHQUVBLElBQUFlLEVBQUEsRUFDQUMsRUFBQSxFQUVBVCxFQUFBVSxTQUFBRixFQUFBQyxFQUFBRixFQUFBQSxFQUFBLFdBRUEsSUFBQSxJQUFBSixFQUFBLEVBQUFBLEdBQUFILEVBQUFQLFlBQUFVLElBQ0FILEVBQUFXLFNBQUFILEVBQUEsRUFBQUEsRUFBQUQsR0FDQUMsR0FBQVIsRUFBQVIsVUFFQSxJQUFBLElBQUFXLEVBQUEsRUFBQUEsR0FBQUgsRUFBQVAsWUFBQVUsSUFDQUgsRUFBQVcsU0FBQSxFQUFBRixFQUFBRixFQUFBRSxHQUNBQSxHQUFBVCxFQUFBUixXQUtBa0IsU0FBQSxTQUFBRSxFQUFBQyxF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QyxHQUVBTyxFQUFBNkIsWUFFQThDLEVBQUFRLGlCQUFBLFFBQUEsU0FBQU8sR0FFQTFGLEVBQUFrRCxTQUFBd0MsRUFBQUMsUUFBQUQsRUFBQUUiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IEJvYXJkTWFuYWdlciA9IGZ1bmN0aW9uKGN0eCkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmN0eCA9IGN0eDtcblxuICAgICAgICBzZWxmLkdSSURfU0laRSA9IDUwO1xuICAgICAgICBzZWxmLkxJTkVfTlVNQkVSID0gOTtcbiAgICAgICAgc2VsZi5SID0gc2VsZi5HUklEX1NJWkUgKiAwLjM7XG5cbiAgICAgICAgc2VsZi5jb2xvciA9ICcjZmZmZmZmJztcbiAgICAgICAgc2VsZi5pc1doaXRlID0gMTtcblxuICAgICAgICBzZWxmLmJvYXJkID0gW107XG5cbiAgICAgICAgc2VsZi5pbml0KCk7XG4gICAgfTtcblxuICAgIEJvYXJkTWFuYWdlci5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqXG4gICAgICAgICAqL1xuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyB4PTAsIHk9MOOBp+WFiOOBruWkquOBleOBjOWNiuWIhuOBl+aPj+WGmeOBleOCjOOBquOBhOOBn+OCgeOAgeWfuua6lueCueOCkuOBmuOCieOBmVxuICAgICAgICAgICAgc2VsZi5jdHgudHJhbnNsYXRlKDEsIDEpO1xuXG4gICAgICAgICAgICBzZWxmLmRyYXdCb2FyZCgpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCByb3cgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgc2VsZi5MSU5FX05VTUJFUjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5wdXNoKHt9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLmJvYXJkLnB1c2gocm93KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdCb2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgZmllbGRTaXplID0gc2VsZi5HUklEX1NJWkUgKiAoc2VsZi5MSU5FX05VTUJFUiAtIDEpO1xuXG4gICAgICAgICAgICBsZXQgeCA9IDA7XG4gICAgICAgICAgICBsZXQgeSA9IDA7XG5cbiAgICAgICAgICAgIHNlbGYuZHJhd1JlY3QoeCwgeSwgZmllbGRTaXplLCBmaWVsZFNpemUsICcjMDA4ODMzJyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoeCwgMCwgeCwgZmllbGRTaXplKTtcbiAgICAgICAgICAgICAgICB4ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kcmF3TGluZSgwLCB5LCBmaWVsZFNpemUsIHkpO1xuICAgICAgICAgICAgICAgIHkgKz0gc2VsZi5HUklEX1NJWkU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3UmVjdDogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFJlY3QoeDEsIHkxLCB4MiwgeTIpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd0xpbmU6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBjb2xvciwgd2lkdGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2VTdHlsZSA9IHR5cGVvZiBjb2xvciAhPT0gJ3VuZGVmaW5lZCcgPyBjb2xvciA6ICcjMDAwMDAwJztcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVXaWR0aCA9IHR5cGVvZiB3aWR0aCAhPT0gJ3VuZGVmaW5lZCcgPyB3aWR0aCA6IDE7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHgubW92ZVRvKHgxLCB5MSk7XG4gICAgICAgICAgICBzZWxmLmN0eC5saW5lVG8oeDIsIHkyKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2UoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHN0YXJ0R2FtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgY2VudGVyID0gc2VsZi5HUklEX1NJWkUgKiAoKHNlbGYuTElORV9OVU1CRVIgLSAxKSAvIDIpO1xuICAgICAgICAgICAgY29uc3QgZGlmZiA9IChzZWxmLkdSSURfU0laRSAvIDIpO1xuICAgICAgICAgICAgbGV0IGRpcjEgPSAtMTtcbiAgICAgICAgICAgIGxldCBkaXIyID0gLTE7XG4gICAgICAgICAgICBsZXQgcG9zWCwgcG9zWTtcbiAgICAgICAgICAgIGxldCBpc1doaXRlID0gMTtcbiAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHI6IHNlbGYuUlxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2V0Rmlyc3RTdG9uZSgnI2ZmZmZmZicpO1xuICAgICAgICAgICAgZGlyMSAqPSAtMTtcbiAgICAgICAgICAgIGlzV2hpdGUgKj0gLTE7XG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCcjMDAwMDAwJyk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldEZpcnN0U3RvbmUoY29sb3IpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBwb3NYID0gY2VudGVyICsgZGlyMSAqIGRpZmY7XG4gICAgICAgICAgICAgICAgICAgIHBvc1kgPSBjZW50ZXIgKyBkaXIyICogZGlmZjtcblxuICAgICAgICAgICAgICAgICAgICBkYXRhLnggPSBwb3NYO1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnkgPSBwb3NZO1xuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbG9yID0gY29sb3I7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBzdG9uZS5kcmF3QXJjKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBzZWxmLmJvYXJkW01hdGguZmxvb3IocG9zWSAvIHNlbGYuR1JJRF9TSVpFKV1bTWF0aC5mbG9vcihwb3NYIC8gc2VsZi5HUklEX1NJWkUpXTtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmluc3RhbmNlID0gc3RvbmU7XG4gICAgICAgICAgICAgICAgICAgIG9iai5pc1doaXRlID0gaXNXaGl0ZTtcblxuICAgICAgICAgICAgICAgICAgICBkaXIxICo9IC0xO1xuICAgICAgICAgICAgICAgICAgICBkaXIyICo9IC0xO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmJvYXJkKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHB1dFN0b25lOiBmdW5jdGlvbihjbGlja2VkWCwgY2xpY2tlZFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBsZXQgbnRoR3JpZFggPSBNYXRoLmZsb29yKGNsaWNrZWRYIC8gc2VsZi5HUklEX1NJWkUpO1xuICAgICAgICAgICAgbGV0IG50aEdyaWRZID0gTWF0aC5mbG9vcihjbGlja2VkWSAvIHNlbGYuR1JJRF9TSVpFKTtcblxuICAgICAgICAgICAgLy8gaWYgKHNlbGYuY2hlY2tWYWNhbmN5KG50aEdyaWRYLCBudGhHcmlkWSkgPiAwKSB7XG4gICAgICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBpZiAoIXNlbGYuY2hlY2tOZWlnaGJvcihudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAvLyAgICByZXR1cm47XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyBpZiAoIXNlbGYuY2hlY2tBdmFpbGFiaWxpdHkobnRoR3JpZFgsIG50aEdyaWRZKSkge1xuICAgICAgICAgICAgLy8gICAgLy8gcmV0dXJuO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICBzZWxmLmlzV2hpdGUgKj0gLTE7XG4gICAgICAgICAgICBjb2xvciA9IHNlbGYuaXNXaGl0ZSA+IDAgPyAnI2ZmZmZmZicgOiAnIzAwMDAwMCc7XG5cbiAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHg6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRYKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHk6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRZKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHI6IHNlbGYuUixcbiAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGxldCBzdG9uZSA9IG5ldyB3aW5kb3cubXlPdGhlbGxvLlN0b25lKHNlbGYuY3R4LCBkYXRhKTtcbiAgICAgICAgICAgIHN0b25lLmRyYXdBcmMoZGF0YSk7XG5cbiAgICAgICAgICAgIGxldCBvYmogPSBzZWxmLmJvYXJkW250aEdyaWRZXVtudGhHcmlkWF07XG4gICAgICAgICAgICBvYmouaW5zdGFuY2UgPSBzdG9uZTtcbiAgICAgICAgICAgIG9iai5pc1doaXRlID0gc2VsZi5pc1doaXRlO1xuICAgICAgICAgICAgXG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hlY2tWYWNhbmN5OiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHNlbGYuc3RvbmVQb3Nlcy5maWx0ZXIoZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbC5wb3NbMF0gPT09IG50aFggJiYgdmFsLnBvc1sxXSA9PT0gbnRoWTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0Lmxlbmd0aDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNoZWNrTmVpZ2hib3I6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBsZXQgaGFzTmVpZ2hib3IgPSBmYWxzZTtcblxuICAgICAgICAgICAgbGV0IG5laWdoYm9ycyA9IFtcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSArIDFdLCAgICAgICAvLyDkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgKyAxXSwgICAvLyDlj7PkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFldLCAgICAgICAvLyDlj7NcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgLSAxXSwgICAvLyDlj7PkuItcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSAtIDFdLCAgICAgICAvLyDkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgLSAxXSwgICAvLyDlt6bkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFldLCAgICAgICAvLyDlt6ZcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgKyAxXSAgICAvLyDlt6bkuIpcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBzZWxmLnN0b25lUG9zZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgbGVuID0gbmVpZ2hib3JzLmxlbmd0aDsgaiA8IGxlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzBdID09PSBuZWlnaGJvcnNbal1bMF0gJiYgc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1sxXSA9PT0gbmVpZ2hib3JzW2pdWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNOZWlnaGJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaGFzTmVpZ2hib3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gaGFzTmVpZ2hib3I7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hlY2tBdmFpbGFiaWxpdHk6IGZ1bmN0aW9uKGNsaWNrZWRYLCBjbGlja2VkWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGNvbnN0IE1BWF9DT1VOVCA9IDc7XG4gICAgICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICAgICAgbGV0IHRtcEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBpc0F2YWlsYWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAvLyDnva7jgZHjgovmnaHku7ZcbiAgICAgICAgICAgIC8vIOW3puWPs+OAgeS4iuS4i+OAgeaWnOOCgTQ15bqm5LiK44Gr5ZCM44GY6Imy44Gu55+z44GM44GC44KLIOOBi+OBpCDjgZ3jga7lkIzjgZjoibLjga7nn7Pjgajoh6rouqvjga7plpPjgavpmpnplpPjgarjgY/liKXjga7oibLjga7nn7PjgYzjgYLjgotcblxuICAgICAgICAgICAgLy8g5LiKICAgIFtudGhYLCBudGhZICsgMV0sXG4gICAgICAgICAgICAvLyDlj7PkuIogICBbbnRoWCArIDEsIG50aFkgKyAxXSxcbiAgICAgICAgICAgIC8vIOWPsyAgICBbbnRoWCArIDEsIG50aFldLFxuICAgICAgICAgICAgLy8g5Y+z5LiLICAgW250aFggKyAxLCBudGhZIC0gMV0sXG4gICAgICAgICAgICAvLyDkuIsgICAgW250aFgsIG50aFkgLSAxXSxcbiAgICAgICAgICAgIC8vIOW3puS4iyAgIFtudGhYIC0gMSwgbnRoWSAtIDFdLFxuICAgICAgICAgICAgLy8g5bemICAgIFtudGhYIC0gMSwgbnRoWV0sXG4gICAgICAgICAgICAvLyDlt6bkuIogICBbbnRoWCAtIDEsIG50aFkgKyAxXVxuICAgICAgICAgICAgLy8g44Gn44Gd44KM44Ge44KM44OB44Kn44OD44Kv44GZ44KL77yfXG5cbiAgICAgICAgICAgIGNoZWNrVG9wKCk7XG5cbiAgICAgICAgICAgIC8vIOS4iuODgeOCp+ODg+OCr1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tUb3AoKSB7XG5cbiAgICAgICAgICAgICAgICBjb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgbGV0IHRtcEZsYWcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBzZWxmLnN0b25lUG9zZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBNQVhfQ09VTlQ7IGorKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xpY2tlZFkgLSBqIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDoh6rouqvjgajlkIzliJfjgYvjgaTlkIzooYzjgavnn7PjgYzjgYLjgorjgIHjgYvjgaTlkIzjgZjoibLjga7loLTlkIjvvIjoh6rouqvjgavov5HjgYTkvY3nva7jgYvjgonliKTlrprvvIlcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzBdID09PSBjbGlja2VkWCAmJiBzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzFdID09PSBjbGlja2VkWSAtIGogJiYgc2VsZi5zdG9uZVBvc2VzW2ldLmlzV2hpdGUgPT09IHNlbGYuaXNXaGl0ZSAqIC0xKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnN0b25lUG9zZXNbaV0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Ieq6Lqr44Go5ZCM5YiX44GL44Gk5ZCM6KGM44Gr44GC44KL5ZCM44GY6Imy44Gu55+z44GL44KJ44CB44GL44Gk5ZCM44GY6Imy44Gu5aC05ZCI77yI6Ieq6Lqr44Gr6L+R44GE5L2N572u44GL44KJ5Yik5a6a77yJXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDE7IGsgPCBqOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMV0gPT09IGNsaWNrZWRZIC0gayAmJiBzZWxmLnN0b25lUG9zZXNbaV0uaXNXaGl0ZSA9PT0gc2VsZi5pc1doaXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLnN0b25lUG9zZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0F2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0bXBGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpc0F2YWlsYWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodG1wRmxhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuXG5cblxuXG5cblxuXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLkJvYXJkTWFuYWdlciA9IEJvYXJkTWFuYWdlcjtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgY29uc3QgUGxheWVyID0gZnVuY3Rpb24oY2FudmFzLCBkYXRhKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHNlbGYuY2FudmFzID0gY2FudmFzO1xuXG4gICAgICAgIHNlbGYuY29sb3IgPSBkYXRhLmNvbG9yO1xuICAgICAgICBzZWxmLnN0b25lcyA9IFtdO1xuXG4gICAgICAgIHNlbGYuaW5pdCgpO1xuICAgIH07XG5cbiAgICBQbGF5ZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuc2V0RXZlbnQoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRFdmVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8gc2VsZi5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZS5vZmZzZXRYKTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0Q2xpY2tQb3M6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cblxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cubXlPdGhlbGxvID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cubXlPdGhlbGxvID0ge307XG4gICAgfVxuICAgIHdpbmRvdy5teU90aGVsbG8uUGxheWVyID0gUGxheWVyO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBjb25zdCBTdG9uZSA9IGZ1bmN0aW9uKGN0eCwgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmN0eCA9IGN0eDtcbiAgICAgICAgc2VsZi5jb2xvciA9IGRhdGEuY29sb3I7XG5cbiAgICB9O1xuXG4gICAgU3RvbmUucHJvdG90eXBlID0ge1xuXG4gICAgICAgIGRyYXdBcmM6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmFyYyhkYXRhLngsIGRhdGEueSwgZGF0YS5yLCAwLCBNYXRoLlBJICogMiwgdHJ1ZSk7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsU3R5bGUgPSBkYXRhLmNvbG9yO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbCgpO1xuICAgICAgICAgICAgc2VsZi5jdHguY2xvc2VQYXRoKCk7XG5cbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cubXlPdGhlbGxvID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cubXlPdGhlbGxvID0ge307XG4gICAgfVxuICAgIHdpbmRvdy5teU90aGVsbG8uU3RvbmUgPSBTdG9uZTtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTtcblxuICAgICAgICBpZiAoIWNhbnZhcy5nZXRDb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyYXBwZXInKTtcbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgIGN0eC5jYW52YXMud2lkdGggPSB3cmFwcGVyLmNsaWVudFdpZHRoO1xuICAgICAgICBjdHguY2FudmFzLmhlaWdodCA9IHdyYXBwZXIuY2xpZW50SGVpZ2h0O1xuXG4gICAgICAgIGxldCBwbGF5ZXJEYXRhID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBudWxsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICd3aGl0ZSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBudWxsLFxuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibGFjaydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG5cbiAgICAgICAgY29uc3QgYm9hcmQgPSBuZXcgbXlPdGhlbGxvLkJvYXJkTWFuYWdlcihjdHgpO1xuXG4gICAgICAgIGJvYXJkLnN0YXJ0R2FtZSgpO1xuXG4gICAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblxuICAgICAgICAgICAgYm9hcmQucHV0U3RvbmUoZS5vZmZzZXRYLCBlLm9mZnNldFkpO1xuICAgICAgICB9KTtcblxuXG4gICAgICAgIC8vIOODleOCo+ODvOODq+ODieOCkuabuOOBj++8iDh4OO+8iVxuICAgICAgICAvLyDlkITjg57jgrnnm67jga7jgqjjg6rjgqLmg4XloLHjgpLkv53mjIHvvIhzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWe+8iVxuICAgICAgICAvLyAgICAgIOOCr+ODquODg+OCr+OBl+OBn+S9jee9ruOBqGNhbnZhc+S4iuOBruS9jee9ruOBruWkieaPm+OBjOW/heimge+8n1xuICAgICAgICAvLyDjg5fjg6zjgqTjg6Tjg7znmb3jg7vpu5LjgpLjgrvjg4Pjg4hcbiAgICAgICAgLy8gICAgICDjg5Xjg6njgrDjgavjgZnjgovvvJ9cbiAgICAgICAgLy8g5Lit5aSu44Gr55m96buSMuOBk+OBmuOBpOOCu+ODg+ODiFxuXG4gICAgICAgIC8vIOWQhOODl+ODrOOCpOODpOODvOOBrue9ruOBhOOBn+efs+OCkuS/neaMgeOBmeOCi+mFjeWIl1xuICAgICAgICAvL1xuXG5cblxuICAgIH0pO1xuXG59KCkpO1xuXG4vKipcbiAqIC8vIFRPRE8g6LOq5ZWPXG4gKlxuICogMS5cbiDjgIzliKTlrprjgZnjgovjgI3jgajjgYTjgYboi7Hoqp7jga/kvZXjgpLkvb/jgaPjgabjgb7jgZnjgYvvvJ9cblxuIGZpbmQ/IGp1ZGdlPyBkZWNpZGU/XG5cblxuIDIuXG4gY2hyb21l44GuZGV244OE44O844Or44Gn44Kk44Oz44K544K/44Oz44K544Gr5YWl44Gj44Gm44GE44KLdOOBqOOBr+OBquOCk+OBruaEj+WRs+OAgeeVpe+8iO+8n++8ieOBp+OBmeOBi++8n+OCpOODs+OCueOCv+ODs+OCueOCkuODreOCsOOBq+WHuuOBmeOBqHTjgajjgarjgovvvJ9cbiBib2FyZC5zdGFydEdhbWXjga7mnIDlvozjgadjb25zb2xlLmxvZyhzZWxmLnN0b25lUG9zZXMpO+OBmeOCi+OBqOeiuuiqjeOBp+OBjeOCi1xuXG4gKi9cbiJdfQ==