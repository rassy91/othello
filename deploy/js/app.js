!function(){const t=function(t){this.ctx=t,this.cautionText=document.getElementById("caution"),this.stoneColorText=document.getElementById("stoneColor"),this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.isWhite=1,this.board=[],this.turnStones=[],this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let e=1;e<t.LINE_NUMBER;e++){let e=[];for(let i=1;i<t.LINE_NUMBER;i++)e.push({});t.board.push(e)}},drawBoard:function(){const t=this,e=t.GRID_SIZE*(t.LINE_NUMBER-1);let i=0,o=0;t.drawRect(i,o,e,e,"#008833");for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(i,0,i,e),i+=t.GRID_SIZE;for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(0,o,e,o),o+=t.GRID_SIZE},drawRect:function(t,e,i,o,n){this.ctx.fillStyle=void 0!==n?n:"#000000",this.ctx.fillRect(t,e,i,o)},drawLine:function(t,e,i,o,n,s){this.ctx.strokeStyle=void 0!==n?n:"#000000",this.ctx.lineWidth=void 0!==s?s:1,this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(i,o),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,e=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),i=t.GRID_SIZE/2;let o,n,s=-1,c=-1,h=1;function l(){for(let l=0;l<2;l++){let l={r:t.R};o=e+s*i,n=e+c*i,l.x=o,l.y=n,l.isWhite=h;let r=new window.myOthello.Stone(t.ctx,l);r.drawArc(l);let a=t.board[Math.floor(n/t.GRID_SIZE)][Math.floor(o/t.GRID_SIZE)];a.instance=r,a.isWhite=h,s*=-1,c*=-1}}l(),s*=-1,h*=-1,l(),console.log(t.board)},showCaution:function(){const t=this;t.cautionText.classList.contains("isVisible")||(t.cautionText.classList.add("isVisible"),setTimeout(function(){t.cautionText.classList.remove("isVisible")},1e3))},putStone:function(t,e){const i=this;let o=Math.floor(t/i.GRID_SIZE),n=Math.floor(e/i.GRID_SIZE);if(!i.checkVacancy(o,n))return void i.showCaution();if(!i.checkNeighbor(o,n))return void i.showCaution();if(!i.checkIfPossible(o,n))return void i.showCaution();i.isWhite*=-1;let s={x:i.GRID_SIZE*o+i.GRID_SIZE/2,y:i.GRID_SIZE*n+i.GRID_SIZE/2,r:i.R,isWhite:i.isWhite},c=new window.myOthello.Stone(i.ctx,s);c.drawArc(s);let h=i.board[n][o];h.instance=c,h.isWhite=i.isWhite,h.x=o,h.y=n,i.turnStones.length>0&&(i.turnStones.forEach(function(t){t.isWhite*=-1,t.instance.reverse()}),i.turnStones.length=0),i.stoneColorText.classList.contains("js-isWhite")?(i.stoneColorText.textContent="黒",i.stoneColorText.classList.remove("js-isWhite")):(i.stoneColorText.textContent="白",i.stoneColorText.classList.add("js-isWhite"))},checkVacancy:function(t,e){return Object.keys(this.board[e][t]).length<=0},checkNeighbor:function(t,e){const i=this;let o,n,s=[[t,e-1],[t+1,e-1],[t+1,e],[t+1,e+1],[t,e+1],[t-1,e+1],[t-1,e],[t-1,e-1]];for(let c=0,h=s.length;c<h;c++)if(o=s[c][0],n=s[c][1],!(o<0||o>7||n<0||n>7)&&Object.keys(i.board[n][o]).length>0)return!0},checkIfPossible:function(t,e){const i=this,o=i.LINE_NUMBER-1-1;let n,s,c,h=!1,l=null,r=null,a=[],d=[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,1],[1,-1],[-1,1]];return function(){for(let f=0,u=d.length;f<u;f++){n=!1,s=d[f][0],c=d[f][1];for(let d=1;!(!(d<=o)||s<0&&e+s*d<0||s>0&&e+s*d>o||c<0&&t+c*d<0||c>0&&t+c*d>o);d++)if(l=i.board[e+s*d][t+c*d],Object.keys(l).length>0&&-1*l.isWhite===i.isWhite){for(let o=1;o<d;o++){if((r=i.board[e+s*o][t+c*o]).y=e+s*o,r.x=t+c*o,!(Object.keys(r).length>0&&r.isWhite===i.isWhite)){n=!1,a.length=0,delete r.x,delete r.y;break}n=!0,a.push(r)}if(n){for(let t=0,e=a.length;t<e;t++)i.turnStones.push(a[t]);a.length=0,h=!0;break}}}}(),h}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,e){this.canvas=t,this.color=e.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,e){this.ctx=t,this.data=e,this.isWhite=e.isWhite};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=this.isWhite>0?"#ffffff":"#000000",this.ctx.fill(),this.ctx.closePath()},reverse:function(){this.isWhite*=-1,this.drawArc(this.data)}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const e=t.getContext("2d"),i=document.getElementById("canvasWrapper");e.canvas.width=i.clientWidth,e.canvas.height=i.clientHeight;const o=new myOthello.BoardManager(e);o.startGame(),t.addEventListener("click",function(t){o.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJjYXV0aW9uVGV4dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdG9uZUNvbG9yVGV4dCIsIkdSSURfU0laRSIsIkxJTkVfTlVNQkVSIiwiUiIsImlzV2hpdGUiLCJib2FyZCIsInR1cm5TdG9uZXMiLCJpbml0IiwicHJvdG90eXBlIiwic2VsZiIsInRyYW5zbGF0ZSIsImRyYXdCb2FyZCIsImkiLCJyb3ciLCJqIiwicHVzaCIsImZpZWxkU2l6ZSIsIngiLCJ5IiwiZHJhd1JlY3QiLCJkcmF3TGluZSIsIngxIiwieTEiLCJ4MiIsInkyIiwiY29sb3IiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJzdGFydEdhbWUiLCJjZW50ZXIiLCJkaWZmIiwicG9zWCIsInBvc1kiLCJkaXIxIiwiZGlyMiIsInNldEZpcnN0U3RvbmUiLCJkYXRhIiwiciIsInN0b25lIiwid2luZG93IiwibXlPdGhlbGxvIiwiU3RvbmUiLCJkcmF3QXJjIiwib2JqIiwiTWF0aCIsImZsb29yIiwiaW5zdGFuY2UiLCJjb25zb2xlIiwibG9nIiwic2hvd0NhdXRpb24iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImFkZCIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJwdXRTdG9uZSIsImNsaWNrZWRYIiwiY2xpY2tlZFkiLCJudGhHcmlkWCIsIm50aEdyaWRZIiwiY2hlY2tWYWNhbmN5IiwiY2hlY2tOZWlnaGJvciIsImNoZWNrSWZQb3NzaWJsZSIsImxlbmd0aCIsImZvckVhY2giLCJ2YWwiLCJyZXZlcnNlIiwidGV4dENvbnRlbnQiLCJudGhYIiwibnRoWSIsIk9iamVjdCIsImtleXMiLCJsaW5lIiwibmVpZ2hib3JzIiwibGVuIiwiTUFYX0NPVU5UIiwiaXNUbXBQb3NzaWJsZSIsImRpclkiLCJkaXJYIiwiaXNQb3NzaWJsZSIsInRtcE9iaiIsInRtcFR1cm5TdG9uZXMiLCJjaGVja0RpcnMiLCJrIiwiY2hlY2siLCJQbGF5ZXIiLCJjYW52YXMiLCJzdG9uZXMiLCJzZXRFdmVudCIsImdldENsaWNrUG9zIiwiYXJjIiwiUEkiLCJmaWxsIiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldENvbnRleHQiLCJ3cmFwcGVyIiwiY2xpZW50V2lkdGgiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJlIiwib2Zmc2V0WCIsIm9mZnNldFkiXSwibWFwcGluZ3MiOiJDQUFBLFdBUUEsTUFBQUEsRUFBQSxTQUFBQyxHQUNBQyxLQUVBRCxJQUFBQSxFQUZBQyxLQUtBQyxZQUFBQyxTQUFBQyxlQUFBLFdBTEFILEtBTUFJLGVBQUFGLFNBQUFDLGVBQUEsY0FOQUgsS0FTQUssVUFBQSxHQVRBTCxLQVVBTSxZQUFBLEVBVkFOLEtBWUFPLEVBQUEsR0FaQVAsS0FZQUssVUFaQUwsS0FnQkFRLFFBQUEsRUFoQkFSLEtBbUJBUyxTQW5CQVQsS0FzQkFVLGNBdEJBVixLQXdCQVcsUUFHQWIsRUFBQWMsV0FLQUQsS0FBQSxXQUNBLE1BQUFFLEVBQUFiLEtBR0FhLEVBQUFkLElBQUFlLFVBQUEsRUFBQSxHQUdBRCxFQUFBRSxZQUdBLElBQUEsSUFBQUMsRUFBQSxFQUFBQSxFQUFBSCxFQUFBUCxZQUFBVSxJQUFBLENBQ0EsSUFBQUMsS0FFQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUwsRUFBQVAsWUFBQVksSUFDQUQsRUFBQUUsU0FHQU4sRUFBQUosTUFBQVUsS0FBQUYsS0FRQUYsVUFBQSxXQUNBLE1BQUFGLEVBQUFiLEtBRUFvQixFQUFBUCxFQUFBUixXQUFBUSxFQUFBUCxZQUFBLEdBRUEsSUFBQWUsRUFBQSxFQUNBQyxFQUFBLEVBRUFULEVBQUFVLFNBQUFGLEVBQUFDLEVBQUFGLEVBQUFB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QUFBLFVBSkFSLEtBS0FELElBQUF5RyxPQUxBeEcsS0FNQUQsSUFBQXVDLGFBT0F3QyxRQUFBLFdBQ0E5RSxLQUVBUSxVQUFBLEVBRkFSLEtBSUFzRCxRQUpBdEQsS0FJQWdELGFBS0EsSUFBQUcsT0FBQUMsWUFDQUQsT0FBQUMsY0FFQUQsT0FBQUMsVUFBQUMsTUFBQUEsRUFsREEsR0NFQW5ELFNBQUF1RyxpQkFBQSxtQkFBQSxXQUVBLE1BQUFQLEVBQUFoRyxTQUFBQyxlQUFBLFVBRUEsSUFBQStGLEVBQUFRLFdBQ0EsT0FHQSxNQUFBM0csRUFBQW1HLEVBQUFRLFdBQUEsTUFDQUMsRUFBQXpHLFNBQUFDLGVBQUEsaUJBQ0FKLEVBQUFtRyxPQUFBbEUsTUFBQTJFLEVBQUFDLFlBQ0E3RyxFQUFBbUcsT0FBQVcsT0FBQUYsRUFBQUcsYUFFQSxNQUFBckcsRUFBQSxJQUFBMkMsVUFBQXRELGFBQUFDLEdBR0FVLEVBQUErQixZQUdBMEQsRUFBQU8saUJBQUEsUUFBQSxTQUFBTSxHQUVBdEcsRUFBQTBELFNBQUE0QyxFQUFBQyxRQUFBRCxFQUFBRSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyI7KGZ1bmN0aW9uKCkge1xuXG4gICAgLyoqXG4gICAgICog44Kz44Oz44K544OI44Op44Kv44K/XG4gICAgICog44Oc44O844OJ44Gu54q25oWL44KS566h55CG44GZ44KLXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGN0eFxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0IEJvYXJkTWFuYWdlciA9IGZ1bmN0aW9uKGN0eCkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmN0eCA9IGN0eDtcblxuICAgICAgICAvLyBET01cbiAgICAgICAgc2VsZi5jYXV0aW9uVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYXV0aW9uJyk7XG4gICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3RvbmVDb2xvcicpO1xuXG4gICAgICAgIC8v5YCkXG4gICAgICAgIHNlbGYuR1JJRF9TSVpFID0gNTA7XG4gICAgICAgIHNlbGYuTElORV9OVU1CRVIgPSA5O1xuICAgICAgICAvLyDnn7Pjga7ljYrlvoRcbiAgICAgICAgc2VsZi5SID0gc2VsZi5HUklEX1NJWkUgKiAwLjM7XG5cbiAgICAgICAgLy8g55m96buS5Yik5a6a44OV44Op44KwXG4gICAgICAgIC8vIDHjgafnmb3jgIEtMeOBp+m7klxuICAgICAgICBzZWxmLmlzV2hpdGUgPSAxO1xuXG4gICAgICAgIC8vIOOBneOCjOOBnuOCjOOBruODnuOCueebruOBruaDheWgseOCkuagvOe0jVxuICAgICAgICBzZWxmLmJvYXJkID0gW107XG5cbiAgICAgICAgLy8g44Gy44Gj44GP44KK6L+U44GZ55+z44KS5LiA5pmC55qE44Gr5qC857SN44GZ44KLXG4gICAgICAgIHNlbGYudHVyblN0b25lcyA9IFtdO1xuXG4gICAgICAgIHNlbGYuaW5pdCgpO1xuICAgIH07XG5cbiAgICBCb2FyZE1hbmFnZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDliJ3mnJ/ljJZcbiAgICAgICAgICovXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHg9MCwgeT0w44Gn5YWI44Gu5aSq44GV44GM5Y2K5YiG44GX5o+P5YaZ44GV44KM44Gq44GE44Gf44KB44CB5Z+65rqW54K544KS44Ga44KJ44GZXG4gICAgICAgICAgICBzZWxmLmN0eC50cmFuc2xhdGUoMSwgMSk7XG5cbiAgICAgICAgICAgIC8vIOODnOODvOODieOCkuaPj+WGmVxuICAgICAgICAgICAgc2VsZi5kcmF3Qm9hcmQoKTtcblxuICAgICAgICAgICAgLy8g5ZCE44Oe44K555uu44Gr5oOF5aCx5L+d5oyB55So44Gu44Kq44OW44K444Kn44Kv44OI44KS44KC44Gf44Gb44Gm44Oc44O844OJ5oOF5aCx44Gu6YWN5YiX44Gr5qC857SNXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCByb3cgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgc2VsZi5MSU5FX05VTUJFUjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5wdXNoKHt9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLmJvYXJkLnB1c2gocm93KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjg5zjg7zjg4njgpLmj4/lhplcbiAgICAgICAgICovXG4gICAgICAgIGRyYXdCb2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgZmllbGRTaXplID0gc2VsZi5HUklEX1NJWkUgKiAoc2VsZi5MSU5FX05VTUJFUiAtIDEpO1xuXG4gICAgICAgICAgICBsZXQgeCA9IDA7XG4gICAgICAgICAgICBsZXQgeSA9IDA7XG5cbiAgICAgICAgICAgIHNlbGYuZHJhd1JlY3QoeCwgeSwgZmllbGRTaXplLCBmaWVsZFNpemUsICcjMDA4ODMzJyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoeCwgMCwgeCwgZmllbGRTaXplKTtcbiAgICAgICAgICAgICAgICB4ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kcmF3TGluZSgwLCB5LCBmaWVsZFNpemUsIHkpO1xuICAgICAgICAgICAgICAgIHkgKz0gc2VsZi5HUklEX1NJWkU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog5Zub6KeS5b2i44KS5o+P5YaZXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHgyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sb3JcbiAgICAgICAgICovXG4gICAgICAgIGRyYXdSZWN0OiBmdW5jdGlvbih4MSwgeTEsIHgyLCB5MiwgY29sb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsU3R5bGUgPSB0eXBlb2YgY29sb3IgIT09ICd1bmRlZmluZWQnID8gY29sb3IgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsUmVjdCh4MSwgeTEsIHgyLCB5Mik7XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog57ea44KS5o+P5YaZXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHgyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sb3JcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3TGluZTogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yLCB3aWR0aCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZVN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHgubGluZVdpZHRoID0gdHlwZW9mIHdpZHRoICE9PSAndW5kZWZpbmVkJyA/IHdpZHRoIDogMTtcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5tb3ZlVG8oeDEsIHkxKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVUbyh4MiwgeTIpO1xuICAgICAgICAgICAgc2VsZi5jdHguY2xvc2VQYXRoKCk7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOOCsuODvOODoOOCueOCv+ODvOODiOaZguOBq+Wun+ihjFxuICAgICAgICAgKi9cbiAgICAgICAgc3RhcnRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBjZW50ZXIgPSBzZWxmLkdSSURfU0laRSAqICgoc2VsZi5MSU5FX05VTUJFUiAtIDEpIC8gMik7XG4gICAgICAgICAgICBjb25zdCBkaWZmID0gKHNlbGYuR1JJRF9TSVpFIC8gMik7XG4gICAgICAgICAgICBsZXQgZGlyMSA9IC0xO1xuICAgICAgICAgICAgbGV0IGRpcjIgPSAtMTtcbiAgICAgICAgICAgIGxldCBwb3NYLCBwb3NZO1xuICAgICAgICAgICAgbGV0IGlzV2hpdGUgPSAxO1xuXG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCk7XG4gICAgICAgICAgICBkaXIxICo9IC0xO1xuICAgICAgICAgICAgaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgIHNldEZpcnN0U3RvbmUoKTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDliJ3mnJ/kvY3nva7jgavnn7PjgpLjgrvjg4Pjg4hcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0Rmlyc3RTdG9uZSgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8g6Ieq5YiG55So44Oh44Oi77ya6Zai5pWw44Gu5aSW5YG044Gn5a6a576p44GX44Gm44GK44KK44CB44Kq44OW44K444Kn44Kv44OI44Gu5Y+C54Wn5rih44GX44Gn5byV44Gj44GL44GL44Gj44GfXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcjogc2VsZi5SXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgcG9zWCA9IGNlbnRlciArIGRpcjEgKiBkaWZmO1xuICAgICAgICAgICAgICAgICAgICBwb3NZID0gY2VudGVyICsgZGlyMiAqIGRpZmY7XG5cbiAgICAgICAgICAgICAgICAgICAgZGF0YS54ID0gcG9zWDtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS55ID0gcG9zWTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc1doaXRlID0gaXNXaGl0ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyDjgqTjg7Pjgrnjgr/jg7PjgrnjgpLkvZzmiJBcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvLyDnn7PjgpLmj4/lhplcbiAgICAgICAgICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyDjg5zjg7zjg4njga7phY3liJfjga7oqbLlvZPkvY3nva7jgavjgqTjg7Pjgrnjgr/jg7Pjgrnjgajnj77lnKjjga7nmb3pu5LnirbmhYvjgpLmoLzntI1cbiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHNlbGYuYm9hcmRbTWF0aC5mbG9vcihwb3NZIC8gc2VsZi5HUklEX1NJWkUpXVtNYXRoLmZsb29yKHBvc1ggLyBzZWxmLkdSSURfU0laRSldO1xuICAgICAgICAgICAgICAgICAgICBvYmouaW5zdGFuY2UgPSBzdG9uZTtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmlzV2hpdGUgPSBpc1doaXRlO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpcjEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGRpcjIgKj0gLTE7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRPRE8gOiDos6rllY/jgZXjgZvjgabjgY/jgaDjgZXjgYTjgIJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuYm9hcmQpO1xuICAgICAgICAgICAgLy8gVE9ETyDkuIrjga7jgojjgYbjgavjg63jgrDjgavlh7rjgZnjgajjgIHku6XkuIvjga7jgojjgYbjgavooajnpLrjgZXjgozjgb7jgZnjgIJcbiAgICAgICAgICAgIC8vIHtcbiAgICAgICAgICAgIC8vICAgICBpbnN0YW5jZTogdCB7a2V5MTogdmFsdWUxLCBrZXkyOiB2YWx1ZTIsIC4uLn0sXG4gICAgICAgICAgICAvLyAgICAga2V5QTogdmFsdWVBLFxuICAgICAgICAgICAgLy8gICAgIC4uLlxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gVE9ETyDjgZPjgZPjga4gJ3QnIOOBqOOBr+OBquOCk+OBruaEj+WRs+OAgeOBguOCi+OBhOOBr+OBquOCk+OBruWNmOiqnuOBrueVpeOBp+OBl+OCh+OBhuOBi++8n1xuICAgICAgICAgICAgLy8gVE9ETyDvvIjjgqTjg7Pjgrnjgr/jg7PjgrnjgYzlhaXjgovjgaggJ3QnIOOBqOOBquOCi+OBruOBi+OBqOaAneOBhOOBvuOBmeOBjOOAgeacrOW9k+OBq+OCpOODs+OCueOCv+ODs+OCueOBquOBruOBi+OAgeOCpOODs+OCueOCv+ODs+OCueOBruWgtOWQiCd0J+OBqOOBr+OBquOCk+OBrueVpeOBquOBruOBi+OBjOiqv+OBueOBpuOCguOCj+OBi+OCiuOBvuOBm+OCk+OBp+OBl+OBn+OAguOBlOaVmeaOiOOBhOOBn+OBoOOBkeOBvuOBmeOBqOW5uOOBhOOBp+OBmeOAgu+8iVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkue9ruOBkeOBquOBhOS9jee9ruOBruWgtOWQiOOAgeazqOaEj+abuOOBjeOCkuihqOekuuOBmeOCi1xuICAgICAgICAgKi9cbiAgICAgICAgc2hvd0NhdXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghc2VsZi5jYXV0aW9uVGV4dC5jbGFzc0xpc3QuY29udGFpbnMoJ2lzVmlzaWJsZScpKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jYXV0aW9uVGV4dC5jbGFzc0xpc3QuYWRkKCdpc1Zpc2libGUnKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhdXRpb25UZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ2lzVmlzaWJsZScpO1xuICAgICAgICAgICAgICAgIH0sIDEwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkue9ruOBj+WHpueQhlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY2xpY2tlZFggOiBjYW52YXPkuIrjga7jgq/jg6rjg4Pjgq/kvY3nva5cbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNsaWNrZWRZIDogY2FudmFz5LiK44Gu44Kv44Oq44OD44Kv5L2N572uXG4gICAgICAgICAqL1xuICAgICAgICBwdXRTdG9uZTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8g5L2V55Wq55uu44Gu44Oe44K544GLXG4gICAgICAgICAgICBsZXQgbnRoR3JpZFggPSBNYXRoLmZsb29yKGNsaWNrZWRYIC8gc2VsZi5HUklEX1NJWkUpO1xuICAgICAgICAgICAgbGV0IG50aEdyaWRZID0gTWF0aC5mbG9vcihjbGlja2VkWSAvIHNlbGYuR1JJRF9TSVpFKTtcblxuICAgICAgICAgICAgLy8g55+z44GM572u44GR44KL44GL44Gu5Yik5a6aXG4gICAgICAgICAgICBpZiAoIXNlbGYuY2hlY2tWYWNhbmN5KG50aEdyaWRYLCBudGhHcmlkWSkpIHtcbiAgICAgICAgICAgICAgICAvLyDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznqbrjgYvjganjgYbjgYtcblxuICAgICAgICAgICAgICAgIC8vIOefs+OCkue9ruOBkeOBquOBhOS9jee9ruOBruWgtOWQiOOAgeazqOaEj+abuOOBjeOCkuihqOekuuOBmeOCi1xuICAgICAgICAgICAgICAgIHNlbGYuc2hvd0NhdXRpb24oKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNlbGYuY2hlY2tOZWlnaGJvcihudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44Gr44Go44Gq44KK5ZCI44Gj44Gm44GE44KL44GL44Gp44GG44GLXG5cbiAgICAgICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dDYXV0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzZWxmLmNoZWNrSWZQb3NzaWJsZShudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44KS44Gy44Gj44GP44KK6L+U44Gb44KL44Oe44K544GL44Gp44GG44GLXG5cbiAgICAgICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dDYXV0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIOefs+OCkue9ruOBkeOBn+WgtOWQiOOAgeiJsuOCkuWPjei7olxuICAgICAgICAgICAgc2VsZi5pc1doaXRlICo9IC0xO1xuXG4gICAgICAgICAgICAvLyDjgqTjg7Pjgrnjgr/jg7PjgrnjgavmuKHjgZnmg4XloLFcbiAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHg6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRYKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHk6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRZKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHI6IHNlbGYuUixcbiAgICAgICAgICAgICAgICBpc1doaXRlOiBzZWxmLmlzV2hpdGVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIOOCpOODs+OCueOCv+ODs+OCueOCkuS9nOaIkFxuICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgLy8g5Y+v6Kqt5oCn44Gu44Gf44KB44CB44GE44Gj44Gf44KT5aSJ5pWw44Gr6Kmy5b2T44Kq44OW44K444Kn44Kv44OI44KS5qC857SNXG4gICAgICAgICAgICBsZXQgb2JqID0gc2VsZi5ib2FyZFtudGhHcmlkWV1bbnRoR3JpZFhdO1xuICAgICAgICAgICAgb2JqLmluc3RhbmNlID0gc3RvbmU7XG4gICAgICAgICAgICBvYmouaXNXaGl0ZSA9IHNlbGYuaXNXaGl0ZTtcbiAgICAgICAgICAgIG9iai54ID0gbnRoR3JpZFg7XG4gICAgICAgICAgICBvYmoueSA9IG50aEdyaWRZO1xuXG4gICAgICAgICAgICAvLyDjgbLjgaPjgY/jgorov5TjgZnnn7PjgYzjgYLjgovloLTlkIjjga/jgbLjgaPjgY/jgorov5TjgZlcbiAgICAgICAgICAgIGlmIChzZWxmLnR1cm5TdG9uZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbGYudHVyblN0b25lcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICB2YWwuaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgdmFsLmluc3RhbmNlLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNlbGYudHVyblN0b25lcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyDjganjgaHjgonjga7nlarjgYvjga7ooajnpLrjgpLliIfjgormm7/jgYhcbiAgICAgICAgICAgIGlmICghc2VsZi5zdG9uZUNvbG9yVGV4dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlzV2hpdGUnKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQudGV4dENvbnRlbnQgPSAn55m9JztcbiAgICAgICAgICAgICAgICBzZWxmLnN0b25lQ29sb3JUZXh0LmNsYXNzTGlzdC5hZGQoJ2pzLWlzV2hpdGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zdG9uZUNvbG9yVGV4dC50ZXh0Q29udGVudCA9ICfpu5InO1xuICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQuY2xhc3NMaXN0LnJlbW92ZSgnanMtaXNXaGl0ZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOOCr+ODquODg+OCr+OBl+OBn+ODnuOCueOBjOepuuOBi+OBqeOBhuOBi+OCkuWIpOWumlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gbnRoWCA6IOS9leeVquebruOBruODnuOCueOBi++8iDEtOO+8iVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gbnRoWSA6IOS9leeVquebruOBruODnuOCueOBi++8iDEtOO+8iVxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGNoZWNrVmFjYW5jeTogZnVuY3Rpb24obnRoWCwgbnRoWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzZWxmLmJvYXJkW250aFldW250aFhdKS5sZW5ndGggPD0gMDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznn7PjgavjgajjgarjgorlkIjjgaPjgabjgYTjgovjgYvjganjgYbjgYvjgpLliKTlrppcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFggOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFkgOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBjaGVja05laWdoYm9yOiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IHJvdywgbGluZTtcblxuICAgICAgICAgICAgbGV0IG5laWdoYm9ycyA9IFtcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSAtIDFdLCAgICAgICAvLyDkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgLSAxXSwgICAvLyDlj7PkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFldLCAgICAgICAvLyDlj7NcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgKyAxXSwgICAvLyDlj7PkuItcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSArIDFdLCAgICAgICAvLyDkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgKyAxXSwgICAvLyDlt6bkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFldLCAgICAgICAvLyDlt6ZcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgLSAxXSAgICAvLyDlt6bkuIpcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBuZWlnaGJvcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIHJvdyA9IG5laWdoYm9yc1tpXVswXTtcbiAgICAgICAgICAgICAgICBsaW5lID0gbmVpZ2hib3JzW2ldWzFdO1xuXG4gICAgICAgICAgICAgICAgLy8g44Oc44O844OJ44GL44KJ44Gv44G/5Ye644GZ44Go44GN44Gv44K544Kt44OD44OXXG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IDAgfHwgcm93ID4gNyB8fCBsaW5lIDwgMCB8fCBsaW5lID4gNykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoc2VsZi5ib2FyZFtsaW5lXVtyb3ddKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznn7PjgpLjgbLjgaPjgY/jgorov5TjgZvjgovjg57jgrnjgYvjganjgYbjgYvjgpLliKTlrppcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFhcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFlcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBjaGVja0lmUG9zc2libGU6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBUT0RPIOiHquWIhueUqOODoeODou+8muOAgOS4ieinkumWouaVsOOCkuS9v+OBhuOBqOS7peS4i+WIpOWumuOBl+OChOOBmeOBneOBhuOBoOOBjCBNYXRoLmNvcyhNYXRoLlBJIC8gMinjgacx44Gr44Gq44KJ44Gq44GEXG4gICAgICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGkgKyAnIC8gNCcpO1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKE1hdGguY29zKE1hdGguUEkgLyA0ICogaSksIE1hdGguc2luKE1hdGguUEkgLyA0ICogaSkpO1xuICAgICAgICAgICAgLy8gfVxuXG5cbiAgICAgICAgICAgIGNvbnN0IE1BWF9DT1VOVCA9IChzZWxmLkxJTkVfTlVNQkVSIC0gMSkgLSAxOyAvLyAoKOe3muOBruaVsC0xKSAtIOiHqui6q+OBjOe9ruOBi+OCjOOCi+ODnuOCuSlcbiAgICAgICAgICAgIC8vIOS4gOaWueWQkeOBp+OCguefs+OBjOOBsuOBo+OBj+OCiui/lOOBm+OCjOOBsHRydWXjgavjgZnjgotcbiAgICAgICAgICAgIGxldCBpc1Bvc3NpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAvLyDlkITmlrnlkJHjgafnn7PjgpLjgbLjgaPjgY/jgorov5TjgZvjgovjgYvjgpLjg4Hjgqfjg4Pjgq/jgZnjgovjg5Xjg6njgrBcbiAgICAgICAgICAgIGxldCBpc1RtcFBvc3NpYmxlO1xuICAgICAgICAgICAgLy8g44OB44Kn44OD44Kv44GZ44KL55+z44Gu5oOF5aCx44KS5qC857SN77yI44Kv44Oq44OD44Kv44GX44Gf5L2N572u44GL44KJ6L+R44GE566H5omA44GL44KJ44OB44Kn44OD44Kv77yJXG4gICAgICAgICAgICBsZXQgb2JqID0gbnVsbDtcbiAgICAgICAgICAgIGxldCB0bXBPYmogPSBudWxsO1xuICAgICAgICAgICAgbGV0IHRtcFR1cm5TdG9uZXMgPSBbXTtcblxuICAgICAgICAgICAgbGV0IGRpclksIGRpclg7XG5cbiAgICAgICAgICAgIC8vIOe9ruOBkeOCi+adoeS7tlxuICAgICAgICAgICAgLy8g5bem5Y+z44CB5LiK5LiL44CB5pac44KBNDXluqbkuIrjgavlkIzjgZjoibLjga7nn7PjgYzjgYLjgotcbiAgICAgICAgICAgIC8vIOOBi+OBpCDjgZ3jga7lkIzjgZjoibLjga7nn7Pjgajoh6rouqvjga7plpPjgavpmpnplpPjgarjgY/liKXjga7oibLjga7nn7PjgYzjgYLjgotcblxuICAgICAgICAgICAgLy8g5LiK44CB5Y+z5LiK44CB5Y+z44CB5Y+z5LiL44CB5LiL44CB5bem5LiL44CB5bem44CB5bem5LiK44CB44Gn44Gd44KM44Ge44KM44OB44Kn44OD44Kv44GZ44KLXG4gICAgICAgICAgICAvLyB5LCB444Gu6aCG55WqXG4gICAgICAgICAgICBsZXQgY2hlY2tEaXJzID0gW1xuICAgICAgICAgICAgICAgIFstMSwgMF0sICAgIC8vIOS4ilxuICAgICAgICAgICAgICAgIFsxLCAwXSwgICAgIC8vIOS4i1xuICAgICAgICAgICAgICAgIFswLCAtMV0sICAgIC8vIOW3plxuICAgICAgICAgICAgICAgIFswLCAxXSwgICAgIC8vIOWPs1xuICAgICAgICAgICAgICAgIFstMSwgLTFdLCAgIC8vIOW3puS4ilxuICAgICAgICAgICAgICAgIFsxLCAxXSwgICAgIC8vIOWPs+S4i1xuICAgICAgICAgICAgICAgIFsxLCAtMV0sICAgIC8vIOW3puS4i1xuICAgICAgICAgICAgICAgIFstMSwgMV0sICAgIC8vIOWPs+S4ilxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDlkITmlrnlkJHjgafjgbLjgaPjgY/jgorov5TjgZvjgovjgYvliKTlrppcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2soKSB7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMCwgbGVuID0gY2hlY2tEaXJzLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzVG1wUG9zc2libGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBkaXJZID0gY2hlY2tEaXJzW2tdWzBdO1xuICAgICAgICAgICAgICAgICAgICBkaXJYID0gY2hlY2tEaXJzW2tdWzFdO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IE1BWF9DT1VOVDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOODnOODvOODieOBi+OCieOBr+OBv+WHuuOBmeWgtOWQiOOBr+WHpueQhuOCkuaKnOOBkeOCi1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChkaXJZIDwgMCkgJiYgKG50aFkgKyBkaXJZICogaSA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChkaXJZID4gMCkgJiYgKG50aFkgKyBkaXJZICogaSA+IE1BWF9DT1VOVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGRpclggPCAwKSAmJiAobnRoWCArIGRpclggKiBpIDwgMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGRpclggPiAwKSAmJiAobnRoWCArIGRpclggKiBpID4gTUFYX0NPVU5UKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDoh6rouqvjgYvjgonoqbLlvZPmlrnlkJHjga7kuK3jgafkuIDnlarov5HjgYTnn7NcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IHNlbGYuYm9hcmRbbnRoWSArIGRpclkgKiBpXVtudGhYICsgZGlyWCAqIGldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDjg4Hjgqfjg4Pjgq/jgZnjgovmlrnlkJHjgavmg4XloLHjgYzjgYLjgorvvJ3nn7PjgYznva7jgYvjgozjgabjgYrjgorjgIHjgYvjgaTjgIHlkIzjgZjoibLjga7loLTlkIhcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPiAwKSAmJiAob2JqLmlzV2hpdGUgKiAtMSA9PT0gc2VsZi5pc1doaXRlKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf5L2N572u44GL44KJ44CB5LiK6KiY55+z44Gu5aC05omA44G+44Gn44Gu55+z44KS56K66KqNXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBpOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIOiHquWIhueUqOODoeODou+8mnNlbGYuYm9hcmRbeV1beF3jgpJ0bXBPYmrjgavlj4LnhafmuKHjgZfjgZfjgabjgYTjgabjg4/jg57jgaPjgZ9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wT2JqID0gc2VsZi5ib2FyZFtudGhZICsgZGlyWSAqIGpdW250aFggKyBkaXJYICogal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE9iai55ID0gbnRoWSArIGRpclkgKiBqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBPYmoueCA9IG50aFggKyBkaXJYICogajtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModG1wT2JqKS5sZW5ndGggPiAwICYmIHRtcE9iai5pc1doaXRlID09PSBzZWxmLmlzV2hpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOODgeOCp+ODg+OCr+OBmeOCi+aWueWQkeOBq+aDheWgseOBjOOBguOCiu+8neefs+OBjOe9ruOBi+OCjOOBpuOBiuOCiuOAgeOBi+OBpOOAgemBleOBhuiJsuOBruWgtOWQiFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1RtcFBvc3NpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFR1cm5TdG9uZXMucHVzaCh0bXBPYmopO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnn7PjgYzjgarjgYTjgYvlkIzjgZjoibLjga7loLTlkIjjga/lh6bnkIbjgpLmipzjgZHjgotcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNUbXBQb3NzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wVHVyblN0b25lcy5sZW5ndGggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlh6bnkIbntYLkuobjga7loLTlkIjjga/jgqrjg5bjgrjjgqfjgq/jg4jjgavkuIDmmYLnmoTjgavmoLzntI3jgZfjgabjgYTjgZ/mg4XloLHjgpLliYrpmaTjgZnjgotcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0bXBPYmoueDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0bXBPYmoueTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDjgq/jg6rjg4Pjgq/jgZfjgZ/kvY3nva7jgajjg4Hjgqfjg4Pjgq/jgZnjgovmlrnlkJHjga7mnIDnn63jga7lkIzjgZjoibLjga7nn7Pjgb7jgafjga7plpPjgYzjgZnjgbnjgabpgZXjgYboibLjga7nn7Pjga7loLTlkIhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNUbXBQb3NzaWJsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSB0bXBUdXJuU3RvbmVzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnR1cm5TdG9uZXMucHVzaCh0bXBUdXJuU3RvbmVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBUdXJuU3RvbmVzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUG9zc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNoZWNrKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBpc1Bvc3NpYmxlO1xuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5Cb2FyZE1hbmFnZXIgPSBCb2FyZE1hbmFnZXI7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IFBsYXllciA9IGZ1bmN0aW9uKGNhbnZhcywgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmNhbnZhcyA9IGNhbnZhcztcblxuICAgICAgICBzZWxmLmNvbG9yID0gZGF0YS5jb2xvcjtcbiAgICAgICAgc2VsZi5zdG9uZXMgPSBbXTtcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgUGxheWVyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLnNldEV2ZW50KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGUub2Zmc2V0WCk7XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdldENsaWNrUG9zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlBsYXllciA9IFBsYXllcjtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgLyoqXG4gICAgICog44Gd44KM44Ge44KM44Gu55+z44Gu5oOF5aCxXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGN0eFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIDog5L2N572u44Go6Imy44KS5L+d5oyBXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3QgU3RvbmUgPSBmdW5jdGlvbihjdHgsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG4gICAgICAgIHNlbGYuZGF0YSA9IGRhdGE7XG4gICAgICAgIHNlbGYuaXNXaGl0ZSA9IGRhdGEuaXNXaGl0ZTtcblxuICAgIH07XG5cbiAgICBTdG9uZS5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkuaPj+WGmVxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZGF0YVxuICAgICAgICAgKi9cbiAgICAgICAgZHJhd0FyYzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHguYXJjKGRhdGEueCwgZGF0YS55LCBkYXRhLnIsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGxTdHlsZSA9IHNlbGYuaXNXaGl0ZSA+IDAgPyAnI2ZmZmZmZicgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5jbG9zZVBhdGgoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgbLjgaPjgY/jgorov5TjgZnlh6bnkIZcbiAgICAgICAgICovXG4gICAgICAgIHJldmVyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuaXNXaGl0ZSAqPSAtMTtcblxuICAgICAgICAgICAgc2VsZi5kcmF3QXJjKHNlbGYuZGF0YSk7XG5cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5TdG9uZSA9IFN0b25lO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpO1xuXG4gICAgICAgIGlmICghY2FudmFzLmdldENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhc1dyYXBwZXInKTtcbiAgICAgICAgY3R4LmNhbnZhcy53aWR0aCA9IHdyYXBwZXIuY2xpZW50V2lkdGg7XG4gICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ID0gd3JhcHBlci5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgYm9hcmQgPSBuZXcgbXlPdGhlbGxvLkJvYXJkTWFuYWdlcihjdHgpO1xuXG4gICAgICAgIC8vIOWIneacn+S9jee9ruOBq+efs+OCkuOCu+ODg+ODiFxuICAgICAgICBib2FyZC5zdGFydEdhbWUoKTtcblxuICAgICAgICAvLyDjgqTjg5njg7Pjg4jnmbvpjLJcbiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICBib2FyZC5wdXRTdG9uZShlLm9mZnNldFgsIGUub2Zmc2V0WSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbn0oKSk7XG5cbi8qKlxuICogLy8gVE9ETyDos6rllY/jgZXjgZvjgabjgY/jgaDjgZXjgYTjgIJcblxuIDEuXG4g44CM5Yik5a6a44GZ44KL44CN44Go44GE44GG6Iux6Kqe44Gv5L2V44KS5L2/44Gj44Gm44G+44GZ44Gn44GX44KH44GG44GL77yfXG4gZmluZCwganVkZ2UsIGRlY2lkZSwgY2hlY2suLi4/XG5cbiAyLlxuIEJvYXJkTWFuYWdlcuOCr+ODqeOCueOBrlN0YXJ0R2FtZeODoeOCveODg+ODieOBrlRPRE/jga7lj4LnhafjgpLjgojjgo3jgZfjgY/jgYrpoZjjgYTjgYTjgZ/jgZfjgb7jgZnjgIJcblxuIDMuXG4gSmF2YVNjcmlwdOOBruabuOOBjeaWueOBrua1gea0vu+8iO+8n++8ieOBjOOBvuOBqOOBvuOBo+OBpuOBhOOCi+acrOOChOiomOS6i+OAgeOBguOCi+OBhOOBr+iqv+OBueOCi+mam+OBruOCreODvOODr+ODvOODieOCkuaVmeOBiOOBpuOBhOOBn+OBoOOBkeOBquOBhOOBp+OBl+OCh+OBhuOBi++8n1xuIOOAjOOAh+OAh+OCseODvOOCue+8iGV4LiDjgq3jg6Pjg6Hjg6vjgrHjg7zjgrnjgarjganvvInjgI3jga/ljZjoqp7jga7mm7jjgY3mlrnjgoTjgaTjgarjgY7mlrnjgIFcbiDjg4fjgrbjgqTjg7Pjg5Hjgr/jg7zjg7Pjga/jgq/jg6njgrnvvIjjgrPjg7Pjgrnjg4jjg6njgq/jgr/vvInjga7lvbnlibLjgoTmqZ/og73jga7liIbjgZHmlrnjgavjgaTjgYTjgabjga7mpoLlv7XjgajjgYTjgYboqo3orZjjgarjga7jgafjgZnjgYzjgIFcbiDjgZPjgZPjgafmhI/lkbPjgZnjgovmtYHmtL7jgajjga/jgIHlpInmlbDlkI3jgoTplqLmlbDlkI3jgpLkvZXjgrHjg7zjgrnjgavjgZnjgovjgYvjgoTjgIFjc3PjgafjgYTjgYZCRU3jgoRGTE9DU1Pjga7jgojjgYbjgarjgoLjga7jgafjgZnjgIJcbiDvvIjkvJ3jgo/jgaPjgabjgYTjgarjgYvjgaPjgZ/jgonjgZnjgb/jgb7jgZvjgpMuLi7jgILmnb7nlLDjgZXjgpPjgYzjg5fjg63jgrDjg6njg6DlhoXjgacnXyfjgYvjgonjga/jgZjjgb7jgovlpInmlbDlkI3jgpLkvb/jgo/jgozjgabjgYTjgZ/jgorjgIHku6XliY3ku5bjga7kurrjgYzmm7jjgYTjgZ/jg5fjg63jgrDjg6njg6DjgadqUXVlcnnjgpLkvb/jgaPjgabjgYTjgarjgYTjga7jgasnJCfjgYvjgonjga/jgZjjgb7jgovlpInmlbDlkI3jgpLkvb/jgaPjgabjgYTjgovjga7jgpLopovjgZ/jgZPjgajjgYzjgYLjgaPjgZ/jga7jgafjgIHmtYHmtL7jga7jgojjgYbjgarjgoLjga7jgYzjgYLjgovjga7jgYvjgajmsJfjgavjgarjgorjgb7jgZfjgZ/jgILvvIlcblxuXG4gKi9cbiJdfQ==