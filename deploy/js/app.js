!function(){const t=function(t){this.ctx=t,this.cautionText=document.getElementById("caution"),this.stoneColorText=document.getElementById("stoneColor"),this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.isWhite=1,this.board=[],this.turnStones=[],this.toggleCautionClassName="isVisible",this.toggleTextClassName="js-isWhite",this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let e=1;e<t.LINE_NUMBER;e++){let e=[];for(let o=1;o<t.LINE_NUMBER;o++)e.push({});t.board.push(e)}},drawBoard:function(){const t=this,e=t.GRID_SIZE*(t.LINE_NUMBER-1);let o=0,i=0;t.drawRect(o,i,e,e,"#008833");for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(o,0,o,e),o+=t.GRID_SIZE;for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(0,i,e,i),i+=t.GRID_SIZE},drawRect:function(t,e,o,i,n){this.ctx.fillStyle=void 0!==n?n:"#000000",this.ctx.fillRect(t,e,o,i)},drawLine:function(t,e,o,i,n,s){this.ctx.strokeStyle=void 0!==n?n:"#000000",this.ctx.lineWidth=void 0!==s?s:1,this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(o,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,e=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),o=t.GRID_SIZE/2;let i,n,s=-1,l=-1,c=1;function h(){for(let h=0;h<2;h++){let h={r:t.R};i=e+s*o,n=e+l*o,h.x=i,h.y=n,h.isWhite=c;let a=new window.myOthello.Stone(t.ctx,h);a.drawArc(h);let r=t.board[Math.floor(n/t.GRID_SIZE)][Math.floor(i/t.GRID_SIZE)];r.instance=a,r.isWhite=c,s*=-1,l*=-1}}h(),s*=-1,c*=-1,h(),console.log(t.board)},showCaution:function(){const t=this;t.cautionText.classList.contains(t.toggleCautionClassName)||(t.cautionText.classList.add(t.toggleCautionClassName),setTimeout(function(){t.cautionText.classList.remove(t.toggleCautionClassName)},1e3))},putStone:function(t,e){const o=this;let i=Math.floor(t/o.GRID_SIZE),n=Math.floor(e/o.GRID_SIZE);if(!o.checkVacancy(i,n))return void o.showCaution();if(!o.checkNeighbor(i,n))return void o.showCaution();if(!o.checkIfPossible(i,n))return void o.showCaution();o.isWhite*=-1;let s={x:o.GRID_SIZE*i+o.GRID_SIZE/2,y:o.GRID_SIZE*n+o.GRID_SIZE/2,r:o.R,isWhite:o.isWhite},l=new window.myOthello.Stone(o.ctx,s);l.drawArc(s);let c=o.board[n][i];c.instance=l,c.isWhite=o.isWhite,c.x=i,c.y=n,o.turnStones.length>0&&(o.turnStones.forEach(function(t){t.isWhite*=-1,t.instance.reverse()}),o.turnStones.length=0),o.stoneColorText.classList.contains(o.toggleTextClassName)?(o.stoneColorText.textContent="黒",o.stoneColorText.classList.remove(o.toggleTextClassName)):(o.stoneColorText.textContent="白",o.stoneColorText.classList.add(o.toggleTextClassName))},checkVacancy:function(t,e){return Object.keys(this.board[e][t]).length<=0},checkNeighbor:function(t,e){const o=this;let i,n,s=[[t,e-1],[t+1,e-1],[t+1,e],[t+1,e+1],[t,e+1],[t-1,e+1],[t-1,e],[t-1,e-1]];for(let l=0,c=s.length;l<c;l++)if(i=s[l][0],n=s[l][1],!(i<0||i>7||n<0||n>7)&&Object.keys(o.board[n][i]).length>0)return!0},checkIfPossible:function(t,e){const o=this,i=o.LINE_NUMBER-1-1;let n,s,l,c=!1,h=null,a=null,r=[],d=[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,1],[1,-1],[-1,1]];return function(){for(let f=0,u=d.length;f<u;f++){n=!1,s=d[f][0],l=d[f][1];for(let d=1;!(!(d<=i)||s<0&&e+s*d<0||s>0&&e+s*d>i||l<0&&t+l*d<0||l>0&&t+l*d>i);d++)if(h=o.board[e+s*d][t+l*d],Object.keys(h).length>0&&-1*h.isWhite===o.isWhite){for(let i=1;i<d;i++){if((a=o.board[e+s*i][t+l*i]).y=e+s*i,a.x=t+l*i,!(Object.keys(a).length>0&&a.isWhite===o.isWhite)){n=!1,r.length=0,delete a.x,delete a.y;break}n=!0,r.push(a)}if(n){for(let t=0,e=r.length;t<e;t++)o.turnStones.push(r[t]);r.length=0,c=!0;break}}}}(),c}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,e){this.ctx=t,this.data=e,this.isWhite=e.isWhite};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=this.isWhite>0?"#ffffff":"#000000",this.ctx.fill(),this.ctx.closePath()},reverse:function(){this.isWhite*=-1,this.drawArc(this.data)}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const e=t.getContext("2d"),o=document.getElementById("canvasWrapper");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJjYXV0aW9uVGV4dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdG9uZUNvbG9yVGV4dCIsIkdSSURfU0laRSIsIkxJTkVfTlVNQkVSIiwiUiIsImlzV2hpdGUiLCJib2FyZCIsInR1cm5TdG9uZXMiLCJ0b2dnbGVDYXV0aW9uQ2xhc3NOYW1lIiwidG9nZ2xlVGV4dENsYXNzTmFtZSIsImluaXQiLCJwcm90b3R5cGUiLCJzZWxmIiwidHJhbnNsYXRlIiwiZHJhd0JvYXJkIiwiaSIsInJvdyIsImoiLCJwdXNoIiwiZmllbGRTaXplIiwieCIsInkiLCJkcmF3UmVjdCIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJjb2xvciIsImZpbGxTdHlsZSIsImZpbGxSZWN0Iiwid2lkdGgiLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsImJlZ2luUGF0aCIsIm1vdmVUbyIsImxpbmVUbyIsImNsb3NlUGF0aCIsInN0cm9rZSIsInN0YXJ0R2FtZSIsImNlbnRlciIsImRpZmYiLCJwb3NYIiwicG9zWSIsImRpcjEiLCJkaXIyIiwic2V0Rmlyc3RTdG9uZSIsImRhdGEiLCJyIiwic3RvbmUiLCJ3aW5kb3ciLCJteU90aGVsbG8iLCJTdG9uZSIsImRyYXdBcmMiLCJvYmoiLCJNYXRoIiwiZmxvb3IiLCJpbnN0YW5jZSIsImNvbnNvbGUiLCJsb2ciLCJzaG93Q2F1dGlvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkIiwic2V0VGltZW91dCIsInJlbW92ZSIsInB1dFN0b25lIiwiY2xpY2tlZFgiLCJjbGlja2VkWSIsIm50aEdyaWRYIiwibnRoR3JpZFkiLCJjaGVja1ZhY2FuY3kiLCJjaGVja05laWdoYm9yIiwiY2hlY2tJZlBvc3NpYmxlIiwibGVuZ3RoIiwiZm9yRWFjaCIsInZhbCIsInJldmVyc2UiLCJ0ZXh0Q29udGVudCIsIm50aFgiLCJudGhZIiwiT2JqZWN0Iiwia2V5cyIsImxpbmUiLCJuZWlnaGJvcnMiLCJsZW4iLCJNQVhfQ09VTlQiLCJpc1RtcFBvc3NpYmxlIiwiZGlyWSIsImRpclgiLCJpc1Bvc3NpYmxlIiwidG1wT2JqIiwidG1wVHVyblN0b25lcyIsImNoZWNrRGlycyIsImsiLCJjaGVjayIsImFyYyIsIlBJIiwiZmlsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjYW52YXMiLCJnZXRDb250ZXh0Iiwid3JhcHBlciIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZSIsIm9mZnNldFgiLCJvZmZzZXRZIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQVFBLE1BQUFBLEVBQUEsU0FBQUMsR0FDQUMsS0FFQUQsSUFBQUEsRUFGQUMsS0FLQUMsWUFBQUMsU0FBQUMsZUFBQSxXQUxBSCxLQU1BSSxlQUFBRixTQUFBQyxlQUFBLGNBTkFILEtBU0FLLFVBQUEsR0FUQUwsS0FVQU0sWUFBQSxFQVZBTixLQVlBTyxFQUFBLEdBWkFQLEtBWUFLLFVBWkFMLEtBZ0JBUSxRQUFBLEVBaEJBUixLQW1CQVMsU0FuQkFULEtBc0JBVSxjQXRCQVYsS0F5QkFXLHVCQUFBLFlBekJBWCxLQTBCQVksb0JBQUEsYUExQkFaLEtBNEJBYSxRQUdBZixFQUFBZ0IsV0FLQUQsS0FBQSxXQUNBLE1BQUFFLEVBQUFmLEtBR0FlLEVBQUFoQixJQUFBaUIsVUFBQSxFQUFBLEdBR0FELEVBQUFFLFlBR0EsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEVBQUFILEVBQUFULFlBQUFZLElBQUEsQ0FDQSxJQUFBQyxLQUVBLElBQUEsSUFBQUMsRUFBQSxFQUFBQSxFQUFBTCxFQUFBVCxZQUFBYyxJQUNBRCxFQUFBRSxTQUdBTixFQUFBTixNQUFBWSxLQUFBRixLQVFBRixVQUFBLFdBQ0EsTUFBQUYsRUFBQWYsS0FFQXNCLEVBQUFQLEVBQUFWLFdBQUFVLEVBQUFULFlBQUEsR0FFQSxJQUFBaUIsRUFBQSxFQUNBQyxFQUFB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QUFBQyxNQUFBQSxFQWxEQSxHQ0VBckQsU0FBQW9HLGlCQUFBLG1CQUFBLFdBRUEsTUFBQUMsRUFBQXJHLFNBQUFDLGVBQUEsVUFFQSxJQUFBb0csRUFBQUMsV0FDQSxPQUdBLE1BQUF6RyxFQUFBd0csRUFBQUMsV0FBQSxNQUNBQyxFQUFBdkcsU0FBQUMsZUFBQSxpQkFDQUosRUFBQXdHLE9BQUFyRSxNQUFBdUUsRUFBQUMsWUFDQTNHLEVBQUF3RyxPQUFBSSxPQUFBRixFQUFBRyxhQUVBLE1BQUFuRyxFQUFBLElBQUE2QyxVQUFBeEQsYUFBQUMsR0FHQVUsRUFBQWlDLFlBR0E2RCxFQUFBRCxpQkFBQSxRQUFBLFNBQUFPLEdBRUFwRyxFQUFBNEQsU0FBQXdDLEVBQUFDLFFBQUFELEVBQUFFIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oKSB7XG5cbiAgICAvKipcbiAgICAgKiDjgrPjg7Pjgrnjg4jjg6njgq/jgr9cbiAgICAgKiDjg5zjg7zjg4njga7nirbmhYvjgpLnrqHnkIbjgZnjgotcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY3R4XG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3QgQm9hcmRNYW5hZ2VyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHNlbGYuY3R4ID0gY3R4O1xuXG4gICAgICAgIC8vIERPTVxuICAgICAgICBzZWxmLmNhdXRpb25UZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhdXRpb24nKTtcbiAgICAgICAgc2VsZi5zdG9uZUNvbG9yVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9uZUNvbG9yJyk7XG5cbiAgICAgICAgLy/lgKRcbiAgICAgICAgc2VsZi5HUklEX1NJWkUgPSA1MDtcbiAgICAgICAgc2VsZi5MSU5FX05VTUJFUiA9IDk7XG4gICAgICAgIC8vIOefs+OBruWNiuW+hFxuICAgICAgICBzZWxmLlIgPSBzZWxmLkdSSURfU0laRSAqIDAuMztcblxuICAgICAgICAvLyDnmb3pu5LliKTlrprjg5Xjg6njgrBcbiAgICAgICAgLy8gMeOBp+eZveOAgS0x44Gn6buSXG4gICAgICAgIHNlbGYuaXNXaGl0ZSA9IDE7XG5cbiAgICAgICAgLy8g44Gd44KM44Ge44KM44Gu44Oe44K555uu44Gu5oOF5aCx44KS5qC857SNXG4gICAgICAgIHNlbGYuYm9hcmQgPSBbXTtcblxuICAgICAgICAvLyDjgbLjgaPjgY/jgorov5TjgZnnn7PjgpLkuIDmmYLnmoTjgavmoLzntI3jgZnjgotcbiAgICAgICAgc2VsZi50dXJuU3RvbmVzID0gW107XG5cbiAgICAgICAgLy9cbiAgICAgICAgc2VsZi50b2dnbGVDYXV0aW9uQ2xhc3NOYW1lID0gJ2lzVmlzaWJsZSc7XG4gICAgICAgIHNlbGYudG9nZ2xlVGV4dENsYXNzTmFtZSA9ICdqcy1pc1doaXRlJztcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgQm9hcmRNYW5hZ2VyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICog5Yid5pyf5YyWXG4gICAgICAgICAqL1xuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyB4PTAsIHk9MOOBp+WFiOOBruWkquOBleOBjOWNiuWIhuOBl+aPj+WGmeOBleOCjOOBquOBhOOBn+OCgeOAgeWfuua6lueCueOCkuOBmuOCieOBmVxuICAgICAgICAgICAgc2VsZi5jdHgudHJhbnNsYXRlKDEsIDEpO1xuXG4gICAgICAgICAgICAvLyDjg5zjg7zjg4njgpLmj4/lhplcbiAgICAgICAgICAgIHNlbGYuZHJhd0JvYXJkKCk7XG5cbiAgICAgICAgICAgIC8vIOWQhOODnuOCueebruOBq+aDheWgseS/neaMgeeUqOOBruOCquODluOCuOOCp+OCr+ODiOOCkuOCguOBn+OBm+OBpuODnOODvOODieaDheWgseOBrumFjeWIl+OBq+agvOe0jVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzZWxmLkxJTkVfTlVNQkVSOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgcm93ID0gW107XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMTsgaiA8IHNlbGYuTElORV9OVU1CRVI7IGorKykge1xuICAgICAgICAgICAgICAgICAgICByb3cucHVzaCh7fSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5ib2FyZC5wdXNoKHJvdyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog44Oc44O844OJ44KS5o+P5YaZXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3Qm9hcmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGNvbnN0IGZpZWxkU2l6ZSA9IHNlbGYuR1JJRF9TSVpFICogKHNlbGYuTElORV9OVU1CRVIgLSAxKTtcblxuICAgICAgICAgICAgbGV0IHggPSAwO1xuICAgICAgICAgICAgbGV0IHkgPSAwO1xuXG4gICAgICAgICAgICBzZWxmLmRyYXdSZWN0KHgsIHksIGZpZWxkU2l6ZSwgZmllbGRTaXplLCAnIzAwODgzMycpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzZWxmLkxJTkVfTlVNQkVSOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRyYXdMaW5lKHgsIDAsIHgsIGZpZWxkU2l6ZSk7XG4gICAgICAgICAgICAgICAgeCArPSBzZWxmLkdSSURfU0laRTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoMCwgeSwgZmllbGRTaXplLCB5KTtcbiAgICAgICAgICAgICAgICB5ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOWbm+inkuW9ouOCkuaPj+WGmVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geDFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHkxXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbG9yXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3UmVjdDogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFJlY3QoeDEsIHkxLCB4MiwgeTIpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOe3muOCkuaPj+WGmVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geDFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHkxXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGNvbG9yXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgICAgICAgKi9cbiAgICAgICAgZHJhd0xpbmU6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBjb2xvciwgd2lkdGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2VTdHlsZSA9IHR5cGVvZiBjb2xvciAhPT0gJ3VuZGVmaW5lZCcgPyBjb2xvciA6ICcjMDAwMDAwJztcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVXaWR0aCA9IHR5cGVvZiB3aWR0aCAhPT0gJ3VuZGVmaW5lZCcgPyB3aWR0aCA6IDE7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHgubW92ZVRvKHgxLCB5MSk7XG4gICAgICAgICAgICBzZWxmLmN0eC5saW5lVG8oeDIsIHkyKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2UoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgrLjg7zjg6Djgrnjgr/jg7zjg4jmmYLjgavlrp/ooYxcbiAgICAgICAgICovXG4gICAgICAgIHN0YXJ0R2FtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgY2VudGVyID0gc2VsZi5HUklEX1NJWkUgKiAoKHNlbGYuTElORV9OVU1CRVIgLSAxKSAvIDIpO1xuICAgICAgICAgICAgY29uc3QgZGlmZiA9IChzZWxmLkdSSURfU0laRSAvIDIpO1xuICAgICAgICAgICAgbGV0IGRpcjEgPSAtMTtcbiAgICAgICAgICAgIGxldCBkaXIyID0gLTE7XG4gICAgICAgICAgICBsZXQgcG9zWCwgcG9zWTtcbiAgICAgICAgICAgIGxldCBpc1doaXRlID0gMTtcblxuICAgICAgICAgICAgc2V0Rmlyc3RTdG9uZSgpO1xuICAgICAgICAgICAgZGlyMSAqPSAtMTtcbiAgICAgICAgICAgIGlzV2hpdGUgKj0gLTE7XG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCk7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5Yid5pyf5L2N572u44Gr55+z44KS44K744OD44OIXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldEZpcnN0U3RvbmUoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIOiHquWIhueUqOODoeODou+8mumWouaVsOOBruWkluWBtOOBp+Wumue+qeOBl+OBpuOBiuOCiuOAgeOCquODluOCuOOCp+OCr+ODiOOBruWPgueFp+a4oeOBl+OBp+W8leOBo+OBi+OBi+OBo+OBn1xuICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHI6IHNlbGYuUlxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHBvc1ggPSBjZW50ZXIgKyBkaXIxICogZGlmZjtcbiAgICAgICAgICAgICAgICAgICAgcG9zWSA9IGNlbnRlciArIGRpcjIgKiBkaWZmO1xuXG4gICAgICAgICAgICAgICAgICAgIGRhdGEueCA9IHBvc1g7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEueSA9IHBvc1k7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaXNXaGl0ZSA9IGlzV2hpdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g44Kk44Oz44K544K/44Oz44K544KS5L2c5oiQXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9uZSA9IG5ldyB3aW5kb3cubXlPdGhlbGxvLlN0b25lKHNlbGYuY3R4LCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgLy8g55+z44KS5o+P5YaZXG4gICAgICAgICAgICAgICAgICAgIHN0b25lLmRyYXdBcmMoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8g44Oc44O844OJ44Gu6YWN5YiX44Gu6Kmy5b2T5L2N572u44Gr44Kk44Oz44K544K/44Oz44K544Go54++5Zyo44Gu55m96buS54q25oWL44KS5qC857SNXG4gICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSBzZWxmLmJvYXJkW01hdGguZmxvb3IocG9zWSAvIHNlbGYuR1JJRF9TSVpFKV1bTWF0aC5mbG9vcihwb3NYIC8gc2VsZi5HUklEX1NJWkUpXTtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmluc3RhbmNlID0gc3RvbmU7XG4gICAgICAgICAgICAgICAgICAgIG9iai5pc1doaXRlID0gaXNXaGl0ZTtcblxuICAgICAgICAgICAgICAgICAgICBkaXIxICo9IC0xO1xuICAgICAgICAgICAgICAgICAgICBkaXIyICo9IC0xO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUT0RPIDog6LOq5ZWP44GV44Gb44Gm44GP44Gg44GV44GE44CCXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmJvYXJkKTtcbiAgICAgICAgICAgIC8vIFRPRE8g5LiK44Gu44KI44GG44Gr44Ot44Kw44Gr5Ye644GZ44Go44CB5Lul5LiL44Gu44KI44GG44Gr6KGo56S644GV44KM44G+44GZ44CCXG4gICAgICAgICAgICAvLyB7XG4gICAgICAgICAgICAvLyAgICAgaW5zdGFuY2U6IHQge2tleTE6IHZhbHVlMSwga2V5MjogdmFsdWUyLCAuLi59LFxuICAgICAgICAgICAgLy8gICAgIGtleUE6IHZhbHVlQSxcbiAgICAgICAgICAgIC8vICAgICAuLi5cbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIFRPRE8g44GT44GT44GuICd0JyDjgajjga/jgarjgpPjga7mhI/lkbPjgIHjgYLjgovjgYTjga/jgarjgpPjga7ljZjoqp7jga7nlaXjgafjgZfjgofjgYbjgYvvvJ9cbiAgICAgICAgICAgIC8vIFRPRE8g77yI44Kk44Oz44K544K/44Oz44K544GM5YWl44KL44GoICd0JyDjgajjgarjgovjga7jgYvjgajmgJ3jgYTjgb7jgZnjgYzjgIHmnKzlvZPjgavjgqTjg7Pjgrnjgr/jg7Pjgrnjgarjga7jgYvjgIHjgqTjg7Pjgrnjgr/jg7Pjgrnjga7loLTlkIgndCfjgajjga/jgarjgpPjga7nlaXjgarjga7jgYvjgYzoqr/jgbnjgabjgoLjgo/jgYvjgorjgb7jgZvjgpPjgafjgZfjgZ/jgILjgZTmlZnmjojjgYTjgZ/jgaDjgZHjgb7jgZnjgajlubjjgYTjgafjgZnjgILvvIlcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICovXG4gICAgICAgIHNob3dDYXV0aW9uOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoIXNlbGYuY2F1dGlvblRleHQuY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYudG9nZ2xlQ2F1dGlvbkNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNhdXRpb25UZXh0LmNsYXNzTGlzdC5hZGQoc2VsZi50b2dnbGVDYXV0aW9uQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhdXRpb25UZXh0LmNsYXNzTGlzdC5yZW1vdmUoc2VsZi50b2dnbGVDYXV0aW9uQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9LCAxMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDnn7PjgpLnva7jgY/lh6bnkIZcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNsaWNrZWRYIDogY2FudmFz5LiK44Gu44Kv44Oq44OD44Kv5L2N572uXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjbGlja2VkWSA6IGNhbnZhc+S4iuOBruOCr+ODquODg+OCr+S9jee9rlxuICAgICAgICAgKi9cbiAgICAgICAgcHV0U3RvbmU6IGZ1bmN0aW9uKGNsaWNrZWRYLCBjbGlja2VkWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIOS9leeVquebruOBruODnuOCueOBi1xuICAgICAgICAgICAgbGV0IG50aEdyaWRYID0gTWF0aC5mbG9vcihjbGlja2VkWCAvIHNlbGYuR1JJRF9TSVpFKTtcbiAgICAgICAgICAgIGxldCBudGhHcmlkWSA9IE1hdGguZmxvb3IoY2xpY2tlZFkgLyBzZWxmLkdSSURfU0laRSk7XG5cbiAgICAgICAgICAgIC8vIOefs+OBjOe9ruOBkeOCi+OBi+OBruWIpOWumlxuICAgICAgICAgICAgaWYgKCFzZWxmLmNoZWNrVmFjYW5jeShudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM56m644GL44Gp44GG44GLXG5cbiAgICAgICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dDYXV0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzZWxmLmNoZWNrTmVpZ2hib3IobnRoR3JpZFgsIG50aEdyaWRZKSkge1xuICAgICAgICAgICAgICAgIC8vIOOCr+ODquODg+OCr+OBl+OBn+ODnuOCueOBjOefs+OBq+OBqOOBquOCiuWQiOOBo+OBpuOBhOOCi+OBi+OBqeOBhuOBi1xuXG4gICAgICAgICAgICAgICAgLy8g55+z44KS572u44GR44Gq44GE5L2N572u44Gu5aC05ZCI44CB5rOo5oSP5pu444GN44KS6KGo56S644GZ44KLXG4gICAgICAgICAgICAgICAgc2VsZi5zaG93Q2F1dGlvbigpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICghc2VsZi5jaGVja0lmUG9zc2libGUobnRoR3JpZFgsIG50aEdyaWRZKSkge1xuICAgICAgICAgICAgICAgIC8vIOOCr+ODquODg+OCr+OBl+OBn+ODnuOCueOBjOefs+OCkuOBsuOBo+OBj+OCiui/lOOBm+OCi+ODnuOCueOBi+OBqeOBhuOBi1xuXG4gICAgICAgICAgICAgICAgLy8g55+z44KS572u44GR44Gq44GE5L2N572u44Gu5aC05ZCI44CB5rOo5oSP5pu444GN44KS6KGo56S644GZ44KLXG4gICAgICAgICAgICAgICAgc2VsZi5zaG93Q2F1dGlvbigpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgZ/loLTlkIjjgIHoibLjgpLlj43ou6JcbiAgICAgICAgICAgIHNlbGYuaXNXaGl0ZSAqPSAtMTtcblxuICAgICAgICAgICAgLy8g44Kk44Oz44K544K/44Oz44K544Gr5rih44GZ5oOF5aCxXG4gICAgICAgICAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICB4OiAoc2VsZi5HUklEX1NJWkUgKiBudGhHcmlkWCkgKyAoc2VsZi5HUklEX1NJWkUgLyAyKSxcbiAgICAgICAgICAgICAgICB5OiAoc2VsZi5HUklEX1NJWkUgKiBudGhHcmlkWSkgKyAoc2VsZi5HUklEX1NJWkUgLyAyKSxcbiAgICAgICAgICAgICAgICByOiBzZWxmLlIsXG4gICAgICAgICAgICAgICAgaXNXaGl0ZTogc2VsZi5pc1doaXRlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyDjgqTjg7Pjgrnjgr/jg7PjgrnjgpLkvZzmiJBcbiAgICAgICAgICAgIGxldCBzdG9uZSA9IG5ldyB3aW5kb3cubXlPdGhlbGxvLlN0b25lKHNlbGYuY3R4LCBkYXRhKTtcbiAgICAgICAgICAgIHN0b25lLmRyYXdBcmMoZGF0YSk7XG5cbiAgICAgICAgICAgIC8vIOWPr+iqreaAp+OBruOBn+OCgeOAgeOBhOOBo+OBn+OCk+WkieaVsOOBq+ipsuW9k+OCquODluOCuOOCp+OCr+ODiOOCkuagvOe0jVxuICAgICAgICAgICAgbGV0IG9iaiA9IHNlbGYuYm9hcmRbbnRoR3JpZFldW250aEdyaWRYXTtcbiAgICAgICAgICAgIG9iai5pbnN0YW5jZSA9IHN0b25lO1xuICAgICAgICAgICAgb2JqLmlzV2hpdGUgPSBzZWxmLmlzV2hpdGU7XG4gICAgICAgICAgICBvYmoueCA9IG50aEdyaWRYO1xuICAgICAgICAgICAgb2JqLnkgPSBudGhHcmlkWTtcblxuICAgICAgICAgICAgLy8g44Gy44Gj44GP44KK6L+U44GZ55+z44GM44GC44KL5aC05ZCI44Gv44Gy44Gj44GP44KK6L+U44GZXG4gICAgICAgICAgICBpZiAoc2VsZi50dXJuU3RvbmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzZWxmLnR1cm5TdG9uZXMuZm9yRWFjaChmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsLmlzV2hpdGUgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIHZhbC5pbnN0YW5jZS5yZXZlcnNlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzZWxmLnR1cm5TdG9uZXMubGVuZ3RoID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8g44Gp44Gh44KJ44Gu55Wq44GL44Gu6KGo56S644KS5YiH44KK5pu/44GIXG4gICAgICAgICAgICBpZiAoIXNlbGYuc3RvbmVDb2xvclRleHQuY2xhc3NMaXN0LmNvbnRhaW5zKHNlbGYudG9nZ2xlVGV4dENsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnN0b25lQ29sb3JUZXh0LnRleHRDb250ZW50ID0gJ+eZvSc7XG4gICAgICAgICAgICAgICAgc2VsZi5zdG9uZUNvbG9yVGV4dC5jbGFzc0xpc3QuYWRkKHNlbGYudG9nZ2xlVGV4dENsYXNzTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQudGV4dENvbnRlbnQgPSAn6buSJztcbiAgICAgICAgICAgICAgICBzZWxmLnN0b25lQ29sb3JUZXh0LmNsYXNzTGlzdC5yZW1vdmUoc2VsZi50b2dnbGVUZXh0Q2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznqbrjgYvjganjgYbjgYvjgpLliKTlrppcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFggOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFkgOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBjaGVja1ZhY2FuY3k6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2VsZi5ib2FyZFtudGhZXVtudGhYXSkubGVuZ3RoIDw9IDA7XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44Gr44Go44Gq44KK5ZCI44Gj44Gm44GE44KL44GL44Gp44GG44GL44KS5Yik5a6aXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudGhYIDog5L2V55Wq55uu44Gu44Oe44K544GL77yIMS0477yJXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudGhZIDog5L2V55Wq55uu44Gu44Oe44K544GL77yIMS0477yJXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgY2hlY2tOZWlnaGJvcjogZnVuY3Rpb24obnRoWCwgbnRoWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGxldCByb3csIGxpbmU7XG5cbiAgICAgICAgICAgIGxldCBuZWlnaGJvcnMgPSBbXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgLSAxXSwgICAgICAgLy8g5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZIC0gMV0sICAgLy8g5Y+z5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZXSwgICAgICAgLy8g5Y+zXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZICsgMV0sICAgLy8g5Y+z5LiLXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgKyAxXSwgICAgICAgLy8g5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZICsgMV0sICAgLy8g5bem5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZXSwgICAgICAgLy8g5bemXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZIC0gMV0gICAgLy8g5bem5LiKXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gbmVpZ2hib3JzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICByb3cgPSBuZWlnaGJvcnNbaV1bMF07XG4gICAgICAgICAgICAgICAgbGluZSA9IG5laWdoYm9yc1tpXVsxXTtcblxuICAgICAgICAgICAgICAgIC8vIOODnOODvOODieOBi+OCieOBr+OBv+WHuuOBmeOBqOOBjeOBr+OCueOCreODg+ODl1xuICAgICAgICAgICAgICAgIGlmIChyb3cgPCAwIHx8IHJvdyA+IDcgfHwgbGluZSA8IDAgfHwgbGluZSA+IDcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHNlbGYuYm9hcmRbbGluZV1bcm93XSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44KS44Gy44Gj44GP44KK6L+U44Gb44KL44Oe44K544GL44Gp44GG44GL44KS5Yik5a6aXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudGhYXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudGhZXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAgICAgKi9cbiAgICAgICAgY2hlY2tJZlBvc3NpYmxlOiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8gVE9ETyDoh6rliIbnlKjjg6Hjg6LvvJrjgIDkuInop5LplqLmlbDjgpLkvb/jgYbjgajku6XkuIvliKTlrprjgZfjgoTjgZnjgZ3jgYbjgaDjgYwgTWF0aC5jb3MoTWF0aC5QSSAvIDIp44GnMeOBq+OBquOCieOBquOBhFxuICAgICAgICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhpICsgJyAvIDQnKTtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhNYXRoLmNvcyhNYXRoLlBJIC8gNCAqIGkpLCBNYXRoLnNpbihNYXRoLlBJIC8gNCAqIGkpKTtcbiAgICAgICAgICAgIC8vIH1cblxuXG4gICAgICAgICAgICBjb25zdCBNQVhfQ09VTlQgPSAoc2VsZi5MSU5FX05VTUJFUiAtIDEpIC0gMTsgLy8gKCjnt5rjga7mlbAtMSkgLSDoh6rouqvjgYznva7jgYvjgozjgovjg57jgrkpXG4gICAgICAgICAgICAvLyDkuIDmlrnlkJHjgafjgoLnn7PjgYzjgbLjgaPjgY/jgorov5TjgZvjgozjgbB0cnVl44Gr44GZ44KLXG4gICAgICAgICAgICBsZXQgaXNQb3NzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgLy8g5ZCE5pa55ZCR44Gn55+z44KS44Gy44Gj44GP44KK6L+U44Gb44KL44GL44KS44OB44Kn44OD44Kv44GZ44KL44OV44Op44KwXG4gICAgICAgICAgICBsZXQgaXNUbXBQb3NzaWJsZTtcbiAgICAgICAgICAgIC8vIOODgeOCp+ODg+OCr+OBmeOCi+efs+OBruaDheWgseOCkuagvOe0je+8iOOCr+ODquODg+OCr+OBl+OBn+S9jee9ruOBi+OCiei/keOBhOeuh+aJgOOBi+OCieODgeOCp+ODg+OCr++8iVxuICAgICAgICAgICAgbGV0IG9iaiA9IG51bGw7XG4gICAgICAgICAgICBsZXQgdG1wT2JqID0gbnVsbDtcbiAgICAgICAgICAgIGxldCB0bXBUdXJuU3RvbmVzID0gW107XG5cbiAgICAgICAgICAgIGxldCBkaXJZLCBkaXJYO1xuXG4gICAgICAgICAgICAvLyDnva7jgZHjgovmnaHku7ZcbiAgICAgICAgICAgIC8vIOW3puWPs+OAgeS4iuS4i+OAgeaWnOOCgTQ15bqm5LiK44Gr5ZCM44GY6Imy44Gu55+z44GM44GC44KLXG4gICAgICAgICAgICAvLyDjgYvjgaQg44Gd44Gu5ZCM44GY6Imy44Gu55+z44Go6Ieq6Lqr44Gu6ZaT44Gr6ZqZ6ZaT44Gq44GP5Yil44Gu6Imy44Gu55+z44GM44GC44KLXG5cbiAgICAgICAgICAgIC8vIOS4iuOAgeWPs+S4iuOAgeWPs+OAgeWPs+S4i+OAgeS4i+OAgeW3puS4i+OAgeW3puOAgeW3puS4iuOAgeOBp+OBneOCjOOBnuOCjOODgeOCp+ODg+OCr+OBmeOCi1xuICAgICAgICAgICAgLy8geSwgeOOBrumghueVqlxuICAgICAgICAgICAgbGV0IGNoZWNrRGlycyA9IFtcbiAgICAgICAgICAgICAgICBbLTEsIDBdLCAgICAvLyDkuIpcbiAgICAgICAgICAgICAgICBbMSwgMF0sICAgICAvLyDkuItcbiAgICAgICAgICAgICAgICBbMCwgLTFdLCAgICAvLyDlt6ZcbiAgICAgICAgICAgICAgICBbMCwgMV0sICAgICAvLyDlj7NcbiAgICAgICAgICAgICAgICBbLTEsIC0xXSwgICAvLyDlt6bkuIpcbiAgICAgICAgICAgICAgICBbMSwgMV0sICAgICAvLyDlj7PkuItcbiAgICAgICAgICAgICAgICBbMSwgLTFdLCAgICAvLyDlt6bkuItcbiAgICAgICAgICAgICAgICBbLTEsIDFdLCAgICAvLyDlj7PkuIpcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICog5ZCE5pa55ZCR44Gn44Gy44Gj44GP44KK6L+U44Gb44KL44GL5Yik5a6aXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrKCkge1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgayA9IDAsIGxlbiA9IGNoZWNrRGlycy5sZW5ndGg7IGsgPCBsZW47IGsrKykge1xuICAgICAgICAgICAgICAgICAgICBpc1RtcFBvc3NpYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZGlyWSA9IGNoZWNrRGlyc1trXVswXTtcbiAgICAgICAgICAgICAgICAgICAgZGlyWCA9IGNoZWNrRGlyc1trXVsxXTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBNQVhfQ09VTlQ7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDjg5zjg7zjg4njgYvjgonjga/jgb/lh7rjgZnloLTlkIjjga/lh6bnkIbjgpLmipzjgZHjgotcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZGlyWSA8IDApICYmIChudGhZICsgZGlyWSAqIGkgPCAwKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoZGlyWSA+IDApICYmIChudGhZICsgZGlyWSAqIGkgPiBNQVhfQ09VTlQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChkaXJYIDwgMCkgJiYgKG50aFggKyBkaXJYICogaSA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChkaXJYID4gMCkgJiYgKG50aFggKyBkaXJYICogaSA+IE1BWF9DT1VOVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Ieq6Lqr44GL44KJ6Kmy5b2T5pa55ZCR44Gu5Lit44Gn5LiA55Wq6L+R44GE55+zXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmogPSBzZWxmLmJvYXJkW250aFkgKyBkaXJZICogaV1bbnRoWCArIGRpclggKiBpXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g44OB44Kn44OD44Kv44GZ44KL5pa55ZCR44Gr5oOF5aCx44GM44GC44KK77yd55+z44GM572u44GL44KM44Gm44GK44KK44CB44GL44Gk44CB5ZCM44GY6Imy44Gu5aC05ZCIXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID4gMCkgJiYgKG9iai5pc1doaXRlICogLTEgPT09IHNlbGYuaXNXaGl0ZSkpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOOCr+ODquODg+OCr+OBl+OBn+S9jee9ruOBi+OCieOAgeS4iuiomOefs+OBruWgtOaJgOOBvuOBp+OBruefs+OCkueiuuiqjVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgaTsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyDoh6rliIbnlKjjg6Hjg6LvvJpzZWxmLmJvYXJkW3ldW3hd44KSdG1wT2Jq44Gr5Y+C54Wn5rih44GX44GX44Gm44GE44Gm44OP44Oe44Gj44GfXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE9iaiA9IHNlbGYuYm9hcmRbbnRoWSArIGRpclkgKiBqXVtudGhYICsgZGlyWCAqIGpdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBPYmoueSA9IG50aFkgKyBkaXJZICogajtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wT2JqLnggPSBudGhYICsgZGlyWCAqIGo7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRtcE9iaikubGVuZ3RoID4gMCAmJiB0bXBPYmouaXNXaGl0ZSA9PT0gc2VsZi5pc1doaXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDjg4Hjgqfjg4Pjgq/jgZnjgovmlrnlkJHjgavmg4XloLHjgYzjgYLjgorvvJ3nn7PjgYznva7jgYvjgozjgabjgYrjgorjgIHjgYvjgaTjgIHpgZXjgYboibLjga7loLTlkIhcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNUbXBQb3NzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBUdXJuU3RvbmVzLnB1c2godG1wT2JqKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g55+z44GM44Gq44GE44GL5ZCM44GY6Imy44Gu5aC05ZCI44Gv5Yem55CG44KS5oqc44GR44KLXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzVG1wUG9zc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFR1cm5TdG9uZXMubGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yem55CG57WC5LqG44Gu5aC05ZCI44Gv44Kq44OW44K444Kn44Kv44OI44Gr5LiA5pmC55qE44Gr5qC857SN44GX44Gm44GE44Gf5oOF5aCx44KS5YmK6Zmk44GZ44KLXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdG1wT2JqLng7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdG1wT2JqLnk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf5L2N572u44Go44OB44Kn44OD44Kv44GZ44KL5pa55ZCR44Gu5pyA55+t44Gu5ZCM44GY6Imy44Gu55+z44G+44Gn44Gu6ZaT44GM44GZ44G544Gm6YGV44GG6Imy44Gu55+z44Gu5aC05ZCIXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzVG1wUG9zc2libGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gdG1wVHVyblN0b25lcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi50dXJuU3RvbmVzLnB1c2godG1wVHVyblN0b25lc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wVHVyblN0b25lcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1Bvc3NpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGVjaygpO1xuXG4gICAgICAgICAgICByZXR1cm4gaXNQb3NzaWJsZTtcblxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cubXlPdGhlbGxvID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cubXlPdGhlbGxvID0ge307XG4gICAgfVxuICAgIHdpbmRvdy5teU90aGVsbG8uQm9hcmRNYW5hZ2VyID0gQm9hcmRNYW5hZ2VyO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICAvKipcbiAgICAgKiDjgZ3jgozjgZ7jgozjga7nn7Pjga7mg4XloLFcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gY3R4XG4gICAgICogQHBhcmFtIHtvYmplY3R9IGRhdGEgOiDkvY3nva7jgajoibLjgpLkv53mjIFcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdCBTdG9uZSA9IGZ1bmN0aW9uKGN0eCwgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmN0eCA9IGN0eDtcbiAgICAgICAgc2VsZi5kYXRhID0gZGF0YTtcbiAgICAgICAgc2VsZi5pc1doaXRlID0gZGF0YS5pc1doaXRlO1xuXG4gICAgfTtcblxuICAgIFN0b25lLnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICog55+z44KS5o+P5YaZXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3QXJjOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5hcmMoZGF0YS54LCBkYXRhLnksIGRhdGEuciwgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gc2VsZi5pc1doaXRlID4gMCA/ICcjZmZmZmZmJyA6ICcjMDAwMDAwJztcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGwoKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOOBsuOBo+OBj+OCiui/lOOBmeWHpueQhlxuICAgICAgICAgKi9cbiAgICAgICAgcmV2ZXJzZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5pc1doaXRlICo9IC0xO1xuXG4gICAgICAgICAgICBzZWxmLmRyYXdBcmMoc2VsZi5kYXRhKTtcblxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlN0b25lID0gU3RvbmU7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5cbiAgICAgICAgaWYgKCFjYW52YXMuZ2V0Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzV3JhcHBlcicpO1xuICAgICAgICBjdHguY2FudmFzLndpZHRoID0gd3JhcHBlci5jbGllbnRXaWR0aDtcbiAgICAgICAgY3R4LmNhbnZhcy5oZWlnaHQgPSB3cmFwcGVyLmNsaWVudEhlaWdodDtcblxuICAgICAgICBjb25zdCBib2FyZCA9IG5ldyBteU90aGVsbG8uQm9hcmRNYW5hZ2VyKGN0eCk7XG5cbiAgICAgICAgLy8g5Yid5pyf5L2N572u44Gr55+z44KS44K744OD44OIXG4gICAgICAgIGJvYXJkLnN0YXJ0R2FtZSgpO1xuXG4gICAgICAgIC8vIOOCpOODmeODs+ODiOeZu+mMslxuICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgICAgIGJvYXJkLnB1dFN0b25lKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxufSgpKTtcblxuLyoqXG4gKiAvLyBUT0RPIOizquWVj+OBleOBm+OBpuOBj+OBoOOBleOBhOOAglxuXG4gMS5cbiDjgIzliKTlrprjgZnjgovjgI3jgajjgYTjgYboi7Hoqp7jga/kvZXjgpLkvb/jgaPjgabjgb7jgZnjgafjgZfjgofjgYbjgYvvvJ9cbiBmaW5kLCBqdWRnZSwgZGVjaWRlLCBjaGVjay4uLj9cblxuIDIuXG4gQm9hcmRNYW5hZ2Vy44Kv44Op44K544GuU3RhcnRHYW1l44Oh44K944OD44OJ44GuVE9ET+OBruWPgueFp+OCkuOCiOOCjeOBl+OBj+OBiumhmOOBhOOBhOOBn+OBl+OBvuOBmeOAglxuXG4gMy5cbiBKYXZhU2NyaXB044Gu5pu444GN5pa544Gu5rWB5rS+77yI77yf77yJ44GM44G+44Go44G+44Gj44Gm44GE44KL5pys44KE6KiY5LqL44CB44GC44KL44GE44Gv6Kq/44G544KL6Zqb44Gu44Kt44O844Ov44O844OJ44KS5pWZ44GI44Gm44GE44Gf44Gg44GR44Gq44GE44Gn44GX44KH44GG44GL77yfXG4g44CM44CH44CH44Kx44O844K577yIZXguIOOCreODo+ODoeODq+OCseODvOOCueOBquOBqe+8ieOAjeOBr+WNmOiqnuOBruabuOOBjeaWueOChOOBpOOBquOBjuaWueOAgVxuIOODh+OCtuOCpOODs+ODkeOCv+ODvOODs+OBr+OCr+ODqeOCue+8iOOCs+ODs+OCueODiOODqeOCr+OCv++8ieOBruW9ueWJsuOChOapn+iDveOBruWIhuOBkeaWueOBq+OBpOOBhOOBpuOBruamguW/teOBqOOBhOOBhuiqjeitmOOBquOBruOBp+OBmeOBjOOAgVxuIOOBk+OBk+OBp+aEj+WRs+OBmeOCi+a1gea0vuOBqOOBr+OAgeWkieaVsOWQjeOChOmWouaVsOWQjeOCkuS9leOCseODvOOCueOBq+OBmeOCi+OBi+OChOOAgWNzc+OBp+OBhOOBhkJFTeOChEZMT0NTU+OBruOCiOOBhuOBquOCguOBruOBp+OBmeOAglxuIO+8iOS8neOCj+OBo+OBpuOBhOOBquOBi+OBo+OBn+OCieOBmeOBv+OBvuOBm+OCky4uLuOAguadvueUsOOBleOCk+OBjOODl+ODreOCsOODqeODoOWGheOBpydfJ+OBi+OCieOBr+OBmOOBvuOCi+WkieaVsOWQjeOCkuS9v+OCj+OCjOOBpuOBhOOBn+OCiuOAgeS7peWJjeS7luOBruS6uuOBjOabuOOBhOOBn+ODl+ODreOCsOODqeODoOOBp2pRdWVyeeOCkuS9v+OBo+OBpuOBhOOBquOBhOOBruOBqyckJ+OBi+OCieOBr+OBmOOBvuOCi+WkieaVsOWQjeOCkuS9v+OBo+OBpuOBhOOCi+OBruOCkuimi+OBn+OBk+OBqOOBjOOBguOBo+OBn+OBruOBp+OAgea1gea0vuOBruOCiOOBhuOBquOCguOBruOBjOOBguOCi+OBruOBi+OBqOawl+OBq+OBquOCiuOBvuOBl+OBn+OAgu+8iVxuXG5cbiAqL1xuIl19