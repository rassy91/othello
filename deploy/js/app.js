!function(){const t=function(t){this.ctx=t,this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.color="#ffffff",this.isWhite=1,this.stonePoses=[],this.init()};t.prototype={init:function(){this.ctx.translate(1,1),this.drawBoard()},drawBoard:function(){const t=this,o=t.GRID_SIZE*(t.LINE_NUMBER-1);let e=0,i=0;t.drawRect(e,i,o,o,"#008833");for(let s=1;s<=t.LINE_NUMBER;s++)t.drawLine(e,0,e,o),e+=t.GRID_SIZE;for(let s=1;s<=t.LINE_NUMBER;s++)t.drawLine(0,i,o,i),i+=t.GRID_SIZE},drawRect:function(t,o,e,i,s){this.ctx.fillStyle=void 0!==s?s:"#000000",this.ctx.fillRect(t,o,e,i)},drawLine:function(t,o,e,i,s,n){this.ctx.strokeStyle=void 0!==s?s:"#000000",this.ctx.lineWidth=void 0!==n?n:1,this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,o=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),e=t.GRID_SIZE/2;let i,s,n=-1,c=-1,h=1,l={r:t.R};function r(r){for(let f=0;f<2;f++){i=o+n*e,s=o+c*e,l.x=i,l.y=s,l.color=r;let f=new window.myOthello.Stone(t.ctx,l);f.drawArc(l),t.stonePoses.push({instance:f,isWhite:h,pos:[Math.ceil(i/t.GRID_SIZE),Math.ceil(s/t.GRID_SIZE)]}),n*=-1,c*=-1}}r("#ffffff"),n*=-1,h*=-1,r("#000000")},putStone:function(t,o){let e=Math.ceil(t/this.GRID_SIZE),i=Math.ceil(o/this.GRID_SIZE);if(this.checkVacancy(e,i)>0)return;if(!this.checkNeighbor(e,i))return;this.checkAvailability(e,i),this.isWhite*=-1,color=this.isWhite>0?"#ffffff":"#000000";let s={x:this.GRID_SIZE*e-this.GRID_SIZE/2,y:this.GRID_SIZE*i-this.GRID_SIZE/2,r:this.R,color:color},n=new window.myOthello.Stone(this.ctx,s);n.drawArc(s),this.stonePoses.push({instance:n,isWhite:this.isWhite,pos:[e,i]})},checkVacancy:function(t,o){return this.stonePoses.filter(function(e){return e.pos[0]===t&&e.pos[1]===o}).length},checkNeighbor:function(t,o){const e=this;let i=!1,s=[[t,o+1],[t+1,o+1],[t+1,o],[t+1,o-1],[t,o-1],[t-1,o-1],[t-1,o],[t-1,o+1]];for(let n=0,c=e.stonePoses.length;n<c;n++){for(let t=0,o=s.length;t<o;t++)if(e.stonePoses[n].pos[0]===s[t][0]&&e.stonePoses[n].pos[1]===s[t][1]){i=!0;break}if(i)break}return i},checkAvailability:function(t,o){const e=this,i=7;let s=0,n=!1;!function(){s=0;let c=!1;for(let s=0,h=e.stonePoses.length;s<h;s++){for(let h=0;h<i&&!(o-h<0);h++)if(e.stonePoses[s].pos[0]===t&&e.stonePoses[s].pos[1]===o-h&&e.stonePoses[s].isWhite===-1*e.isWhite){console.log(e.stonePoses[s]);for(let t=1;t<h;t++)if(e.stonePoses[s].pos[1]===o-t&&e.stonePoses[s].isWhite===e.isWhite){console.log(e.stonePoses[s]),c=!0,n=!0;break}}if(c)break}}()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,o){this.canvas=t,this.color=o.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,o){this.ctx=t,this.color=o.color};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const o=document.getElementById("wrapper"),e=t.getContext("2d");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJHUklEX1NJWkUiLCJMSU5FX05VTUJFUiIsIlIiLCJjb2xvciIsImlzV2hpdGUiLCJzdG9uZVBvc2VzIiwiaW5pdCIsInByb3RvdHlwZSIsInRyYW5zbGF0ZSIsImRyYXdCb2FyZCIsInNlbGYiLCJmaWVsZFNpemUiLCJ4IiwieSIsImRyYXdSZWN0IiwiaSIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJzdGFydEdhbWUiLCJjZW50ZXIiLCJkaWZmIiwicG9zWCIsInBvc1kiLCJkaXIxIiwiZGlyMiIsImRhdGEiLCJyIiwic2V0Rmlyc3RTdG9uZSIsInN0b25lIiwid2luZG93IiwibXlPdGhlbGxvIiwiU3RvbmUiLCJkcmF3QXJjIiwicHVzaCIsImluc3RhbmNlIiwicG9zIiwiTWF0aCIsImNlaWwiLCJwdXRTdG9uZSIsImNsaWNrZWRYIiwiY2xpY2tlZFkiLCJudGhHcmlkWCIsIm50aEdyaWRZIiwiY2hlY2tWYWNhbmN5IiwiY2hlY2tOZWlnaGJvciIsImNoZWNrQXZhaWxhYmlsaXR5IiwibnRoWCIsIm50aFkiLCJmaWx0ZXIiLCJ2YWwiLCJsZW5ndGgiLCJoYXNOZWlnaGJvciIsIm5laWdoYm9ycyIsImoiLCJsZW4iLCJNQVhfQ09VTlQiLCJjb3VudCIsImlzQXZhaWxhYmxlIiwidG1wRmxhZyIsImNvbnNvbGUiLCJsb2ciLCJrIiwiY2hlY2tUb3AiLCJQbGF5ZXIiLCJjYW52YXMiLCJzdG9uZXMiLCJzZXRFdmVudCIsImdldENsaWNrUG9zIiwiYXJjIiwiUEkiLCJmaWxsIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwid3JhcHBlciIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiYm9hcmQiLCJlIiwib2Zmc2V0WCIsIm9mZnNldFkiXSwibWFwcGluZ3MiOiJDQUFBLFdBRUEsTUFBQUEsRUFBQSxTQUFBQyxHQUNBQyxLQUVBRCxJQUFBQSxFQUZBQyxLQUlBQyxVQUFBLEdBSkFELEtBS0FFLFlBQUEsRUFMQUYsS0FNQUcsRUFBQSxHQU5BSCxLQU1BQyxVQU5BRCxLQVFBSSxNQUFBLFVBUkFKLEtBU0FLLFFBQUEsRUFUQUwsS0FXQU0sY0FYQU4sS0FhQU8sUUFHQVQsRUFBQVUsV0FLQUQsS0FBQSxXQUNBUCxLQUdBRCxJQUFBVSxVQUFBLEVBQUEsR0FIQVQsS0FLQVUsYUFJQUEsVUFBQSxXQUNBLE1BQUFDLEVBQUFYLEtBRUFZLEVBQUFELEVBQUFWLFdBQUFVLEVBQUFULFlBQUEsR0FFQSxJQUFBVyxFQUFBLEVBQ0FDLEVBQUEsRUFFQUgsRUFBQUksU0FBQUYsRUFBQUMsRUFBQUYsRUFBQUEsRUFBQSxXQUVBLElBQUEsSUFBQUksRUFBQSxFQUFBQSxHQUFBTCxFQUFBVCxZQUFBYyxJQUNBTCxFQUFBTSxTQUFBSixFQUFBLEVBQUFBLEVBQUFELEdBQ0FDLEdBQUFGLEVBQUFWLFVBRUEsSUFBQSxJQUFBZSxFQUFBLEVBQUFBLEdBQUFMLEVBQUFULFlBQUFjLElBQ0FMLEVBQUFNLFNBQUEsRUFBQUgsRUFBQUYsRUFBQUUsR0FDQUEsR0FBQUgsRUFBQVYsV0FLQWMsU0FBQSxTQUFBRyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBakIsR0FDQUosS0FFQUQsSUFBQXVCLGVBQUEsSUFBQWxCLEVBQUFBLEVBQUEsVUFGQUosS0FHQUQsSUFBQXdCLFNBQUFMLEVBQUFDLEVBQUFDLEVBQUFDLElBSUFKLFNBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQWpCLEVBQUFvQixHQUNBeEIsS0FFQUQsSUFBQTBCLGlC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c3QgQm9hcmRNYW5hZ2VyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHNlbGYuY3R4ID0gY3R4O1xuXG4gICAgICAgIHNlbGYuR1JJRF9TSVpFID0gNTA7XG4gICAgICAgIHNlbGYuTElORV9OVU1CRVIgPSA5O1xuICAgICAgICBzZWxmLlIgPSBzZWxmLkdSSURfU0laRSAqIDAuMztcblxuICAgICAgICBzZWxmLmNvbG9yID0gJyNmZmZmZmYnO1xuICAgICAgICBzZWxmLmlzV2hpdGUgPSAxO1xuXG4gICAgICAgIHNlbGYuc3RvbmVQb3NlcyA9IFtdO1xuXG4gICAgICAgIHNlbGYuaW5pdCgpO1xuICAgIH07XG5cbiAgICBCb2FyZE1hbmFnZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKlxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8geD0wLCB5PTDjgaflhYjjga7lpKrjgZXjgYzljYrliIbjgZfmj4/lhpnjgZXjgozjgarjgYTjgZ/jgoHjgIHln7rmupbngrnjgpLjgZrjgonjgZlcbiAgICAgICAgICAgIHNlbGYuY3R4LnRyYW5zbGF0ZSgxLCAxKTtcblxuICAgICAgICAgICAgc2VsZi5kcmF3Qm9hcmQoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdCb2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgZmllbGRTaXplID0gc2VsZi5HUklEX1NJWkUgKiAoc2VsZi5MSU5FX05VTUJFUiAtIDEpO1xuXG4gICAgICAgICAgICBsZXQgeCA9IDA7XG4gICAgICAgICAgICBsZXQgeSA9IDA7XG5cbiAgICAgICAgICAgIHNlbGYuZHJhd1JlY3QoeCwgeSwgZmllbGRTaXplLCBmaWVsZFNpemUsICcjMDA4ODMzJyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoeCwgMCwgeCwgZmllbGRTaXplKTtcbiAgICAgICAgICAgICAgICB4ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kcmF3TGluZSgwLCB5LCBmaWVsZFNpemUsIHkpO1xuICAgICAgICAgICAgICAgIHkgKz0gc2VsZi5HUklEX1NJWkU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3UmVjdDogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFJlY3QoeDEsIHkxLCB4MiwgeTIpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd0xpbmU6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBjb2xvciwgd2lkdGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2VTdHlsZSA9IHR5cGVvZiBjb2xvciAhPT0gJ3VuZGVmaW5lZCcgPyBjb2xvciA6ICcjMDAwMDAwJztcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVXaWR0aCA9IHR5cGVvZiB3aWR0aCAhPT0gJ3VuZGVmaW5lZCcgPyB3aWR0aCA6IDE7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHgubW92ZVRvKHgxLCB5MSk7XG4gICAgICAgICAgICBzZWxmLmN0eC5saW5lVG8oeDIsIHkyKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5zdHJva2UoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHN0YXJ0R2FtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgY2VudGVyID0gc2VsZi5HUklEX1NJWkUgKiAoKHNlbGYuTElORV9OVU1CRVIgLSAxKSAvIDIpO1xuICAgICAgICAgICAgY29uc3QgZGlmZiA9IChzZWxmLkdSSURfU0laRSAvIDIpO1xuICAgICAgICAgICAgbGV0IGRpcjEgPSAtMTtcbiAgICAgICAgICAgIGxldCBkaXIyID0gLTE7XG4gICAgICAgICAgICBsZXQgcG9zWCwgcG9zWTtcbiAgICAgICAgICAgIGxldCBpc1doaXRlID0gMTtcbiAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHI6IHNlbGYuUlxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2V0Rmlyc3RTdG9uZSgnI2ZmZmZmZicpO1xuICAgICAgICAgICAgZGlyMSAqPSAtMTtcbiAgICAgICAgICAgIGlzV2hpdGUgKj0gLTE7XG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCcjMDAwMDAwJyk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNldEZpcnN0U3RvbmUoY29sb3IpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBwb3NYID0gY2VudGVyICsgZGlyMSAqIGRpZmY7XG4gICAgICAgICAgICAgICAgICAgIHBvc1kgPSBjZW50ZXIgKyBkaXIyICogZGlmZjtcblxuICAgICAgICAgICAgICAgICAgICBkYXRhLnggPSBwb3NYO1xuICAgICAgICAgICAgICAgICAgICBkYXRhLnkgPSBwb3NZO1xuICAgICAgICAgICAgICAgICAgICBkYXRhLmNvbG9yID0gY29sb3I7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBzdG9uZS5kcmF3QXJjKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVQb3Nlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlOiBzdG9uZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzV2hpdGU6IGlzV2hpdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3M6IFtNYXRoLmNlaWwocG9zWCAvIHNlbGYuR1JJRF9TSVpFKSwgTWF0aC5jZWlsKHBvc1kgLyBzZWxmLkdSSURfU0laRSldXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpcjEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGRpcjIgKj0gLTE7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBwdXRTdG9uZTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IG50aEdyaWRYID0gTWF0aC5jZWlsKGNsaWNrZWRYIC8gc2VsZi5HUklEX1NJWkUpO1xuICAgICAgICAgICAgbGV0IG50aEdyaWRZID0gTWF0aC5jZWlsKGNsaWNrZWRZIC8gc2VsZi5HUklEX1NJWkUpO1xuXG4gICAgICAgICAgICBpZiAoc2VsZi5jaGVja1ZhY2FuY3kobnRoR3JpZFgsIG50aEdyaWRZKSA+IDApIHtcbiAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2VsZi5jaGVja05laWdoYm9yKG50aEdyaWRYLCBudGhHcmlkWSkpIHtcbiAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghc2VsZi5jaGVja0F2YWlsYWJpbGl0eShudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAvLyByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNlbGYuaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgIGNvbG9yID0gc2VsZi5pc1doaXRlID4gMCA/ICcjZmZmZmZmJyA6ICcjMDAwMDAwJztcblxuICAgICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgeDogKHNlbGYuR1JJRF9TSVpFICogbnRoR3JpZFgpIC0gKHNlbGYuR1JJRF9TSVpFIC8gMiksXG4gICAgICAgICAgICAgICAgeTogKHNlbGYuR1JJRF9TSVpFICogbnRoR3JpZFkpIC0gKHNlbGYuR1JJRF9TSVpFIC8gMiksXG4gICAgICAgICAgICAgICAgcjogc2VsZi5SLFxuICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvclxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgc2VsZi5zdG9uZVBvc2VzLnB1c2goe1xuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBzdG9uZSxcbiAgICAgICAgICAgICAgICBpc1doaXRlOiBzZWxmLmlzV2hpdGUsXG4gICAgICAgICAgICAgICAgcG9zOiBbbnRoR3JpZFgsIG50aEdyaWRZXVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjaGVja1ZhY2FuY3k6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gc2VsZi5zdG9uZVBvc2VzLmZpbHRlcihmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsLnBvc1swXSA9PT0gbnRoWCAmJiB2YWwucG9zWzFdID09PSBudGhZO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQubGVuZ3RoO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgY2hlY2tOZWlnaGJvcjogZnVuY3Rpb24obnRoWCwgbnRoWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGxldCBoYXNOZWlnaGJvciA9IGZhbHNlO1xuXG4gICAgICAgICAgICBsZXQgbmVpZ2hib3JzID0gW1xuICAgICAgICAgICAgICAgIFtudGhYLCBudGhZICsgMV0sICAgICAgIC8vIOS4ilxuICAgICAgICAgICAgICAgIFtudGhYICsgMSwgbnRoWSArIDFdLCAgIC8vIOWPs+S4ilxuICAgICAgICAgICAgICAgIFtudGhYICsgMSwgbnRoWV0sICAgICAgIC8vIOWPs1xuICAgICAgICAgICAgICAgIFtudGhYICsgMSwgbnRoWSAtIDFdLCAgIC8vIOWPs+S4i1xuICAgICAgICAgICAgICAgIFtudGhYLCBudGhZIC0gMV0sICAgICAgIC8vIOS4i1xuICAgICAgICAgICAgICAgIFtudGhYIC0gMSwgbnRoWSAtIDFdLCAgIC8vIOW3puS4i1xuICAgICAgICAgICAgICAgIFtudGhYIC0gMSwgbnRoWV0sICAgICAgIC8vIOW3plxuICAgICAgICAgICAgICAgIFtudGhYIC0gMSwgbnRoWSArIDFdICAgIC8vIOW3puS4ilxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHNlbGYuc3RvbmVQb3Nlcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwLCBsZW4gPSBuZWlnaGJvcnMubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMF0gPT09IG5laWdoYm9yc1tqXVswXSAmJiBzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzFdID09PSBuZWlnaGJvcnNbal1bMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc05laWdoYm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChoYXNOZWlnaGJvcikge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBoYXNOZWlnaGJvcjtcbiAgICAgICAgfSxcblxuICAgICAgICBjaGVja0F2YWlsYWJpbGl0eTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgTUFYX0NPVU5UID0gNztcbiAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgICAgICBsZXQgdG1wRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGlzQXZhaWxhYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIOe9ruOBkeOCi+adoeS7tlxuICAgICAgICAgICAgLy8g5bem5Y+z44CB5LiK5LiL44CB5pac44KBNDXluqbkuIrjgavlkIzjgZjoibLjga7nn7PjgYzjgYLjgosg44GL44GkIOOBneOBruWQjOOBmOiJsuOBruefs+OBqOiHqui6q+OBrumWk+OBq+mamemWk+OBquOBj+WIpeOBruiJsuOBruefs+OBjOOBguOCi1xuXG4gICAgICAgICAgICAvLyDkuIogICAgW250aFgsIG50aFkgKyAxXSxcbiAgICAgICAgICAgIC8vIOWPs+S4iiAgIFtudGhYICsgMSwgbnRoWSArIDFdLFxuICAgICAgICAgICAgLy8g5Y+zICAgIFtudGhYICsgMSwgbnRoWV0sXG4gICAgICAgICAgICAvLyDlj7PkuIsgICBbbnRoWCArIDEsIG50aFkgLSAxXSxcbiAgICAgICAgICAgIC8vIOS4iyAgICBbbnRoWCwgbnRoWSAtIDFdLFxuICAgICAgICAgICAgLy8g5bem5LiLICAgW250aFggLSAxLCBudGhZIC0gMV0sXG4gICAgICAgICAgICAvLyDlt6YgICAgW250aFggLSAxLCBudGhZXSxcbiAgICAgICAgICAgIC8vIOW3puS4iiAgIFtudGhYIC0gMSwgbnRoWSArIDFdXG4gICAgICAgICAgICAvLyDjgafjgZ3jgozjgZ7jgozjg4Hjgqfjg4Pjgq/jgZnjgovvvJ9cblxuICAgICAgICAgICAgY2hlY2tUb3AoKTtcblxuICAgICAgICAgICAgLy8g5LiK44OB44Kn44OD44KvXG4gICAgICAgICAgICBmdW5jdGlvbiBjaGVja1RvcCgpIHtcblxuICAgICAgICAgICAgICAgIGNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICBsZXQgdG1wRmxhZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbmd0aCA9IHNlbGYuc3RvbmVQb3Nlcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IE1BWF9DT1VOVDsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbGlja2VkWSAtIGogPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiHqui6q+OBqOWQjOWIl+OBi+OBpOWQjOihjOOBq+efs+OBjOOBguOCiuOAgeOBi+OBpOWQjOOBmOiJsuOBruWgtOWQiO+8iOiHqui6q+OBq+i/keOBhOS9jee9ruOBi+OCieWIpOWumu+8iVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMF0gPT09IGNsaWNrZWRYICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMV0gPT09IGNsaWNrZWRZIC0gaiAmJiBzZWxmLnN0b25lUG9zZXNbaV0uaXNXaGl0ZSA9PT0gc2VsZi5pc1doaXRlICogLTEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuc3RvbmVQb3Nlc1tpXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDoh6rouqvjgajlkIzliJfjgYvjgaTlkIzooYzjgavjgYLjgovlkIzjgZjoibLjga7nn7PjgYvjgonjgIHjgYvjgaTlkIzjgZjoibLjga7loLTlkIjvvIjoh6rouqvjgavov5HjgYTkvY3nva7jgYvjgonliKTlrprvvIlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMTsgayA8IGo7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1sxXSA9PT0gY2xpY2tlZFkgLSBrICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5pc1doaXRlID09PSBzZWxmLmlzV2hpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuc3RvbmVQb3Nlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWxmLnN0b25lUG9zZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRtcEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzQXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0bXBGbGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9XG5cblxuXG5cblxuXG5cblxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cubXlPdGhlbGxvID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB3aW5kb3cubXlPdGhlbGxvID0ge307XG4gICAgfVxuICAgIHdpbmRvdy5teU90aGVsbG8uQm9hcmRNYW5hZ2VyID0gQm9hcmRNYW5hZ2VyO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBjb25zdCBQbGF5ZXIgPSBmdW5jdGlvbihjYW52YXMsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jYW52YXMgPSBjYW52YXM7XG5cbiAgICAgICAgc2VsZi5jb2xvciA9IGRhdGEuY29sb3I7XG4gICAgICAgIHNlbGYuc3RvbmVzID0gW107XG5cbiAgICAgICAgc2VsZi5pbml0KCk7XG4gICAgfTtcblxuICAgIFBsYXllci5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5zZXRFdmVudCgpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldEV2ZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBzZWxmLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhlLm9mZnNldFgpO1xuICAgICAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBnZXRDbGlja1BvczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5QbGF5ZXIgPSBQbGF5ZXI7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IFN0b25lID0gZnVuY3Rpb24oY3R4LCBkYXRhKSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHNlbGYuY3R4ID0gY3R4O1xuICAgICAgICBzZWxmLmNvbG9yID0gZGF0YS5jb2xvcjtcblxuICAgIH07XG5cbiAgICBTdG9uZS5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgZHJhd0FyYzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHguYXJjKGRhdGEueCwgZGF0YS55LCBkYXRhLnIsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGxTdHlsZSA9IGRhdGEuY29sb3I7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5jbG9zZVBhdGgoKTtcblxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5TdG9uZSA9IFN0b25lO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpO1xuXG4gICAgICAgIGlmICghY2FudmFzLmdldENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3JhcHBlcicpO1xuICAgICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICAgICAgY3R4LmNhbnZhcy53aWR0aCA9IHdyYXBwZXIuY2xpZW50V2lkdGg7XG4gICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ID0gd3JhcHBlci5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgbGV0IHBsYXllckRhdGEgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2U6IG51bGwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3doaXRlJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2U6IG51bGwsXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ2JsYWNrJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcblxuICAgICAgICBjb25zdCBib2FyZCA9IG5ldyBteU90aGVsbG8uQm9hcmRNYW5hZ2VyKGN0eCk7XG5cbiAgICAgICAgYm9hcmQuc3RhcnRHYW1lKCk7XG5cbiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICBib2FyZC5wdXRTdG9uZShlLm9mZnNldFgsIGUub2Zmc2V0WSk7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgLy8g44OV44Kj44O844Or44OJ44KS5pu444GP77yIOHg477yJXG4gICAgICAgIC8vIOWQhOODnuOCueebruOBruOCqOODquOCouaDheWgseOCkuS/neaMge+8iHN0YXJ0WCwgc3RhcnRZLCBlbmRYLCBlbmRZ77yJXG4gICAgICAgIC8vICAgICAg44Kv44Oq44OD44Kv44GX44Gf5L2N572u44GoY2FudmFz5LiK44Gu5L2N572u44Gu5aSJ5o+b44GM5b+F6KaB77yfXG4gICAgICAgIC8vIOODl+ODrOOCpOODpOODvOeZveODu+m7kuOCkuOCu+ODg+ODiFxuICAgICAgICAvLyAgICAgIOODleODqeOCsOOBq+OBmeOCi++8n1xuICAgICAgICAvLyDkuK3lpK7jgavnmb3pu5Iy44GT44Ga44Gk44K744OD44OIXG5cbiAgICAgICAgLy8g5ZCE44OX44Os44Kk44Ok44O844Gu572u44GE44Gf55+z44KS5L+d5oyB44GZ44KL6YWN5YiXXG4gICAgICAgIC8vXG5cblxuXG4gICAgfSk7XG5cbn0oKSk7XG5cbi8qKlxuICogLy8gVE9ETyDos6rllY9cbiAqXG4gKiAxLlxuIOOAjOWIpOWumuOBmeOCi+OAjeOBqOOBhOOBhuiLseiqnuOBr+S9leOCkuS9v+OBo+OBpuOBvuOBmeOBi++8n1xuXG4gZmluZD8ganVkZ2U/IGRlY2lkZT9cblxuXG4gMi5cbiBjaHJvbWXjga5kZXbjg4Tjg7zjg6vjgafjgqTjg7Pjgrnjgr/jg7PjgrnjgavlhaXjgaPjgabjgYTjgot044Go44Gv44Gq44KT44Gu5oSP5ZGz44CB55Wl77yI77yf77yJ44Gn44GZ44GL77yf44Kk44Oz44K544K/44Oz44K544KS44Ot44Kw44Gr5Ye644GZ44GodOOBqOOBquOCi++8n1xuIGJvYXJkLnN0YXJ0R2FtZeOBruacgOW+jOOBp2NvbnNvbGUubG9nKHNlbGYuc3RvbmVQb3Nlcyk744GZ44KL44Go56K66KqN44Gn44GN44KLXG5cbiAqL1xuIl19