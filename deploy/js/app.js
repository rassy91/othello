!function(){const t=function(t){this.ctx=t,this.cautionText=document.getElementById("caution"),this.stoneColorText=document.getElementById("stoneColor"),this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.isWhite=1,this.board=[],this.turnStones=[],this.toggleCautionClassName="isVisible",this.toggleTextClassName="js-isWhite",this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let e=1;e<t.LINE_NUMBER;e++){let e=[];for(let o=1;o<t.LINE_NUMBER;o++)e.push({});t.board.push(e)}},drawBoard:function(){const t=this,e=t.GRID_SIZE*(t.LINE_NUMBER-1);let o=0,i=0;t.drawRect(o,i,e,e,"#008833");for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(o,0,o,e),o+=t.GRID_SIZE;for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(0,i,e,i),i+=t.GRID_SIZE},drawRect:function(t,e,o,i,n){this.ctx.fillStyle=void 0!==n?n:"#000000",this.ctx.fillRect(t,e,o,i)},drawLine:function(t,e,o,i,n,s){this.ctx.strokeStyle=void 0!==n?n:"#000000",this.ctx.lineWidth=void 0!==s?s:1,this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(o,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,e=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),o=t.GRID_SIZE/2;let i,n,s=-1,l=-1,c=1;function h(){for(let h=0;h<2;h++){let h={r:t.R};i=e+s*o,n=e+l*o,h.x=i,h.y=n,h.isWhite=c;let a=new window.myOthello.Stone(t.ctx,h);a.drawArc(h);let r=t.board[Math.floor(n/t.GRID_SIZE)][Math.floor(i/t.GRID_SIZE)];r.instance=a,r.isWhite=c,s*=-1,l*=-1}}h(),s*=-1,c*=-1,h(),console.log(t.board)},showCaution:function(){const t=this;t.cautionText.classList.contains(t.toggleCautionClassName)||(t.cautionText.classList.add(t.toggleCautionClassName),setTimeout(function(){t.cautionText.classList.remove(t.toggleCautionClassName)},1e3))},putStone:function(t,e){const o=this;let i=Math.floor(t/o.GRID_SIZE),n=Math.floor(e/o.GRID_SIZE);if(!o.checkVacancy(i,n))return void o.showCaution();if(!o.checkNeighbor(i,n))return void o.showCaution();if(!o.checkIfPossible(i,n))return void o.showCaution();o.isWhite*=-1;let s={x:o.GRID_SIZE*i+o.GRID_SIZE/2,y:o.GRID_SIZE*n+o.GRID_SIZE/2,r:o.R,isWhite:o.isWhite},l=new window.myOthello.Stone(o.ctx,s);l.drawArc(s);let c=o.board[n][i];c.instance=l,c.isWhite=o.isWhite,c.x=i,c.y=n,o.turnStones.length>0&&(o.turnStones.forEach(function(t){t.isWhite*=-1,t.instance.reverse()}),o.turnStones.length=0),o.stoneColorText.classList.contains(o.toggleTextClassName)?(o.stoneColorText.textContent="黒",o.stoneColorText.classList.remove(o.toggleTextClassName)):(o.stoneColorText.textContent="白",o.stoneColorText.classList.add(o.toggleTextClassName))},checkVacancy:function(t,e){return Object.keys(this.board[e][t]).length<=0},checkNeighbor:function(t,e){const o=this;let i,n,s=[[t,e-1],[t+1,e-1],[t+1,e],[t+1,e+1],[t,e+1],[t-1,e+1],[t-1,e],[t-1,e-1]];for(let l=0,c=s.length;l<c;l++)if(i=s[l][0],n=s[l][1],!(i<0||i>7||n<0||n>7)&&Object.keys(o.board[n][i]).length>0)return!0},checkIfPossible:function(t,e){const o=this,i=o.LINE_NUMBER-1-1;let n,s,l,c=!1,h=null,a=null,r=[],d=[[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,1],[1,-1],[-1,1]];return function(){for(let f=0,u=d.length;f<u;f++){n=!1,s=d[f][0],l=d[f][1];for(let d=1;!(!(d<=i)||s<0&&e+s*d<0||s>0&&e+s*d>i||l<0&&t+l*d<0||l>0&&t+l*d>i);d++)if(h=o.board[e+s*d][t+l*d],Object.keys(h).length>0&&-1*h.isWhite===o.isWhite){for(let i=1;i<d;i++){if((a=o.board[e+s*i][t+l*i]).y=e+s*i,a.x=t+l*i,!(Object.keys(a).length>0&&a.isWhite===o.isWhite)){n=!1,r.length=0,delete a.x,delete a.y;break}n=!0,r.push(a)}if(n){for(let t=0,e=r.length;t<e;t++)o.turnStones.push(r[t]);r.length=0,c=!0;break}}}}(),c}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,e){this.canvas=t,this.color=e.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,e){this.ctx=t,this.data=e,this.isWhite=e.isWhite};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=this.isWhite>0?"#ffffff":"#000000",this.ctx.fill(),this.ctx.closePath()},reverse:function(){this.isWhite*=-1,this.drawArc(this.data)}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const e=t.getContext("2d"),o=document.getElementById("canvasWrapper");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJjYXV0aW9uVGV4dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzdG9uZUNvbG9yVGV4dCIsIkdSSURfU0laRSIsIkxJTkVfTlVNQkVSIiwiUiIsImlzV2hpdGUiLCJib2FyZCIsInR1cm5TdG9uZXMiLCJ0b2dnbGVDYXV0aW9uQ2xhc3NOYW1lIiwidG9nZ2xlVGV4dENsYXNzTmFtZSIsImluaXQiLCJwcm90b3R5cGUiLCJzZWxmIiwidHJhbnNsYXRlIiwiZHJhd0JvYXJkIiwiaSIsInJvdyIsImoiLCJwdXNoIiwiZmllbGRTaXplIiwieCIsInkiLCJkcmF3UmVjdCIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJjb2xvciIsImZpbGxTdHlsZSIsImZpbGxSZWN0Iiwid2lkdGgiLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsImJlZ2luUGF0aCIsIm1vdmVUbyIsImxpbmVUbyIsImNsb3NlUGF0aCIsInN0cm9rZSIsInN0YXJ0R2FtZSIsImNlbnRlciIsImRpZmYiLCJwb3NYIiwicG9zWSIsImRpcjEiLCJkaXIyIiwic2V0Rmlyc3RTdG9uZSIsImRhdGEiLCJyIiwic3RvbmUiLCJ3aW5kb3ciLCJteU90aGVsbG8iLCJTdG9uZSIsImRyYXdBcmMiLCJvYmoiLCJNYXRoIiwiZmxvb3IiLCJpbnN0YW5jZSIsImNvbnNvbGUiLCJsb2ciLCJzaG93Q2F1dGlvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkIiwic2V0VGltZW91dCIsInJlbW92ZSIsInB1dFN0b25lIiwiY2xpY2tlZFgiLCJjbGlja2VkWSIsIm50aEdyaWRYIiwibnRoR3JpZFkiLCJjaGVja1ZhY2FuY3kiLCJjaGVja05laWdoYm9yIiwiY2hlY2tJZlBvc3NpYmxlIiwibGVuZ3RoIiwiZm9yRWFjaCIsInZhbCIsInJldmVyc2UiLCJ0ZXh0Q29udGVudCIsIm50aFgiLCJudGhZIiwiT2JqZWN0Iiwia2V5cyIsImxpbmUiLCJuZWlnaGJvcnMiLCJsZW4iLCJNQVhfQ09VTlQiLCJpc1RtcFBvc3NpYmxlIiwiZGlyWSIsImRpclgiLCJpc1Bvc3NpYmxlIiwidG1wT2JqIiwidG1wVHVyblN0b25lcyIsImNoZWNrRGlycyIsImsiLCJjaGVjayIsIlBsYXllciIsImNhbnZhcyIsInN0b25lcyIsInNldEV2ZW50IiwiZ2V0Q2xpY2tQb3MiLCJhcmMiLCJQSSIsImZpbGwiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0Q29udGV4dCIsIndyYXBwZXIiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsImUiLCJvZmZzZXRYIiwib2Zmc2V0WSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FRQSxNQUFBQSxFQUFBLFNBQUFDLEdBQ0FDLEtBRUFELElBQUFBLEVBRkFDLEtBS0FDLFlBQUFDLFNBQUFDLGVBQUEsV0FMQUgsS0FNQUksZUFBQUYsU0FBQUMsZUFBQSxjQU5BSCxLQVNBSyxVQUFBLEdBVEFMLEtBVUFNLFlBQUEsRUFWQU4sS0FZQU8sRUFBQSxHQVpBUCxLQVlBSyxVQVpBTCxLQWdCQVEsUUFBQSxFQWhCQVIsS0FtQkFTLFNBbkJBVCxLQXNCQVUsY0F0QkFWLEtBeUJBVyx1QkFBQSxZQXpCQVgsS0EwQkFZLG9CQUFBLGFBMUJBWixLQTRCQWEsUUFHQWYsRUFBQWdCLFdBS0FELEtBQUEsV0FDQSxNQUFBRSxFQUFBZixLQUdBZSxFQUFBaEIsSUFBQWlCLFVBQUEsRUFBQSxHQUdBRCxFQUFBRSxZQUdBLElBQUEsSUFBQUMsRUFBQSxFQUFBQSxFQUFBSCxFQUFBVCxZQUFBWSxJQUFBLENBQ0EsSUFBQUMsS0FFQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUwsRUFBQVQsWUFBQWMsSUFDQUQsRUFBQUUsU0FHQU4sRUFBQU4sTUFBQVksS0FBQUYsS0FRQUYsVUFBQSxXQUNBLE1BQUFGLEVBQUFmLEtBRUFzQixF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QUVBRCxJQUFBc0MsWUFGQXJDLEtBR0FELElBQUF5RyxJQUFBdEQsRUFBQTNCLEVBQUEyQixFQUFBMUIsRUFBQTBCLEVBQUFDLEVBQUEsRUFBQSxFQUFBTyxLQUFBK0MsSUFBQSxHQUhBekcsS0FJQUQsSUFBQWlDLFVBSkFoQyxLQUlBUSxRQUFBLEVBQUEsVUFBQSxVQUpBUixLQUtBRCxJQUFBMkcsT0FMQTFHLEtBTUFELElBQUF5QyxhQU9Bd0MsUUFBQSxXQUNBaEYsS0FFQVEsVUFBQSxFQUZBUixLQUlBd0QsUUFKQXhELEtBSUFrRCxhQUtBLElBQUFHLE9BQUFDLFlBQ0FELE9BQUFDLGNBRUFELE9BQUFDLFVBQUFDLE1BQUFBLEVBbERBLEdDRUFyRCxTQUFBeUcsaUJBQUEsbUJBQUEsV0FFQSxNQUFBUCxFQUFBbEcsU0FBQUMsZUFBQSxVQUVBLElBQUFpRyxFQUFBUSxXQUNBLE9BR0EsTUFBQTdHLEVBQUFxRyxFQUFBUSxXQUFBLE1BQ0FDLEVBQUEzRyxTQUFBQyxlQUFBLGlCQUNBSixFQUFBcUcsT0FBQWxFLE1BQUEyRSxFQUFBQyxZQUNBL0csRUFBQXFHLE9BQUFXLE9BQUFGLEVBQUFHLGFBRUEsTUFBQXZHLEVBQUEsSUFBQTZDLFVBQUF4RCxhQUFBQyxHQUdBVSxFQUFBaUMsWUFHQTBELEVBQUFPLGlCQUFBLFFBQUEsU0FBQU0sR0FFQXhHLEVBQUE0RCxTQUFBNEMsRUFBQUMsUUFBQUQsRUFBQUUiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbigpIHtcblxuICAgIC8qKlxuICAgICAqIOOCs+ODs+OCueODiOODqeOCr+OCv1xuICAgICAqIOODnOODvOODieOBrueKtuaFi+OCkueuoeeQhuOBmeOCi1xuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjdHhcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdCBCb2FyZE1hbmFnZXIgPSBmdW5jdGlvbihjdHgpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG5cbiAgICAgICAgLy8gRE9NXG4gICAgICAgIHNlbGYuY2F1dGlvblRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2F1dGlvbicpO1xuICAgICAgICBzZWxmLnN0b25lQ29sb3JUZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b25lQ29sb3InKTtcblxuICAgICAgICAvL+WApFxuICAgICAgICBzZWxmLkdSSURfU0laRSA9IDUwO1xuICAgICAgICBzZWxmLkxJTkVfTlVNQkVSID0gOTtcbiAgICAgICAgLy8g55+z44Gu5Y2K5b6EXG4gICAgICAgIHNlbGYuUiA9IHNlbGYuR1JJRF9TSVpFICogMC4zO1xuXG4gICAgICAgIC8vIOeZvem7kuWIpOWumuODleODqeOCsFxuICAgICAgICAvLyAx44Gn55m944CBLTHjgafpu5JcbiAgICAgICAgc2VsZi5pc1doaXRlID0gMTtcblxuICAgICAgICAvLyDjgZ3jgozjgZ7jgozjga7jg57jgrnnm67jga7mg4XloLHjgpLmoLzntI1cbiAgICAgICAgc2VsZi5ib2FyZCA9IFtdO1xuXG4gICAgICAgIC8vIOOBsuOBo+OBj+OCiui/lOOBmeefs+OCkuS4gOaZgueahOOBq+agvOe0jeOBmeOCi1xuICAgICAgICBzZWxmLnR1cm5TdG9uZXMgPSBbXTtcblxuICAgICAgICAvL1xuICAgICAgICBzZWxmLnRvZ2dsZUNhdXRpb25DbGFzc05hbWUgPSAnaXNWaXNpYmxlJztcbiAgICAgICAgc2VsZi50b2dnbGVUZXh0Q2xhc3NOYW1lID0gJ2pzLWlzV2hpdGUnO1xuXG4gICAgICAgIHNlbGYuaW5pdCgpO1xuICAgIH07XG5cbiAgICBCb2FyZE1hbmFnZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDliJ3mnJ/ljJZcbiAgICAgICAgICovXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHg9MCwgeT0w44Gn5YWI44Gu5aSq44GV44GM5Y2K5YiG44GX5o+P5YaZ44GV44KM44Gq44GE44Gf44KB44CB5Z+65rqW54K544KS44Ga44KJ44GZXG4gICAgICAgICAgICBzZWxmLmN0eC50cmFuc2xhdGUoMSwgMSk7XG5cbiAgICAgICAgICAgIC8vIOODnOODvOODieOCkuaPj+WGmVxuICAgICAgICAgICAgc2VsZi5kcmF3Qm9hcmQoKTtcblxuICAgICAgICAgICAgLy8g5ZCE44Oe44K555uu44Gr5oOF5aCx5L+d5oyB55So44Gu44Kq44OW44K444Kn44Kv44OI44KS44KC44Gf44Gb44Gm44Oc44O844OJ5oOF5aCx44Gu6YWN5YiX44Gr5qC857SNXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIGxldCByb3cgPSBbXTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAxOyBqIDwgc2VsZi5MSU5FX05VTUJFUjsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJvdy5wdXNoKHt9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZWxmLmJvYXJkLnB1c2gocm93KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjg5zjg7zjg4njgpLmj4/lhplcbiAgICAgICAgICovXG4gICAgICAgIGRyYXdCb2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgY29uc3QgZmllbGRTaXplID0gc2VsZi5HUklEX1NJWkUgKiAoc2VsZi5MSU5FX05VTUJFUiAtIDEpO1xuXG4gICAgICAgICAgICBsZXQgeCA9IDA7XG4gICAgICAgICAgICBsZXQgeSA9IDA7XG5cbiAgICAgICAgICAgIHNlbGYuZHJhd1JlY3QoeCwgeSwgZmllbGRTaXplLCBmaWVsZFNpemUsICcjMDA4ODMzJyk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoeCwgMCwgeCwgZmllbGRTaXplKTtcbiAgICAgICAgICAgICAgICB4ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kcmF3TGluZSgwLCB5LCBmaWVsZFNpemUsIHkpO1xuICAgICAgICAgICAgICAgIHkgKz0gc2VsZi5HUklEX1NJWkU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog5Zub6KeS5b2i44KS5o+P5YaZXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHgyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sb3JcbiAgICAgICAgICovXG4gICAgICAgIGRyYXdSZWN0OiBmdW5jdGlvbih4MSwgeTEsIHgyLCB5MiwgY29sb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsU3R5bGUgPSB0eXBlb2YgY29sb3IgIT09ICd1bmRlZmluZWQnID8gY29sb3IgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsUmVjdCh4MSwgeTEsIHgyLCB5Mik7XG5cbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICog57ea44KS5o+P5YaZXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4MVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geTFcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHgyXG4gICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5MlxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY29sb3JcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAgICAgICAqL1xuICAgICAgICBkcmF3TGluZTogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yLCB3aWR0aCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZVN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHgubGluZVdpZHRoID0gdHlwZW9mIHdpZHRoICE9PSAndW5kZWZpbmVkJyA/IHdpZHRoIDogMTtcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5tb3ZlVG8oeDEsIHkxKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVUbyh4MiwgeTIpO1xuICAgICAgICAgICAgc2VsZi5jdHguY2xvc2VQYXRoKCk7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOOCsuODvOODoOOCueOCv+ODvOODiOaZguOBq+Wun+ihjFxuICAgICAgICAgKi9cbiAgICAgICAgc3RhcnRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBjZW50ZXIgPSBzZWxmLkdSSURfU0laRSAqICgoc2VsZi5MSU5FX05VTUJFUiAtIDEpIC8gMik7XG4gICAgICAgICAgICBjb25zdCBkaWZmID0gKHNlbGYuR1JJRF9TSVpFIC8gMik7XG4gICAgICAgICAgICBsZXQgZGlyMSA9IC0xO1xuICAgICAgICAgICAgbGV0IGRpcjIgPSAtMTtcbiAgICAgICAgICAgIGxldCBwb3NYLCBwb3NZO1xuICAgICAgICAgICAgbGV0IGlzV2hpdGUgPSAxO1xuXG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCk7XG4gICAgICAgICAgICBkaXIxICo9IC0xO1xuICAgICAgICAgICAgaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgIHNldEZpcnN0U3RvbmUoKTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDliJ3mnJ/kvY3nva7jgavnn7PjgpLjgrvjg4Pjg4hcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gc2V0Rmlyc3RTdG9uZSgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8g6Ieq5YiG55So44Oh44Oi77ya6Zai5pWw44Gu5aSW5YG044Gn5a6a576p44GX44Gm44GK44KK44CB44Kq44OW44K444Kn44Kv44OI44Gu5Y+C54Wn5rih44GX44Gn5byV44Gj44GL44GL44Gj44GfXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcjogc2VsZi5SXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgcG9zWCA9IGNlbnRlciArIGRpcjEgKiBkaWZmO1xuICAgICAgICAgICAgICAgICAgICBwb3NZID0gY2VudGVyICsgZGlyMiAqIGRpZmY7XG5cbiAgICAgICAgICAgICAgICAgICAgZGF0YS54ID0gcG9zWDtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS55ID0gcG9zWTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pc1doaXRlID0gaXNXaGl0ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyDjgqTjg7Pjgrnjgr/jg7PjgrnjgpLkvZzmiJBcbiAgICAgICAgICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAvLyDnn7PjgpLmj4/lhplcbiAgICAgICAgICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyDjg5zjg7zjg4njga7phY3liJfjga7oqbLlvZPkvY3nva7jgavjgqTjg7Pjgrnjgr/jg7Pjgrnjgajnj77lnKjjga7nmb3pu5LnirbmhYvjgpLmoLzntI1cbiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHNlbGYuYm9hcmRbTWF0aC5mbG9vcihwb3NZIC8gc2VsZi5HUklEX1NJWkUpXVtNYXRoLmZsb29yKHBvc1ggLyBzZWxmLkdSSURfU0laRSldO1xuICAgICAgICAgICAgICAgICAgICBvYmouaW5zdGFuY2UgPSBzdG9uZTtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmlzV2hpdGUgPSBpc1doaXRlO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpcjEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGRpcjIgKj0gLTE7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFRPRE8gOiDos6rllY/jgZXjgZvjgabjgY/jgaDjgZXjgYTjgIJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYuYm9hcmQpO1xuICAgICAgICAgICAgLy8gVE9ETyDkuIrjga7jgojjgYbjgavjg63jgrDjgavlh7rjgZnjgajjgIHku6XkuIvjga7jgojjgYbjgavooajnpLrjgZXjgozjgb7jgZnjgIJcbiAgICAgICAgICAgIC8vIHtcbiAgICAgICAgICAgIC8vICAgICBpbnN0YW5jZTogdCB7a2V5MTogdmFsdWUxLCBrZXkyOiB2YWx1ZTIsIC4uLn0sXG4gICAgICAgICAgICAvLyAgICAga2V5QTogdmFsdWVBLFxuICAgICAgICAgICAgLy8gICAgIC4uLlxuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gVE9ETyDjgZPjgZPjga4gJ3QnIOOBqOOBr+OBquOCk+OBruaEj+WRs+OAgeOBguOCi+OBhOOBr+OBquOCk+OBruWNmOiqnuOBrueVpeOBp+OBl+OCh+OBhuOBi++8n1xuICAgICAgICAgICAgLy8gVE9ETyDvvIjjgqTjg7Pjgrnjgr/jg7PjgrnjgYzlhaXjgovjgaggJ3QnIOOBqOOBquOCi+OBruOBi+OBqOaAneOBhOOBvuOBmeOBjOOAgeacrOW9k+OBq+OCpOODs+OCueOCv+ODs+OCueOBquOBruOBi+OAgeOCpOODs+OCueOCv+ODs+OCueOBruWgtOWQiCd0J+OBqOOBr+OBquOCk+OBrueVpeOBquOBruOBi+OBjOiqv+OBueOBpuOCguOCj+OBi+OCiuOBvuOBm+OCk+OBp+OBl+OBn+OAguOBlOaVmeaOiOOBhOOBn+OBoOOBkeOBvuOBmeOBqOW5uOOBhOOBp+OBmeOAgu+8iVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkue9ruOBkeOBquOBhOS9jee9ruOBruWgtOWQiOOAgeazqOaEj+abuOOBjeOCkuihqOekuuOBmeOCi1xuICAgICAgICAgKi9cbiAgICAgICAgc2hvd0NhdXRpb246IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghc2VsZi5jYXV0aW9uVGV4dC5jbGFzc0xpc3QuY29udGFpbnMoc2VsZi50b2dnbGVDYXV0aW9uQ2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuY2F1dGlvblRleHQuY2xhc3NMaXN0LmFkZChzZWxmLnRvZ2dsZUNhdXRpb25DbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2F1dGlvblRleHQuY2xhc3NMaXN0LnJlbW92ZShzZWxmLnRvZ2dsZUNhdXRpb25DbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIH0sIDEwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkue9ruOBj+WHpueQhlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gY2xpY2tlZFggOiBjYW52YXPkuIrjga7jgq/jg6rjg4Pjgq/kvY3nva5cbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGNsaWNrZWRZIDogY2FudmFz5LiK44Gu44Kv44Oq44OD44Kv5L2N572uXG4gICAgICAgICAqL1xuICAgICAgICBwdXRTdG9uZTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8g5L2V55Wq55uu44Gu44Oe44K544GLXG4gICAgICAgICAgICBsZXQgbnRoR3JpZFggPSBNYXRoLmZsb29yKGNsaWNrZWRYIC8gc2VsZi5HUklEX1NJWkUpO1xuICAgICAgICAgICAgbGV0IG50aEdyaWRZID0gTWF0aC5mbG9vcihjbGlja2VkWSAvIHNlbGYuR1JJRF9TSVpFKTtcblxuICAgICAgICAgICAgLy8g55+z44GM572u44GR44KL44GL44Gu5Yik5a6aXG4gICAgICAgICAgICBpZiAoIXNlbGYuY2hlY2tWYWNhbmN5KG50aEdyaWRYLCBudGhHcmlkWSkpIHtcbiAgICAgICAgICAgICAgICAvLyDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznqbrjgYvjganjgYbjgYtcblxuICAgICAgICAgICAgICAgIC8vIOefs+OCkue9ruOBkeOBquOBhOS9jee9ruOBruWgtOWQiOOAgeazqOaEj+abuOOBjeOCkuihqOekuuOBmeOCi1xuICAgICAgICAgICAgICAgIHNlbGYuc2hvd0NhdXRpb24oKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXNlbGYuY2hlY2tOZWlnaGJvcihudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44Gr44Go44Gq44KK5ZCI44Gj44Gm44GE44KL44GL44Gp44GG44GLXG5cbiAgICAgICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dDYXV0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFzZWxmLmNoZWNrSWZQb3NzaWJsZShudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf44Oe44K544GM55+z44KS44Gy44Gj44GP44KK6L+U44Gb44KL44Oe44K544GL44Gp44GG44GLXG5cbiAgICAgICAgICAgICAgICAvLyDnn7PjgpLnva7jgZHjgarjgYTkvY3nva7jga7loLTlkIjjgIHms6jmhI/mm7jjgY3jgpLooajnpLrjgZnjgotcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dDYXV0aW9uKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIOefs+OCkue9ruOBkeOBn+WgtOWQiOOAgeiJsuOCkuWPjei7olxuICAgICAgICAgICAgc2VsZi5pc1doaXRlICo9IC0xO1xuXG4gICAgICAgICAgICAvLyDjgqTjg7Pjgrnjgr/jg7PjgrnjgavmuKHjgZnmg4XloLFcbiAgICAgICAgICAgIGxldCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIHg6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRYKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHk6IChzZWxmLkdSSURfU0laRSAqIG50aEdyaWRZKSArIChzZWxmLkdSSURfU0laRSAvIDIpLFxuICAgICAgICAgICAgICAgIHI6IHNlbGYuUixcbiAgICAgICAgICAgICAgICBpc1doaXRlOiBzZWxmLmlzV2hpdGVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIOOCpOODs+OCueOCv+ODs+OCueOCkuS9nOaIkFxuICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgLy8g5Y+v6Kqt5oCn44Gu44Gf44KB44CB44GE44Gj44Gf44KT5aSJ5pWw44Gr6Kmy5b2T44Kq44OW44K444Kn44Kv44OI44KS5qC857SNXG4gICAgICAgICAgICBsZXQgb2JqID0gc2VsZi5ib2FyZFtudGhHcmlkWV1bbnRoR3JpZFhdO1xuICAgICAgICAgICAgb2JqLmluc3RhbmNlID0gc3RvbmU7XG4gICAgICAgICAgICBvYmouaXNXaGl0ZSA9IHNlbGYuaXNXaGl0ZTtcbiAgICAgICAgICAgIG9iai54ID0gbnRoR3JpZFg7XG4gICAgICAgICAgICBvYmoueSA9IG50aEdyaWRZO1xuXG4gICAgICAgICAgICAvLyDjgbLjgaPjgY/jgorov5TjgZnnn7PjgYzjgYLjgovloLTlkIjjga/jgbLjgaPjgY/jgorov5TjgZlcbiAgICAgICAgICAgIGlmIChzZWxmLnR1cm5TdG9uZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbGYudHVyblN0b25lcy5mb3JFYWNoKGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICB2YWwuaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgdmFsLmluc3RhbmNlLnJldmVyc2UoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNlbGYudHVyblN0b25lcy5sZW5ndGggPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyDjganjgaHjgonjga7nlarjgYvjga7ooajnpLrjgpLliIfjgormm7/jgYhcbiAgICAgICAgICAgIGlmICghc2VsZi5zdG9uZUNvbG9yVGV4dC5jbGFzc0xpc3QuY29udGFpbnMoc2VsZi50b2dnbGVUZXh0Q2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQudGV4dENvbnRlbnQgPSAn55m9JztcbiAgICAgICAgICAgICAgICBzZWxmLnN0b25lQ29sb3JUZXh0LmNsYXNzTGlzdC5hZGQoc2VsZi50b2dnbGVUZXh0Q2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zdG9uZUNvbG9yVGV4dC50ZXh0Q29udGVudCA9ICfpu5InO1xuICAgICAgICAgICAgICAgIHNlbGYuc3RvbmVDb2xvclRleHQuY2xhc3NMaXN0LnJlbW92ZShzZWxmLnRvZ2dsZVRleHRDbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOOCr+ODquODg+OCr+OBl+OBn+ODnuOCueOBjOepuuOBi+OBqeOBhuOBi+OCkuWIpOWumlxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gbnRoWCA6IOS9leeVquebruOBruODnuOCueOBi++8iDEtOO+8iVxuICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gbnRoWSA6IOS9leeVquebruOBruODnuOCueOBi++8iDEtOO+8iVxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgICAgICovXG4gICAgICAgIGNoZWNrVmFjYW5jeTogZnVuY3Rpb24obnRoWCwgbnRoWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzZWxmLmJvYXJkW250aFldW250aFhdKS5sZW5ndGggPD0gMDtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznn7PjgavjgajjgarjgorlkIjjgaPjgabjgYTjgovjgYvjganjgYbjgYvjgpLliKTlrppcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFggOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFkgOiDkvZXnlarnm67jga7jg57jgrnjgYvvvIgxLTjvvIlcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBjaGVja05laWdoYm9yOiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IHJvdywgbGluZTtcblxuICAgICAgICAgICAgbGV0IG5laWdoYm9ycyA9IFtcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSAtIDFdLCAgICAgICAvLyDkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgLSAxXSwgICAvLyDlj7PkuIpcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFldLCAgICAgICAvLyDlj7NcbiAgICAgICAgICAgICAgICBbbnRoWCArIDEsIG50aFkgKyAxXSwgICAvLyDlj7PkuItcbiAgICAgICAgICAgICAgICBbbnRoWCwgbnRoWSArIDFdLCAgICAgICAvLyDkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgKyAxXSwgICAvLyDlt6bkuItcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFldLCAgICAgICAvLyDlt6ZcbiAgICAgICAgICAgICAgICBbbnRoWCAtIDEsIG50aFkgLSAxXSAgICAvLyDlt6bkuIpcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBuZWlnaGJvcnMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIHJvdyA9IG5laWdoYm9yc1tpXVswXTtcbiAgICAgICAgICAgICAgICBsaW5lID0gbmVpZ2hib3JzW2ldWzFdO1xuXG4gICAgICAgICAgICAgICAgLy8g44Oc44O844OJ44GL44KJ44Gv44G/5Ye644GZ44Go44GN44Gv44K544Kt44OD44OXXG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IDAgfHwgcm93ID4gNyB8fCBsaW5lIDwgMCB8fCBsaW5lID4gNykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoc2VsZi5ib2FyZFtsaW5lXVtyb3ddKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgq/jg6rjg4Pjgq/jgZfjgZ/jg57jgrnjgYznn7PjgpLjgbLjgaPjgY/jgorov5TjgZvjgovjg57jgrnjgYvjganjgYbjgYvjgpLliKTlrppcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFhcbiAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG50aFlcbiAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICAgICAqL1xuICAgICAgICBjaGVja0lmUG9zc2libGU6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBUT0RPIOiHquWIhueUqOODoeODou+8muOAgOS4ieinkumWouaVsOOCkuS9v+OBhuOBqOS7peS4i+WIpOWumuOBl+OChOOBmeOBneOBhuOBoOOBjCBNYXRoLmNvcyhNYXRoLlBJIC8gMinjgacx44Gr44Gq44KJ44Gq44GEXG4gICAgICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGkgKyAnIC8gNCcpO1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKE1hdGguY29zKE1hdGguUEkgLyA0ICogaSksIE1hdGguc2luKE1hdGguUEkgLyA0ICogaSkpO1xuICAgICAgICAgICAgLy8gfVxuXG5cbiAgICAgICAgICAgIGNvbnN0IE1BWF9DT1VOVCA9IChzZWxmLkxJTkVfTlVNQkVSIC0gMSkgLSAxOyAvLyAoKOe3muOBruaVsC0xKSAtIOiHqui6q+OBjOe9ruOBi+OCjOOCi+ODnuOCuSlcbiAgICAgICAgICAgIC8vIOS4gOaWueWQkeOBp+OCguefs+OBjOOBsuOBo+OBj+OCiui/lOOBm+OCjOOBsHRydWXjgavjgZnjgotcbiAgICAgICAgICAgIGxldCBpc1Bvc3NpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAvLyDlkITmlrnlkJHjgafnn7PjgpLjgbLjgaPjgY/jgorov5TjgZvjgovjgYvjgpLjg4Hjgqfjg4Pjgq/jgZnjgovjg5Xjg6njgrBcbiAgICAgICAgICAgIGxldCBpc1RtcFBvc3NpYmxlO1xuICAgICAgICAgICAgLy8g44OB44Kn44OD44Kv44GZ44KL55+z44Gu5oOF5aCx44KS5qC857SN77yI44Kv44Oq44OD44Kv44GX44Gf5L2N572u44GL44KJ6L+R44GE566H5omA44GL44KJ44OB44Kn44OD44Kv77yJXG4gICAgICAgICAgICBsZXQgb2JqID0gbnVsbDtcbiAgICAgICAgICAgIGxldCB0bXBPYmogPSBudWxsO1xuICAgICAgICAgICAgbGV0IHRtcFR1cm5TdG9uZXMgPSBbXTtcblxuICAgICAgICAgICAgbGV0IGRpclksIGRpclg7XG5cbiAgICAgICAgICAgIC8vIOe9ruOBkeOCi+adoeS7tlxuICAgICAgICAgICAgLy8g5bem5Y+z44CB5LiK5LiL44CB5pac44KBNDXluqbkuIrjgavlkIzjgZjoibLjga7nn7PjgYzjgYLjgotcbiAgICAgICAgICAgIC8vIOOBi+OBpCDjgZ3jga7lkIzjgZjoibLjga7nn7Pjgajoh6rouqvjga7plpPjgavpmpnplpPjgarjgY/liKXjga7oibLjga7nn7PjgYzjgYLjgotcblxuICAgICAgICAgICAgLy8g5LiK44CB5Y+z5LiK44CB5Y+z44CB5Y+z5LiL44CB5LiL44CB5bem5LiL44CB5bem44CB5bem5LiK44CB44Gn44Gd44KM44Ge44KM44OB44Kn44OD44Kv44GZ44KLXG4gICAgICAgICAgICAvLyB5LCB444Gu6aCG55WqXG4gICAgICAgICAgICBsZXQgY2hlY2tEaXJzID0gW1xuICAgICAgICAgICAgICAgIFstMSwgMF0sICAgIC8vIOS4ilxuICAgICAgICAgICAgICAgIFsxLCAwXSwgICAgIC8vIOS4i1xuICAgICAgICAgICAgICAgIFswLCAtMV0sICAgIC8vIOW3plxuICAgICAgICAgICAgICAgIFswLCAxXSwgICAgIC8vIOWPs1xuICAgICAgICAgICAgICAgIFstMSwgLTFdLCAgIC8vIOW3puS4ilxuICAgICAgICAgICAgICAgIFsxLCAxXSwgICAgIC8vIOWPs+S4i1xuICAgICAgICAgICAgICAgIFsxLCAtMV0sICAgIC8vIOW3puS4i1xuICAgICAgICAgICAgICAgIFstMSwgMV0sICAgIC8vIOWPs+S4ilxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiDlkITmlrnlkJHjgafjgbLjgaPjgY/jgorov5TjgZvjgovjgYvliKTlrppcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2soKSB7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMCwgbGVuID0gY2hlY2tEaXJzLmxlbmd0aDsgayA8IGxlbjsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzVG1wUG9zc2libGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBkaXJZID0gY2hlY2tEaXJzW2tdWzBdO1xuICAgICAgICAgICAgICAgICAgICBkaXJYID0gY2hlY2tEaXJzW2tdWzFdO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IE1BWF9DT1VOVDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOODnOODvOODieOBi+OCieOBr+OBv+WHuuOBmeWgtOWQiOOBr+WHpueQhuOCkuaKnOOBkeOCi1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChkaXJZIDwgMCkgJiYgKG50aFkgKyBkaXJZICogaSA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChkaXJZID4gMCkgJiYgKG50aFkgKyBkaXJZICogaSA+IE1BWF9DT1VOVCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGRpclggPCAwKSAmJiAobnRoWCArIGRpclggKiBpIDwgMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGRpclggPiAwKSAmJiAobnRoWCArIGRpclggKiBpID4gTUFYX0NPVU5UKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDoh6rouqvjgYvjgonoqbLlvZPmlrnlkJHjga7kuK3jgafkuIDnlarov5HjgYTnn7NcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IHNlbGYuYm9hcmRbbnRoWSArIGRpclkgKiBpXVtudGhYICsgZGlyWCAqIGldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDjg4Hjgqfjg4Pjgq/jgZnjgovmlrnlkJHjgavmg4XloLHjgYzjgYLjgorvvJ3nn7PjgYznva7jgYvjgozjgabjgYrjgorjgIHjgYvjgaTjgIHlkIzjgZjoibLjga7loLTlkIhcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPiAwKSAmJiAob2JqLmlzV2hpdGUgKiAtMSA9PT0gc2VsZi5pc1doaXRlKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g44Kv44Oq44OD44Kv44GX44Gf5L2N572u44GL44KJ44CB5LiK6KiY55+z44Gu5aC05omA44G+44Gn44Gu55+z44KS56K66KqNXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBpOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPIOiHquWIhueUqOODoeODou+8mnNlbGYuYm9hcmRbeV1beF3jgpJ0bXBPYmrjgavlj4LnhafmuKHjgZfjgZfjgabjgYTjgabjg4/jg57jgaPjgZ9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wT2JqID0gc2VsZi5ib2FyZFtudGhZICsgZGlyWSAqIGpdW250aFggKyBkaXJYICogal07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcE9iai55ID0gbnRoWSArIGRpclkgKiBqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBPYmoueCA9IG50aFggKyBkaXJYICogajtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModG1wT2JqKS5sZW5ndGggPiAwICYmIHRtcE9iai5pc1doaXRlID09PSBzZWxmLmlzV2hpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOODgeOCp+ODg+OCr+OBmeOCi+aWueWQkeOBq+aDheWgseOBjOOBguOCiu+8neefs+OBjOe9ruOBi+OCjOOBpuOBiuOCiuOAgeOBi+OBpOOAgemBleOBhuiJsuOBruWgtOWQiFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1RtcFBvc3NpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcFR1cm5TdG9uZXMucHVzaCh0bXBPYmopO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnn7PjgYzjgarjgYTjgYvlkIzjgZjoibLjga7loLTlkIjjga/lh6bnkIbjgpLmipzjgZHjgotcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNUbXBQb3NzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG1wVHVyblN0b25lcy5sZW5ndGggPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlh6bnkIbntYLkuobjga7loLTlkIjjga/jgqrjg5bjgrjjgqfjgq/jg4jjgavkuIDmmYLnmoTjgavmoLzntI3jgZfjgabjgYTjgZ/mg4XloLHjgpLliYrpmaTjgZnjgotcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0bXBPYmoueDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0bXBPYmoueTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDjgq/jg6rjg4Pjgq/jgZfjgZ/kvY3nva7jgajjg4Hjgqfjg4Pjgq/jgZnjgovmlrnlkJHjga7mnIDnn63jga7lkIzjgZjoibLjga7nn7Pjgb7jgafjga7plpPjgYzjgZnjgbnjgabpgZXjgYboibLjga7nn7Pjga7loLTlkIhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNUbXBQb3NzaWJsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSB0bXBUdXJuU3RvbmVzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnR1cm5TdG9uZXMucHVzaCh0bXBUdXJuU3RvbmVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bXBUdXJuU3RvbmVzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUG9zc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNoZWNrKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBpc1Bvc3NpYmxlO1xuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5Cb2FyZE1hbmFnZXIgPSBCb2FyZE1hbmFnZXI7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IFBsYXllciA9IGZ1bmN0aW9uKGNhbnZhcywgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmNhbnZhcyA9IGNhbnZhcztcblxuICAgICAgICBzZWxmLmNvbG9yID0gZGF0YS5jb2xvcjtcbiAgICAgICAgc2VsZi5zdG9uZXMgPSBbXTtcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgUGxheWVyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLnNldEV2ZW50KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGUub2Zmc2V0WCk7XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdldENsaWNrUG9zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlBsYXllciA9IFBsYXllcjtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgLyoqXG4gICAgICog44Gd44KM44Ge44KM44Gu55+z44Gu5oOF5aCxXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGN0eFxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIDog5L2N572u44Go6Imy44KS5L+d5oyBXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3QgU3RvbmUgPSBmdW5jdGlvbihjdHgsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG4gICAgICAgIHNlbGYuZGF0YSA9IGRhdGE7XG4gICAgICAgIHNlbGYuaXNXaGl0ZSA9IGRhdGEuaXNXaGl0ZTtcblxuICAgIH07XG5cbiAgICBTdG9uZS5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIOefs+OCkuaPj+WGmVxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZGF0YVxuICAgICAgICAgKi9cbiAgICAgICAgZHJhd0FyYzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgc2VsZi5jdHguYXJjKGRhdGEueCwgZGF0YS55LCBkYXRhLnIsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGxTdHlsZSA9IHNlbGYuaXNXaGl0ZSA+IDAgPyAnI2ZmZmZmZicgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5jbG9zZVBhdGgoKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiDjgbLjgaPjgY/jgorov5TjgZnlh6bnkIZcbiAgICAgICAgICovXG4gICAgICAgIHJldmVyc2U6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuaXNXaGl0ZSAqPSAtMTtcblxuICAgICAgICAgICAgc2VsZi5kcmF3QXJjKHNlbGYuZGF0YSk7XG5cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5TdG9uZSA9IFN0b25lO1xuXG59KCkpOyIsIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycpO1xuXG4gICAgICAgIGlmICghY2FudmFzLmdldENvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhc1dyYXBwZXInKTtcbiAgICAgICAgY3R4LmNhbnZhcy53aWR0aCA9IHdyYXBwZXIuY2xpZW50V2lkdGg7XG4gICAgICAgIGN0eC5jYW52YXMuaGVpZ2h0ID0gd3JhcHBlci5jbGllbnRIZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgYm9hcmQgPSBuZXcgbXlPdGhlbGxvLkJvYXJkTWFuYWdlcihjdHgpO1xuXG4gICAgICAgIC8vIOWIneacn+S9jee9ruOBq+efs+OCkuOCu+ODg+ODiFxuICAgICAgICBib2FyZC5zdGFydEdhbWUoKTtcblxuICAgICAgICAvLyDjgqTjg5njg7Pjg4jnmbvpjLJcbiAgICAgICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXG4gICAgICAgICAgICBib2FyZC5wdXRTdG9uZShlLm9mZnNldFgsIGUub2Zmc2V0WSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbn0oKSk7XG5cbi8qKlxuICogLy8gVE9ETyDos6rllY/jgZXjgZvjgabjgY/jgaDjgZXjgYTjgIJcblxuIDEuXG4g44CM5Yik5a6a44GZ44KL44CN44Go44GE44GG6Iux6Kqe44Gv5L2V44KS5L2/44Gj44Gm44G+44GZ44Gn44GX44KH44GG44GL77yfXG4gZmluZCwganVkZ2UsIGRlY2lkZSwgY2hlY2suLi4/XG5cbiAyLlxuIEJvYXJkTWFuYWdlcuOCr+ODqeOCueOBrlN0YXJ0R2FtZeODoeOCveODg+ODieOBrlRPRE/jga7lj4LnhafjgpLjgojjgo3jgZfjgY/jgYrpoZjjgYTjgYTjgZ/jgZfjgb7jgZnjgIJcblxuIDMuXG4gSmF2YVNjcmlwdOOBruabuOOBjeaWueOBrua1gea0vu+8iO+8n++8ieOBjOOBvuOBqOOBvuOBo+OBpuOBhOOCi+acrOOChOiomOS6i+OAgeOBguOCi+OBhOOBr+iqv+OBueOCi+mam+OBruOCreODvOODr+ODvOODieOCkuaVmeOBiOOBpuOBhOOBn+OBoOOBkeOBquOBhOOBp+OBl+OCh+OBhuOBi++8n1xuIOOAjOOAh+OAh+OCseODvOOCue+8iGV4LiDjgq3jg6Pjg6Hjg6vjgrHjg7zjgrnjgarjganvvInjgI3jga/ljZjoqp7jga7mm7jjgY3mlrnjgoTjgaTjgarjgY7mlrnjgIFcbiDjg4fjgrbjgqTjg7Pjg5Hjgr/jg7zjg7Pjga/jgq/jg6njgrnvvIjjgrPjg7Pjgrnjg4jjg6njgq/jgr/vvInjga7lvbnlibLjgoTmqZ/og73jga7liIbjgZHmlrnjgavjgaTjgYTjgabjga7mpoLlv7XjgajjgYTjgYboqo3orZjjgarjga7jgafjgZnjgYzjgIFcbiDjgZPjgZPjgafmhI/lkbPjgZnjgovmtYHmtL7jgajjga/jgIHlpInmlbDlkI3jgoTplqLmlbDlkI3jgpLkvZXjgrHjg7zjgrnjgavjgZnjgovjgYvjgoTjgIFjc3PjgafjgYTjgYZCRU3jgoRGTE9DU1Pjga7jgojjgYbjgarjgoLjga7jgafjgZnjgIJcbiDvvIjkvJ3jgo/jgaPjgabjgYTjgarjgYvjgaPjgZ/jgonjgZnjgb/jgb7jgZvjgpMuLi7jgILmnb7nlLDjgZXjgpPjgYzjg5fjg63jgrDjg6njg6DlhoXjgacnXyfjgYvjgonjga/jgZjjgb7jgovlpInmlbDlkI3jgpLkvb/jgo/jgozjgabjgYTjgZ/jgorjgIHku6XliY3ku5bjga7kurrjgYzmm7jjgYTjgZ/jg5fjg63jgrDjg6njg6DjgadqUXVlcnnjgpLkvb/jgaPjgabjgYTjgarjgYTjga7jgasnJCfjgYvjgonjga/jgZjjgb7jgovlpInmlbDlkI3jgpLkvb/jgaPjgabjgYTjgovjga7jgpLopovjgZ/jgZPjgajjgYzjgYLjgaPjgZ/jga7jgafjgIHmtYHmtL7jga7jgojjgYbjgarjgoLjga7jgYzjgYLjgovjga7jgYvjgajmsJfjgavjgarjgorjgb7jgZfjgZ/jgILvvIlcblxuXG4gKi9cbiJdfQ==