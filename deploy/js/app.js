!function(){const t=function(t){this.ctx=t,this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.color="#ffffff",this.isWhite=1,this.board=[],this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let o=1;o<t.LINE_NUMBER;o++){let o=[];for(let e=1;e<t.LINE_NUMBER;e++)o.push({});t.board.push(o)}},drawBoard:function(){const t=this,o=t.GRID_SIZE*(t.LINE_NUMBER-1);let e=0,i=0;t.drawRect(e,i,o,o,"#008833");for(let s=1;s<=t.LINE_NUMBER;s++)t.drawLine(e,0,e,o),e+=t.GRID_SIZE;for(let s=1;s<=t.LINE_NUMBER;s++)t.drawLine(0,i,o,i),i+=t.GRID_SIZE},drawRect:function(t,o,e,i,s){this.ctx.fillStyle=void 0!==s?s:"#000000",this.ctx.fillRect(t,o,e,i)},drawLine:function(t,o,e,i,s,n){this.ctx.strokeStyle=void 0!==s?s:"#000000",this.ctx.lineWidth=void 0!==n?n:1,this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,o=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),e=t.GRID_SIZE/2;let i,s,n=-1,c=-1,h=1,l={r:t.R};function r(r){for(let f=0;f<2;f++){i=o+n*e,s=o+c*e,l.x=i,l.y=s,l.color=r;let f=new window.myOthello.Stone(t.ctx,l);f.drawArc(l);let a=t.board[Math.floor(s/t.GRID_SIZE)][Math.floor(i/t.GRID_SIZE)];a.instance=f,a.isWhite=h,n*=-1,c*=-1}}r("#ffffff"),n*=-1,h*=-1,r("#000000"),console.log(t.board)},putStone:function(t,o){let e=Math.floor(t/this.GRID_SIZE),i=Math.floor(o/this.GRID_SIZE);if(this.checkVacancy(e,i)>0)return;if(!this.checkNeighbor(e,i))return;this.checkAvailability(e,i),this.isWhite*=-1,color=this.isWhite>0?"#ffffff":"#000000";let s={x:this.GRID_SIZE*e+this.GRID_SIZE/2,y:this.GRID_SIZE*i+this.GRID_SIZE/2,r:this.R,color:color},n=new window.myOthello.Stone(this.ctx,s);n.drawArc(s),this.stonePoses.push({instance:n,isWhite:this.isWhite,pos:[e,i]})},checkVacancy:function(t,o){return this.stonePoses.filter(function(e){return e.pos[0]===t&&e.pos[1]===o}).length},checkNeighbor:function(t,o){const e=this;let i=!1,s=[[t,o+1],[t+1,o+1],[t+1,o],[t+1,o-1],[t,o-1],[t-1,o-1],[t-1,o],[t-1,o+1]];for(let n=0,c=e.stonePoses.length;n<c;n++){for(let t=0,o=s.length;t<o;t++)if(e.stonePoses[n].pos[0]===s[t][0]&&e.stonePoses[n].pos[1]===s[t][1]){i=!0;break}if(i)break}return i},checkAvailability:function(t,o){const e=this,i=7;let s=0,n=!1;!function(){s=0;let c=!1;for(let s=0,h=e.stonePoses.length;s<h;s++){for(let h=0;h<i&&!(o-h<0);h++)if(e.stonePoses[s].pos[0]===t&&e.stonePoses[s].pos[1]===o-h&&e.stonePoses[s].isWhite===-1*e.isWhite){console.log(e.stonePoses[s]);for(let t=1;t<h;t++)if(e.stonePoses[s].pos[1]===o-t&&e.stonePoses[s].isWhite===e.isWhite){console.log(e.stonePoses[s]),c=!0,n=!0;break}}if(c)break}}()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,o){this.canvas=t,this.color=o.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,o){this.ctx=t,this.color=o.color};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const o=document.getElementById("wrapper"),e=t.getContext("2d");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJHUklEX1NJWkUiLCJMSU5FX05VTUJFUiIsIlIiLCJjb2xvciIsImlzV2hpdGUiLCJib2FyZCIsImluaXQiLCJwcm90b3R5cGUiLCJzZWxmIiwidHJhbnNsYXRlIiwiZHJhd0JvYXJkIiwiaSIsInJvdyIsImoiLCJwdXNoIiwiZmllbGRTaXplIiwieCIsInkiLCJkcmF3UmVjdCIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJzdGFydEdhbWUiLCJjZW50ZXIiLCJkaWZmIiwicG9zWCIsInBvc1kiLCJkaXIxIiwiZGlyMiIsImRhdGEiLCJyIiwic2V0Rmlyc3RTdG9uZSIsInN0b25lIiwid2luZG93IiwibXlPdGhlbGxvIiwiU3RvbmUiLCJkcmF3QXJjIiwib2JqIiwiTWF0aCIsImZsb29yIiwiaW5zdGFuY2UiLCJjb25zb2xlIiwibG9nIiwicHV0U3RvbmUiLCJjbGlja2VkWCIsImNsaWNrZWRZIiwibnRoR3JpZFgiLCJudGhHcmlkWSIsImNoZWNrVmFjYW5jeSIsImNoZWNrTmVpZ2hib3IiLCJjaGVja0F2YWlsYWJpbGl0eSIsInN0b25lUG9zZXMiLCJwb3MiLCJudGhYIiwibnRoWSIsImZpbHRlciIsInZhbCIsImxlbmd0aCIsImhhc05laWdoYm9yIiwibmVpZ2hib3JzIiwibGVuIiwiTUFYX0NPVU5UIiwiY291bnQiLCJpc0F2YWlsYWJsZSIsInRtcEZsYWciLCJrIiwiY2hlY2tUb3AiLCJQbGF5ZXIiLCJjYW52YXMiLCJzdG9uZXMiLCJzZXRFdmVudCIsImdldENsaWNrUG9zIiwiYXJjIiwiUEkiLCJmaWxsIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0Iiwid3JhcHBlciIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZSIsIm9mZnNldFgiLCJvZmZzZXRZIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUVBLE1BQUFBLEVBQUEsU0FBQUMsR0FDQUMsS0FFQUQsSUFBQUEsRUFGQUMsS0FJQUMsVUFBQSxHQUpBRCxLQUtBRSxZQUFBLEVBTEFGLEtBTUFHLEVBQUEsR0FOQUgsS0FNQUMsVUFOQUQsS0FRQUksTUFBQSxVQVJBSixLQVNBSyxRQUFBLEVBVEFMLEtBV0FNLFNBWEFOLEtBYUFPLFFBR0FULEVBQUFVLFdBS0FELEtBQUEsV0FDQSxNQUFBRSxFQUFBVCxLQUdBUyxFQUFBVixJQUFBVyxVQUFBLEVBQUEsR0FFQUQsRUFBQUUsWUFFQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUgsRUFBQVAsWUFBQVUsSUFBQSxDQUNBLElBQUFDLEtBRUEsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEVBQUFMLEVBQUFQLFlBQUFZLElBQ0FELEVBQUFFLFNBR0FOLEVBQUFILE1BQUFTLEtBQUFGLEtBS0FGLFVBQUEsV0FDQSxNQUFBRixFQUFBVCxLQUVBZ0IsRUFBQVAsRUFBQVIsV0FBQVEsRUFBQVAsWUFBQSxHQUVBLElBQUFlLEVBQUEsRUFDQUMsRUFBQSxFQUVBVCxFQUFBVSxTQUFBRixFQUFBQyxFQUFBRixFQUFBQSxFQUFBLFdBRUEsSUFBQSxJQUFBSixFQUFBLEVBQUFBLEdBQUFILEVBQUFQLFlBQUFVLElBQ0FILEVBQUFXLFNBQUFILEVBQUEsRUFBQUEsRUFBQUQsR0FDQUMsR0FBQVIsRUFBQVIsVUFFQSxJQUFBLElBQUFXLEVBQUEsRUFBQUEsR0FBQUgsRUFBQVAsWUFBQVUsSUFDQUgsRUFBQVcsU0FBQSxFQUFBRixFQUFBRixFQUFBRSxHQUNBQSxHQUFBVCxFQUFBUixXQUtBa0IsU0FBQSxTQUFBRSxFQUFBQyxF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QUFBa0YsT0FBQXRELE1BQUFpRSxFQUFBQyxZQUNBOUYsRUFBQWtGLE9BQUFhLE9BQUFGLEVBQUFHLGFBaUJBLE1BQUF6RixFQUFBLElBQUF5QyxVQUFBakQsYUFBQUMsR0FFQU8sRUFBQTZCLFlBRUE4QyxFQUFBUSxpQkFBQSxRQUFBLFNBQUFPLEdBRUExRixFQUFBa0QsU0FBQXdDLEVBQUFDLFFBQUFELEVBQUFFIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIjsoZnVuY3Rpb24oKSB7XG5cbiAgICBjb25zdCBCb2FyZE1hbmFnZXIgPSBmdW5jdGlvbihjdHgpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG5cbiAgICAgICAgc2VsZi5HUklEX1NJWkUgPSA1MDtcbiAgICAgICAgc2VsZi5MSU5FX05VTUJFUiA9IDk7XG4gICAgICAgIHNlbGYuUiA9IHNlbGYuR1JJRF9TSVpFICogMC4zO1xuXG4gICAgICAgIHNlbGYuY29sb3IgPSAnI2ZmZmZmZic7XG4gICAgICAgIHNlbGYuaXNXaGl0ZSA9IDE7XG5cbiAgICAgICAgc2VsZi5ib2FyZCA9IFtdO1xuXG4gICAgICAgIHNlbGYuaW5pdCgpO1xuICAgIH07XG5cbiAgICBCb2FyZE1hbmFnZXIucHJvdG90eXBlID0ge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKlxuICAgICAgICAgKi9cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgLy8geD0wLCB5PTDjgaflhYjjga7lpKrjgZXjgYzljYrliIbjgZfmj4/lhpnjgZXjgozjgarjgYTjgZ/jgoHjgIHln7rmupbngrnjgpLjgZrjgonjgZlcbiAgICAgICAgICAgIHNlbGYuY3R4LnRyYW5zbGF0ZSgxLCAxKTtcblxuICAgICAgICAgICAgc2VsZi5kcmF3Qm9hcmQoKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzZWxmLkxJTkVfTlVNQkVSOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgcm93ID0gW107XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMTsgaiA8IHNlbGYuTElORV9OVU1CRVI7IGorKykge1xuICAgICAgICAgICAgICAgICAgICByb3cucHVzaCh7fSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5ib2FyZC5wdXNoKHJvdyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3Qm9hcmQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGNvbnN0IGZpZWxkU2l6ZSA9IHNlbGYuR1JJRF9TSVpFICogKHNlbGYuTElORV9OVU1CRVIgLSAxKTtcblxuICAgICAgICAgICAgbGV0IHggPSAwO1xuICAgICAgICAgICAgbGV0IHkgPSAwO1xuXG4gICAgICAgICAgICBzZWxmLmRyYXdSZWN0KHgsIHksIGZpZWxkU2l6ZSwgZmllbGRTaXplLCAnIzAwODgzMycpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzZWxmLkxJTkVfTlVNQkVSOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRyYXdMaW5lKHgsIDAsIHgsIGZpZWxkU2l6ZSk7XG4gICAgICAgICAgICAgICAgeCArPSBzZWxmLkdSSURfU0laRTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHNlbGYuTElORV9OVU1CRVI7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlbGYuZHJhd0xpbmUoMCwgeSwgZmllbGRTaXplLCB5KTtcbiAgICAgICAgICAgICAgICB5ICs9IHNlbGYuR1JJRF9TSVpFO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd1JlY3Q6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBjb2xvcikge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGxTdHlsZSA9IHR5cGVvZiBjb2xvciAhPT0gJ3VuZGVmaW5lZCcgPyBjb2xvciA6ICcjMDAwMDAwJztcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGxSZWN0KHgxLCB5MSwgeDIsIHkyKTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdMaW5lOiBmdW5jdGlvbih4MSwgeTEsIHgyLCB5MiwgY29sb3IsIHdpZHRoKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguc3Ryb2tlU3R5bGUgPSB0eXBlb2YgY29sb3IgIT09ICd1bmRlZmluZWQnID8gY29sb3IgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5saW5lV2lkdGggPSB0eXBlb2Ygd2lkdGggIT09ICd1bmRlZmluZWQnID8gd2lkdGggOiAxO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIHNlbGYuY3R4Lm1vdmVUbyh4MSwgeTEpO1xuICAgICAgICAgICAgc2VsZi5jdHgubGluZVRvKHgyLCB5Mik7XG4gICAgICAgICAgICBzZWxmLmN0eC5jbG9zZVBhdGgoKTtcblxuICAgICAgICAgICAgc2VsZi5jdHguc3Ryb2tlKCk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzdGFydEdhbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGNvbnN0IGNlbnRlciA9IHNlbGYuR1JJRF9TSVpFICogKChzZWxmLkxJTkVfTlVNQkVSIC0gMSkgLyAyKTtcbiAgICAgICAgICAgIGNvbnN0IGRpZmYgPSAoc2VsZi5HUklEX1NJWkUgLyAyKTtcbiAgICAgICAgICAgIGxldCBkaXIxID0gLTE7XG4gICAgICAgICAgICBsZXQgZGlyMiA9IC0xO1xuICAgICAgICAgICAgbGV0IHBvc1gsIHBvc1k7XG4gICAgICAgICAgICBsZXQgaXNXaGl0ZSA9IDE7XG4gICAgICAgICAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICByOiBzZWxmLlJcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHNldEZpcnN0U3RvbmUoJyNmZmZmZmYnKTtcbiAgICAgICAgICAgIGRpcjEgKj0gLTE7XG4gICAgICAgICAgICBpc1doaXRlICo9IC0xO1xuICAgICAgICAgICAgc2V0Rmlyc3RTdG9uZSgnIzAwMDAwMCcpO1xuXG4gICAgICAgICAgICBmdW5jdGlvbiBzZXRGaXJzdFN0b25lKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcG9zWCA9IGNlbnRlciArIGRpcjEgKiBkaWZmO1xuICAgICAgICAgICAgICAgICAgICBwb3NZID0gY2VudGVyICsgZGlyMiAqIGRpZmY7XG5cbiAgICAgICAgICAgICAgICAgICAgZGF0YS54ID0gcG9zWDtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS55ID0gcG9zWTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5jb2xvciA9IGNvbG9yO1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdG9uZSA9IG5ldyB3aW5kb3cubXlPdGhlbGxvLlN0b25lKHNlbGYuY3R4LCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgb2JqID0gc2VsZi5ib2FyZFtNYXRoLmZsb29yKHBvc1kgLyBzZWxmLkdSSURfU0laRSldW01hdGguZmxvb3IocG9zWCAvIHNlbGYuR1JJRF9TSVpFKV07XG4gICAgICAgICAgICAgICAgICAgIG9iai5pbnN0YW5jZSA9IHN0b25lO1xuICAgICAgICAgICAgICAgICAgICBvYmouaXNXaGl0ZSA9IGlzV2hpdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgZGlyMSAqPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgZGlyMiAqPSAtMTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5ib2FyZCk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBwdXRTdG9uZTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IG50aEdyaWRYID0gTWF0aC5mbG9vcihjbGlja2VkWCAvIHNlbGYuR1JJRF9TSVpFKTtcbiAgICAgICAgICAgIGxldCBudGhHcmlkWSA9IE1hdGguZmxvb3IoY2xpY2tlZFkgLyBzZWxmLkdSSURfU0laRSk7XG5cbiAgICAgICAgICAgIGlmIChzZWxmLmNoZWNrVmFjYW5jeShudGhHcmlkWCwgbnRoR3JpZFkpID4gMCkge1xuICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFzZWxmLmNoZWNrTmVpZ2hib3IobnRoR3JpZFgsIG50aEdyaWRZKSkge1xuICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFzZWxmLmNoZWNrQXZhaWxhYmlsaXR5KG50aEdyaWRYLCBudGhHcmlkWSkpIHtcbiAgICAgICAgICAgICAgIC8vIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc2VsZi5pc1doaXRlICo9IC0xO1xuICAgICAgICAgICAgY29sb3IgPSBzZWxmLmlzV2hpdGUgPiAwID8gJyNmZmZmZmYnIDogJyMwMDAwMDAnO1xuXG4gICAgICAgICAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICB4OiAoc2VsZi5HUklEX1NJWkUgKiBudGhHcmlkWCkgKyAoc2VsZi5HUklEX1NJWkUgLyAyKSxcbiAgICAgICAgICAgICAgICB5OiAoc2VsZi5HUklEX1NJWkUgKiBudGhHcmlkWSkgKyAoc2VsZi5HUklEX1NJWkUgLyAyKSxcbiAgICAgICAgICAgICAgICByOiBzZWxmLlIsXG4gICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBsZXQgc3RvbmUgPSBuZXcgd2luZG93Lm15T3RoZWxsby5TdG9uZShzZWxmLmN0eCwgZGF0YSk7XG4gICAgICAgICAgICBzdG9uZS5kcmF3QXJjKGRhdGEpO1xuXG4gICAgICAgICAgICBzZWxmLnN0b25lUG9zZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2U6IHN0b25lLFxuICAgICAgICAgICAgICAgIGlzV2hpdGU6IHNlbGYuaXNXaGl0ZSxcbiAgICAgICAgICAgICAgICBwb3M6IFtudGhHcmlkWCwgbnRoR3JpZFldXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNoZWNrVmFjYW5jeTogZnVuY3Rpb24obnRoWCwgbnRoWSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZWxmLnN0b25lUG9zZXMuZmlsdGVyKGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWwucG9zWzBdID09PSBudGhYICYmIHZhbC5wb3NbMV0gPT09IG50aFk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC5sZW5ndGg7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjaGVja05laWdoYm9yOiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IGhhc05laWdoYm9yID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxldCBuZWlnaGJvcnMgPSBbXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgKyAxXSwgICAgICAgLy8g5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZICsgMV0sICAgLy8g5Y+z5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZXSwgICAgICAgLy8g5Y+zXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZIC0gMV0sICAgLy8g5Y+z5LiLXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgLSAxXSwgICAgICAgLy8g5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZIC0gMV0sICAgLy8g5bem5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZXSwgICAgICAgLy8g5bemXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZICsgMV0gICAgLy8g5bem5LiKXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gc2VsZi5zdG9uZVBvc2VzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGxlbiA9IG5laWdoYm9ycy5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1swXSA9PT0gbmVpZ2hib3JzW2pdWzBdICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMV0gPT09IG5laWdoYm9yc1tqXVsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmVpZ2hib3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhhc05laWdoYm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGhhc05laWdoYm9yO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoZWNrQXZhaWxhYmlsaXR5OiBmdW5jdGlvbihjbGlja2VkWCwgY2xpY2tlZFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBNQVhfQ09VTlQgPSA3O1xuICAgICAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgICAgIGxldCB0bXBGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgaXNBdmFpbGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8g572u44GR44KL5p2h5Lu2XG4gICAgICAgICAgICAvLyDlt6blj7PjgIHkuIrkuIvjgIHmlpzjgoE0NeW6puS4iuOBq+WQjOOBmOiJsuOBruefs+OBjOOBguOCiyDjgYvjgaQg44Gd44Gu5ZCM44GY6Imy44Gu55+z44Go6Ieq6Lqr44Gu6ZaT44Gr6ZqZ6ZaT44Gq44GP5Yil44Gu6Imy44Gu55+z44GM44GC44KLXG5cbiAgICAgICAgICAgIC8vIOS4iiAgICBbbnRoWCwgbnRoWSArIDFdLFxuICAgICAgICAgICAgLy8g5Y+z5LiKICAgW250aFggKyAxLCBudGhZICsgMV0sXG4gICAgICAgICAgICAvLyDlj7MgICAgW250aFggKyAxLCBudGhZXSxcbiAgICAgICAgICAgIC8vIOWPs+S4iyAgIFtudGhYICsgMSwgbnRoWSAtIDFdLFxuICAgICAgICAgICAgLy8g5LiLICAgIFtudGhYLCBudGhZIC0gMV0sXG4gICAgICAgICAgICAvLyDlt6bkuIsgICBbbnRoWCAtIDEsIG50aFkgLSAxXSxcbiAgICAgICAgICAgIC8vIOW3piAgICBbbnRoWCAtIDEsIG50aFldLFxuICAgICAgICAgICAgLy8g5bem5LiKICAgW250aFggLSAxLCBudGhZICsgMV1cbiAgICAgICAgICAgIC8vIOOBp+OBneOCjOOBnuOCjOODgeOCp+ODg+OCr+OBmeOCi++8n1xuXG4gICAgICAgICAgICBjaGVja1RvcCgpO1xuXG4gICAgICAgICAgICAvLyDkuIrjg4Hjgqfjg4Pjgq9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrVG9wKCkge1xuXG4gICAgICAgICAgICAgICAgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgIGxldCB0bXBGbGFnID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gc2VsZi5zdG9uZVBvc2VzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgTUFYX0NPVU5UOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWNrZWRZIC0gaiA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Ieq6Lqr44Go5ZCM5YiX44GL44Gk5ZCM6KGM44Gr55+z44GM44GC44KK44CB44GL44Gk5ZCM44GY6Imy44Gu5aC05ZCI77yI6Ieq6Lqr44Gr6L+R44GE5L2N572u44GL44KJ5Yik5a6a77yJXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1swXSA9PT0gY2xpY2tlZFggJiYgc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1sxXSA9PT0gY2xpY2tlZFkgLSBqICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5pc1doaXRlID09PSBzZWxmLmlzV2hpdGUgKiAtMSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzW2ldKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiHqui6q+OBqOWQjOWIl+OBi+OBpOWQjOihjOOBq+OBguOCi+WQjOOBmOiJsuOBruefs+OBi+OCieOAgeOBi+OBpOWQjOOBmOiJsuOBruWgtOWQiO+8iOiHqui6q+OBq+i/keOBhOS9jee9ruOBi+OCieWIpOWumu+8iVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAxOyBrIDwgajsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzFdID09PSBjbGlja2VkWSAtIGsgJiYgc2VsZi5zdG9uZVBvc2VzW2ldLmlzV2hpdGUgPT09IHNlbGYuaXNXaGl0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNlbGYuc3RvbmVQb3Nlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG1wRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXNBdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRtcEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH1cblxuXG5cblxuXG5cblxuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5Cb2FyZE1hbmFnZXIgPSBCb2FyZE1hbmFnZXI7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IFBsYXllciA9IGZ1bmN0aW9uKGNhbnZhcywgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmNhbnZhcyA9IGNhbnZhcztcblxuICAgICAgICBzZWxmLmNvbG9yID0gZGF0YS5jb2xvcjtcbiAgICAgICAgc2VsZi5zdG9uZXMgPSBbXTtcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgUGxheWVyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLnNldEV2ZW50KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGUub2Zmc2V0WCk7XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdldENsaWNrUG9zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlBsYXllciA9IFBsYXllcjtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgY29uc3QgU3RvbmUgPSBmdW5jdGlvbihjdHgsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG4gICAgICAgIHNlbGYuY29sb3IgPSBkYXRhLmNvbG9yO1xuXG4gICAgfTtcblxuICAgIFN0b25lLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBkcmF3QXJjOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5hcmMoZGF0YS54LCBkYXRhLnksIGRhdGEuciwgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gZGF0YS5jb2xvcjtcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGwoKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlN0b25lID0gU3RvbmU7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5cbiAgICAgICAgaWYgKCFjYW52YXMuZ2V0Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmFwcGVyJyk7XG4gICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBjdHguY2FudmFzLndpZHRoID0gd3JhcHBlci5jbGllbnRXaWR0aDtcbiAgICAgICAgY3R4LmNhbnZhcy5oZWlnaHQgPSB3cmFwcGVyLmNsaWVudEhlaWdodDtcblxuICAgICAgICBsZXQgcGxheWVyRGF0YSA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnd2hpdGUnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IGJvYXJkID0gbmV3IG15T3RoZWxsby5Cb2FyZE1hbmFnZXIoY3R4KTtcblxuICAgICAgICBib2FyZC5zdGFydEdhbWUoKTtcblxuICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgICAgIGJvYXJkLnB1dFN0b25lKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyDjg5XjgqPjg7zjg6vjg4njgpLmm7jjgY/vvIg4eDjvvIlcbiAgICAgICAgLy8g5ZCE44Oe44K555uu44Gu44Ko44Oq44Ki5oOF5aCx44KS5L+d5oyB77yIc3RhcnRYLCBzdGFydFksIGVuZFgsIGVuZFnvvIlcbiAgICAgICAgLy8gICAgICDjgq/jg6rjg4Pjgq/jgZfjgZ/kvY3nva7jgahjYW52YXPkuIrjga7kvY3nva7jga7lpInmj5vjgYzlv4XopoHvvJ9cbiAgICAgICAgLy8g44OX44Os44Kk44Ok44O855m944O76buS44KS44K744OD44OIXG4gICAgICAgIC8vICAgICAg44OV44Op44Kw44Gr44GZ44KL77yfXG4gICAgICAgIC8vIOS4reWkruOBq+eZvem7kjLjgZPjgZrjgaTjgrvjg4Pjg4hcblxuICAgICAgICAvLyDlkITjg5fjg6zjgqTjg6Tjg7zjga7nva7jgYTjgZ/nn7PjgpLkv53mjIHjgZnjgovphY3liJdcbiAgICAgICAgLy9cblxuXG5cbiAgICB9KTtcblxufSgpKTtcblxuLyoqXG4gKiAvLyBUT0RPIOizquWVj1xuICpcbiAqIDEuXG4g44CM5Yik5a6a44GZ44KL44CN44Go44GE44GG6Iux6Kqe44Gv5L2V44KS5L2/44Gj44Gm44G+44GZ44GL77yfXG5cbiBmaW5kPyBqdWRnZT8gZGVjaWRlP1xuXG5cbiAyLlxuIGNocm9tZeOBrmRlduODhOODvOODq+OBp+OCpOODs+OCueOCv+ODs+OCueOBq+WFpeOBo+OBpuOBhOOCi3Tjgajjga/jgarjgpPjga7mhI/lkbPjgIHnlaXvvIjvvJ/vvInjgafjgZnjgYvvvJ/jgqTjg7Pjgrnjgr/jg7PjgrnjgpLjg63jgrDjgavlh7rjgZnjgah044Go44Gq44KL77yfXG4gYm9hcmQuc3RhcnRHYW1l44Gu5pyA5b6M44GnY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzKTvjgZnjgovjgajnorroqo3jgafjgY3jgotcblxuICovXG4iXX0=