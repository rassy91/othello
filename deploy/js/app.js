!function(){const t=function(t){this.ctx=t,this.GRID_SIZE=50,this.LINE_NUMBER=9,this.R=.3*this.GRID_SIZE,this.color="#ffffff",this.isWhite=1,this.board=[],this.init()};t.prototype={init:function(){const t=this;t.ctx.translate(1,1),t.drawBoard();for(let o=1;o<t.LINE_NUMBER;o++){let o=[];for(let e=1;e<t.LINE_NUMBER;e++)o.push({});t.board.push(o)}},drawBoard:function(){const t=this,o=t.GRID_SIZE*(t.LINE_NUMBER-1);let e=0,i=0;t.drawRect(e,i,o,o,"#008833");for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(e,0,e,o),e+=t.GRID_SIZE;for(let n=1;n<=t.LINE_NUMBER;n++)t.drawLine(0,i,o,i),i+=t.GRID_SIZE},drawRect:function(t,o,e,i,n){this.ctx.fillStyle=void 0!==n?n:"#000000",this.ctx.fillRect(t,o,e,i)},drawLine:function(t,o,e,i,n,s){this.ctx.strokeStyle=void 0!==n?n:"#000000",this.ctx.lineWidth=void 0!==s?s:1,this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(e,i),this.ctx.closePath(),this.ctx.stroke()},startGame:function(){const t=this,o=t.GRID_SIZE*((t.LINE_NUMBER-1)/2),e=t.GRID_SIZE/2;let i,n,s=-1,c=-1,h=1,l={r:t.R};function r(r){for(let f=0;f<2;f++){i=o+s*e,n=o+c*e,l.x=i,l.y=n,l.color=r;let f=new window.myOthello.Stone(t.ctx,l);f.drawArc(l);let a=t.board[Math.floor(n/t.GRID_SIZE)][Math.floor(i/t.GRID_SIZE)];a.instance=f,a.isWhite=h,s*=-1,c*=-1}}r("#ffffff"),s*=-1,h*=-1,r("#000000")},putStone:function(t,o){let e=Math.floor(t/this.GRID_SIZE),i=Math.floor(o/this.GRID_SIZE);if(!this.checkVacancy(e,i))return;this.isWhite*=-1,color=this.isWhite>0?"#ffffff":"#000000";let n={x:this.GRID_SIZE*e+this.GRID_SIZE/2,y:this.GRID_SIZE*i+this.GRID_SIZE/2,r:this.R,color:color},s=new window.myOthello.Stone(this.ctx,n);s.drawArc(n);let c=this.board[i][e];c.instance=s,c.isWhite=this.isWhite},checkVacancy:function(t,o){return Object.keys(this.board[o][t]).length<=0},checkNeighbor:function(t,o){const e=this;let i=!1,n=[[t,o+1],[t+1,o+1],[t+1,o],[t+1,o-1],[t,o-1],[t-1,o-1],[t-1,o],[t-1,o+1]];for(let s=0,c=e.stonePoses.length;s<c;s++){for(let t=0,o=n.length;t<o;t++)if(e.stonePoses[s].pos[0]===n[t][0]&&e.stonePoses[s].pos[1]===n[t][1]){i=!0;break}if(i)break}return i},checkAvailability:function(t,o){const e=this,i=7;let n=0,s=!1;!function(){n=0;let c=!1;for(let n=0,h=e.stonePoses.length;n<h;n++){for(let h=0;h<i&&!(o-h<0);h++)if(e.stonePoses[n].pos[0]===t&&e.stonePoses[n].pos[1]===o-h&&e.stonePoses[n].isWhite===-1*e.isWhite){console.log(e.stonePoses[n]);for(let t=1;t<h;t++)if(e.stonePoses[n].pos[1]===o-t&&e.stonePoses[n].isWhite===e.isWhite){console.log(e.stonePoses[n]),c=!0,s=!0;break}}if(c)break}}()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.BoardManager=t}(),function(){const t=function(t,o){this.canvas=t,this.color=o.color,this.stones=[],this.init()};t.prototype={init:function(){this.setEvent()},setEvent:function(){},getClickPos:function(){}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Player=t}(),function(){const t=function(t,o){this.ctx=t,this.color=o.color};t.prototype={drawArc:function(t){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!0),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath()}},void 0===window.myOthello&&(window.myOthello={}),window.myOthello.Stone=t}(),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("canvas");if(!t.getContext)return;const o=document.getElementById("wrapper"),e=t.getContext("2d");e.canvas.width=o.clientWidth,e.canvas.height=o.clientHeight;const i=new myOthello.BoardManager(e);i.startGame(),t.addEventListener("click",function(t){i.putStone(t.offsetX,t.offsetY)})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJvYXJkTWFuYWdlci5qcyIsIlBsYXllci5qcyIsIlN0b25lLmpzIiwic2NyaXB0LmpzIl0sIm5hbWVzIjpbIkJvYXJkTWFuYWdlciIsImN0eCIsInRoaXMiLCJHUklEX1NJWkUiLCJMSU5FX05VTUJFUiIsIlIiLCJjb2xvciIsImlzV2hpdGUiLCJib2FyZCIsImluaXQiLCJwcm90b3R5cGUiLCJzZWxmIiwidHJhbnNsYXRlIiwiZHJhd0JvYXJkIiwiaSIsInJvdyIsImoiLCJwdXNoIiwiZmllbGRTaXplIiwieCIsInkiLCJkcmF3UmVjdCIsImRyYXdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndpZHRoIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJzdGFydEdhbWUiLCJjZW50ZXIiLCJkaWZmIiwicG9zWCIsInBvc1kiLCJkaXIxIiwiZGlyMiIsImRhdGEiLCJyIiwic2V0Rmlyc3RTdG9uZSIsInN0b25lIiwid2luZG93IiwibXlPdGhlbGxvIiwiU3RvbmUiLCJkcmF3QXJjIiwib2JqIiwiTWF0aCIsImZsb29yIiwiaW5zdGFuY2UiLCJwdXRTdG9uZSIsImNsaWNrZWRYIiwiY2xpY2tlZFkiLCJudGhHcmlkWCIsIm50aEdyaWRZIiwiY2hlY2tWYWNhbmN5IiwibnRoWCIsIm50aFkiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiY2hlY2tOZWlnaGJvciIsImhhc05laWdoYm9yIiwibmVpZ2hib3JzIiwic3RvbmVQb3NlcyIsImxlbiIsInBvcyIsImNoZWNrQXZhaWxhYmlsaXR5IiwiTUFYX0NPVU5UIiwiY291bnQiLCJpc0F2YWlsYWJsZSIsInRtcEZsYWciLCJjb25zb2xlIiwibG9nIiwiayIsImNoZWNrVG9wIiwiUGxheWVyIiwiY2FudmFzIiwic3RvbmVzIiwic2V0RXZlbnQiLCJnZXRDbGlja1BvcyIsImFyYyIsIlBJIiwiZmlsbCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsIndyYXBwZXIiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsImUiLCJvZmZzZXRYIiwib2Zmc2V0WSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FFQSxNQUFBQSxFQUFBLFNBQUFDLEdBQ0FDLEtBRUFELElBQUFBLEVBRkFDLEtBSUFDLFVBQUEsR0FKQUQsS0FLQUUsWUFBQSxFQUxBRixLQU1BRyxFQUFBLEdBTkFILEtBTUFDLFVBTkFELEtBUUFJLE1BQUEsVUFSQUosS0FTQUssUUFBQSxFQVRBTCxLQVdBTSxTQVhBTixLQWFBTyxRQUdBVCxFQUFBVSxXQUtBRCxLQUFBLFdBQ0EsTUFBQUUsRUFBQVQsS0FHQVMsRUFBQVYsSUFBQVcsVUFBQSxFQUFBLEdBRUFELEVBQUFFLFlBRUEsSUFBQSxJQUFBQyxFQUFBLEVBQUFBLEVBQUFILEVBQUFQLFlBQUFVLElBQUEsQ0FDQSxJQUFBQyxLQUVBLElBQUEsSUFBQUMsRUFBQSxFQUFBQSxFQUFBTCxFQUFBUCxZQUFBWSxJQUNBRCxFQUFBRSxTQUdBTixFQUFBSCxNQUFBUyxLQUFBRixLQUtBRixVQUFBLFdBQ0EsTUFBQUYsRUFBQVQsS0FFQWdCLEVBQUFQLEVBQUFSLFdBQUFRLEVBQUFQLFlBQUEsR0FFQSxJQUFBZSxFQUFBLEVBQ0FDLEVBQUEsRUFFQVQsRUFBQVUsU0FBQUYsRUFBQUMsRUFBQUYsRUFBQUEsRUFBQSxXQUVBLElBQUEsSUFBQUosRUFBQSxFQUFBQSxHQUFBSCxFQUFBUCxZQUFBVSxJQUNBSCxFQUFBVyxTQUFBSCxFQUFBLEVBQUFBLEVBQUFELEdBQ0FDLEdBQUFSLEVBQUFSLFVBRUEsSUFBQSxJQUFBVyxFQUFBLEVBQUFBLEdBQUFILEVBQUFQLFlBQUFVLElBQ0FILEVBQUFXLFNBQUEsRUFBQUYsRUFBQUYsRUFBQUUsR0FDQUEsR0FBQVQsRUFBQVIsV0FLQWtCLFNBQUEsU0FBQUUsRUFBQUMs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aUJBQUEsUUFBQSxTQUFBTyxHQUVBMUYsRUFBQWdELFNBQUEwQyxFQUFBQyxRQUFBRCxFQUFBRSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyI7KGZ1bmN0aW9uKCkge1xuXG4gICAgY29uc3QgQm9hcmRNYW5hZ2VyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHNlbGYuY3R4ID0gY3R4O1xuXG4gICAgICAgIHNlbGYuR1JJRF9TSVpFID0gNTA7XG4gICAgICAgIHNlbGYuTElORV9OVU1CRVIgPSA5O1xuICAgICAgICBzZWxmLlIgPSBzZWxmLkdSSURfU0laRSAqIDAuMztcblxuICAgICAgICBzZWxmLmNvbG9yID0gJyNmZmZmZmYnO1xuICAgICAgICBzZWxmLmlzV2hpdGUgPSAxO1xuXG4gICAgICAgIHNlbGYuYm9hcmQgPSBbXTtcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgQm9hcmRNYW5hZ2VyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICpcbiAgICAgICAgICovXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHg9MCwgeT0w44Gn5YWI44Gu5aSq44GV44GM5Y2K5YiG44GX5o+P5YaZ44GV44KM44Gq44GE44Gf44KB44CB5Z+65rqW54K544KS44Ga44KJ44GZXG4gICAgICAgICAgICBzZWxmLmN0eC50cmFuc2xhdGUoMSwgMSk7XG5cbiAgICAgICAgICAgIHNlbGYuZHJhd0JvYXJkKCk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHJvdyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBzZWxmLkxJTkVfTlVNQkVSOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcm93LnB1c2goe30pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNlbGYuYm9hcmQucHVzaChyb3cpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZHJhd0JvYXJkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBmaWVsZFNpemUgPSBzZWxmLkdSSURfU0laRSAqIChzZWxmLkxJTkVfTlVNQkVSIC0gMSk7XG5cbiAgICAgICAgICAgIGxldCB4ID0gMDtcbiAgICAgICAgICAgIGxldCB5ID0gMDtcblxuICAgICAgICAgICAgc2VsZi5kcmF3UmVjdCh4LCB5LCBmaWVsZFNpemUsIGZpZWxkU2l6ZSwgJyMwMDg4MzMnKTtcblxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gc2VsZi5MSU5FX05VTUJFUjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5kcmF3TGluZSh4LCAwLCB4LCBmaWVsZFNpemUpO1xuICAgICAgICAgICAgICAgIHggKz0gc2VsZi5HUklEX1NJWkU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSBzZWxmLkxJTkVfTlVNQkVSOyBpKyspIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRyYXdMaW5lKDAsIHksIGZpZWxkU2l6ZSwgeSk7XG4gICAgICAgICAgICAgICAgeSArPSBzZWxmLkdSSURfU0laRTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGRyYXdSZWN0OiBmdW5jdGlvbih4MSwgeTEsIHgyLCB5MiwgY29sb3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsU3R5bGUgPSB0eXBlb2YgY29sb3IgIT09ICd1bmRlZmluZWQnID8gY29sb3IgOiAnIzAwMDAwMCc7XG4gICAgICAgICAgICBzZWxmLmN0eC5maWxsUmVjdCh4MSwgeTEsIHgyLCB5Mik7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBkcmF3TGluZTogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIsIGNvbG9yLCB3aWR0aCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZVN0eWxlID0gdHlwZW9mIGNvbG9yICE9PSAndW5kZWZpbmVkJyA/IGNvbG9yIDogJyMwMDAwMDAnO1xuICAgICAgICAgICAgc2VsZi5jdHgubGluZVdpZHRoID0gdHlwZW9mIHdpZHRoICE9PSAndW5kZWZpbmVkJyA/IHdpZHRoIDogMTtcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5tb3ZlVG8oeDEsIHkxKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmxpbmVUbyh4MiwgeTIpO1xuICAgICAgICAgICAgc2VsZi5jdHguY2xvc2VQYXRoKCk7XG5cbiAgICAgICAgICAgIHNlbGYuY3R4LnN0cm9rZSgpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc3RhcnRHYW1lOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBjZW50ZXIgPSBzZWxmLkdSSURfU0laRSAqICgoc2VsZi5MSU5FX05VTUJFUiAtIDEpIC8gMik7XG4gICAgICAgICAgICBjb25zdCBkaWZmID0gKHNlbGYuR1JJRF9TSVpFIC8gMik7XG4gICAgICAgICAgICBsZXQgZGlyMSA9IC0xO1xuICAgICAgICAgICAgbGV0IGRpcjIgPSAtMTtcbiAgICAgICAgICAgIGxldCBwb3NYLCBwb3NZO1xuICAgICAgICAgICAgbGV0IGlzV2hpdGUgPSAxO1xuICAgICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgcjogc2VsZi5SXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBzZXRGaXJzdFN0b25lKCcjZmZmZmZmJyk7XG4gICAgICAgICAgICBkaXIxICo9IC0xO1xuICAgICAgICAgICAgaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgIHNldEZpcnN0U3RvbmUoJyMwMDAwMDAnKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gc2V0Rmlyc3RTdG9uZShjb2xvcikge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBvc1ggPSBjZW50ZXIgKyBkaXIxICogZGlmZjtcbiAgICAgICAgICAgICAgICAgICAgcG9zWSA9IGNlbnRlciArIGRpcjIgKiBkaWZmO1xuXG4gICAgICAgICAgICAgICAgICAgIGRhdGEueCA9IHBvc1g7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEueSA9IHBvc1k7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEuY29sb3IgPSBjb2xvcjtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgc3RvbmUgPSBuZXcgd2luZG93Lm15T3RoZWxsby5TdG9uZShzZWxmLmN0eCwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHN0b25lLmRyYXdBcmMoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHNlbGYuYm9hcmRbTWF0aC5mbG9vcihwb3NZIC8gc2VsZi5HUklEX1NJWkUpXVtNYXRoLmZsb29yKHBvc1ggLyBzZWxmLkdSSURfU0laRSldO1xuICAgICAgICAgICAgICAgICAgICBvYmouaW5zdGFuY2UgPSBzdG9uZTtcbiAgICAgICAgICAgICAgICAgICAgb2JqLmlzV2hpdGUgPSBpc1doaXRlO1xuXG4gICAgICAgICAgICAgICAgICAgIGRpcjEgKj0gLTE7XG4gICAgICAgICAgICAgICAgICAgIGRpcjIgKj0gLTE7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cblxuICAgICAgICBwdXRTdG9uZTogZnVuY3Rpb24oY2xpY2tlZFgsIGNsaWNrZWRZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IG50aEdyaWRYID0gTWF0aC5mbG9vcihjbGlja2VkWCAvIHNlbGYuR1JJRF9TSVpFKTtcbiAgICAgICAgICAgIGxldCBudGhHcmlkWSA9IE1hdGguZmxvb3IoY2xpY2tlZFkgLyBzZWxmLkdSSURfU0laRSk7XG5cbiAgICAgICAgICAgIGlmICghc2VsZi5jaGVja1ZhY2FuY3kobnRoR3JpZFgsIG50aEdyaWRZKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmICghc2VsZi5jaGVja05laWdoYm9yKG50aEdyaWRYLCBudGhHcmlkWSkpIHtcbiAgICAgICAgICAgIC8vICAgIHJldHVybjtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vIGlmICghc2VsZi5jaGVja0F2YWlsYWJpbGl0eShudGhHcmlkWCwgbnRoR3JpZFkpKSB7XG4gICAgICAgICAgICAvLyAgICAvLyByZXR1cm47XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIHNlbGYuaXNXaGl0ZSAqPSAtMTtcbiAgICAgICAgICAgIGNvbG9yID0gc2VsZi5pc1doaXRlID4gMCA/ICcjZmZmZmZmJyA6ICcjMDAwMDAwJztcblxuICAgICAgICAgICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgeDogKHNlbGYuR1JJRF9TSVpFICogbnRoR3JpZFgpICsgKHNlbGYuR1JJRF9TSVpFIC8gMiksXG4gICAgICAgICAgICAgICAgeTogKHNlbGYuR1JJRF9TSVpFICogbnRoR3JpZFkpICsgKHNlbGYuR1JJRF9TSVpFIC8gMiksXG4gICAgICAgICAgICAgICAgcjogc2VsZi5SLFxuICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvclxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbGV0IHN0b25lID0gbmV3IHdpbmRvdy5teU90aGVsbG8uU3RvbmUoc2VsZi5jdHgsIGRhdGEpO1xuICAgICAgICAgICAgc3RvbmUuZHJhd0FyYyhkYXRhKTtcblxuICAgICAgICAgICAgbGV0IG9iaiA9IHNlbGYuYm9hcmRbbnRoR3JpZFldW250aEdyaWRYXTtcbiAgICAgICAgICAgIG9iai5pbnN0YW5jZSA9IHN0b25lO1xuICAgICAgICAgICAgb2JqLmlzV2hpdGUgPSBzZWxmLmlzV2hpdGU7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjaGVja1ZhY2FuY3k6IGZ1bmN0aW9uKG50aFgsIG50aFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2VsZi5ib2FyZFtudGhZXVtudGhYXSkubGVuZ3RoIDw9IDA7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjaGVja05laWdoYm9yOiBmdW5jdGlvbihudGhYLCBudGhZKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgbGV0IGhhc05laWdoYm9yID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGxldCBuZWlnaGJvcnMgPSBbXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgKyAxXSwgICAgICAgLy8g5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZICsgMV0sICAgLy8g5Y+z5LiKXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZXSwgICAgICAgLy8g5Y+zXG4gICAgICAgICAgICAgICAgW250aFggKyAxLCBudGhZIC0gMV0sICAgLy8g5Y+z5LiLXG4gICAgICAgICAgICAgICAgW250aFgsIG50aFkgLSAxXSwgICAgICAgLy8g5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZIC0gMV0sICAgLy8g5bem5LiLXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZXSwgICAgICAgLy8g5bemXG4gICAgICAgICAgICAgICAgW250aFggLSAxLCBudGhZICsgMV0gICAgLy8g5bem5LiKXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gc2VsZi5zdG9uZVBvc2VzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIGxlbiA9IG5laWdoYm9ycy5sZW5ndGg7IGogPCBsZW47IGorKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1swXSA9PT0gbmVpZ2hib3JzW2pdWzBdICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5wb3NbMV0gPT09IG5laWdoYm9yc1tqXVsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGFzTmVpZ2hib3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGhhc05laWdoYm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGhhc05laWdoYm9yO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNoZWNrQXZhaWxhYmlsaXR5OiBmdW5jdGlvbihjbGlja2VkWCwgY2xpY2tlZFkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBjb25zdCBNQVhfQ09VTlQgPSA3O1xuICAgICAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgICAgIGxldCB0bXBGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgaXNBdmFpbGFibGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8g572u44GR44KL5p2h5Lu2XG4gICAgICAgICAgICAvLyDlt6blj7PjgIHkuIrkuIvjgIHmlpzjgoE0NeW6puS4iuOBq+WQjOOBmOiJsuOBruefs+OBjOOBguOCiyDjgYvjgaQg44Gd44Gu5ZCM44GY6Imy44Gu55+z44Go6Ieq6Lqr44Gu6ZaT44Gr6ZqZ6ZaT44Gq44GP5Yil44Gu6Imy44Gu55+z44GM44GC44KLXG5cbiAgICAgICAgICAgIC8vIOS4iiAgICBbbnRoWCwgbnRoWSArIDFdLFxuICAgICAgICAgICAgLy8g5Y+z5LiKICAgW250aFggKyAxLCBudGhZICsgMV0sXG4gICAgICAgICAgICAvLyDlj7MgICAgW250aFggKyAxLCBudGhZXSxcbiAgICAgICAgICAgIC8vIOWPs+S4iyAgIFtudGhYICsgMSwgbnRoWSAtIDFdLFxuICAgICAgICAgICAgLy8g5LiLICAgIFtudGhYLCBudGhZIC0gMV0sXG4gICAgICAgICAgICAvLyDlt6bkuIsgICBbbnRoWCAtIDEsIG50aFkgLSAxXSxcbiAgICAgICAgICAgIC8vIOW3piAgICBbbnRoWCAtIDEsIG50aFldLFxuICAgICAgICAgICAgLy8g5bem5LiKICAgW250aFggLSAxLCBudGhZICsgMV1cbiAgICAgICAgICAgIC8vIOOBp+OBneOCjOOBnuOCjOODgeOCp+ODg+OCr+OBmeOCi++8n1xuXG4gICAgICAgICAgICBjaGVja1RvcCgpO1xuXG4gICAgICAgICAgICAvLyDkuIrjg4Hjgqfjg4Pjgq9cbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrVG9wKCkge1xuXG4gICAgICAgICAgICAgICAgY291bnQgPSAwO1xuICAgICAgICAgICAgICAgIGxldCB0bXBGbGFnID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0gc2VsZi5zdG9uZVBvc2VzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgTUFYX0NPVU5UOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWNrZWRZIC0gaiA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Ieq6Lqr44Go5ZCM5YiX44GL44Gk5ZCM6KGM44Gr55+z44GM44GC44KK44CB44GL44Gk5ZCM44GY6Imy44Gu5aC05ZCI77yI6Ieq6Lqr44Gr6L+R44GE5L2N572u44GL44KJ5Yik5a6a77yJXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1swXSA9PT0gY2xpY2tlZFggJiYgc2VsZi5zdG9uZVBvc2VzW2ldLnBvc1sxXSA9PT0gY2xpY2tlZFkgLSBqICYmIHNlbGYuc3RvbmVQb3Nlc1tpXS5pc1doaXRlID09PSBzZWxmLmlzV2hpdGUgKiAtMSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzW2ldKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiHqui6q+OBqOWQjOWIl+OBi+OBpOWQjOihjOOBq+OBguOCi+WQjOOBmOiJsuOBruefs+OBi+OCieOAgeOBi+OBpOWQjOOBmOiJsuOBruWgtOWQiO+8iOiHqui6q+OBq+i/keOBhOS9jee9ruOBi+OCieWIpOWumu+8iVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGsgPSAxOyBrIDwgajsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLnN0b25lUG9zZXNbaV0ucG9zWzFdID09PSBjbGlja2VkWSAtIGsgJiYgc2VsZi5zdG9uZVBvc2VzW2ldLmlzV2hpdGUgPT09IHNlbGYuaXNXaGl0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRtcEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNlbGYuc3RvbmVQb3Nlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG1wRmxhZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaXNBdmFpbGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRtcEZsYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH1cblxuXG5cblxuXG5cblxuXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5teU90aGVsbG8gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHdpbmRvdy5teU90aGVsbG8gPSB7fTtcbiAgICB9XG4gICAgd2luZG93Lm15T3RoZWxsby5Cb2FyZE1hbmFnZXIgPSBCb2FyZE1hbmFnZXI7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IFBsYXllciA9IGZ1bmN0aW9uKGNhbnZhcywgZGF0YSkge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBzZWxmLmNhbnZhcyA9IGNhbnZhcztcblxuICAgICAgICBzZWxmLmNvbG9yID0gZGF0YS5jb2xvcjtcbiAgICAgICAgc2VsZi5zdG9uZXMgPSBbXTtcblxuICAgICAgICBzZWxmLmluaXQoKTtcbiAgICB9O1xuXG4gICAgUGxheWVyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBzZWxmLnNldEV2ZW50KCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIHNlbGYuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGUub2Zmc2V0WCk7XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdldENsaWNrUG9zOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlBsYXllciA9IFBsYXllcjtcblxufSgpKTsiLCI7KGZ1bmN0aW9uKCkge1xuXG4gICAgY29uc3QgU3RvbmUgPSBmdW5jdGlvbihjdHgsIGRhdGEpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgc2VsZi5jdHggPSBjdHg7XG4gICAgICAgIHNlbGYuY29sb3IgPSBkYXRhLmNvbG9yO1xuXG4gICAgfTtcblxuICAgIFN0b25lLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBkcmF3QXJjOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgc2VsZi5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBzZWxmLmN0eC5hcmMoZGF0YS54LCBkYXRhLnksIGRhdGEuciwgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xuICAgICAgICAgICAgc2VsZi5jdHguZmlsbFN0eWxlID0gZGF0YS5jb2xvcjtcbiAgICAgICAgICAgIHNlbGYuY3R4LmZpbGwoKTtcbiAgICAgICAgICAgIHNlbGYuY3R4LmNsb3NlUGF0aCgpO1xuXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm15T3RoZWxsbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgd2luZG93Lm15T3RoZWxsbyA9IHt9O1xuICAgIH1cbiAgICB3aW5kb3cubXlPdGhlbGxvLlN0b25lID0gU3RvbmU7XG5cbn0oKSk7IiwiOyhmdW5jdGlvbigpIHtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcblxuICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5cbiAgICAgICAgaWYgKCFjYW52YXMuZ2V0Q29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmFwcGVyJyk7XG4gICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICBjdHguY2FudmFzLndpZHRoID0gd3JhcHBlci5jbGllbnRXaWR0aDtcbiAgICAgICAgY3R4LmNhbnZhcy5oZWlnaHQgPSB3cmFwcGVyLmNsaWVudEhlaWdodDtcblxuICAgICAgICBsZXQgcGxheWVyRGF0YSA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnd2hpdGUnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZTogbnVsbCxcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgICAgIGNvbnN0IGJvYXJkID0gbmV3IG15T3RoZWxsby5Cb2FyZE1hbmFnZXIoY3R4KTtcblxuICAgICAgICBib2FyZC5zdGFydEdhbWUoKTtcblxuICAgICAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cbiAgICAgICAgICAgIGJvYXJkLnB1dFN0b25lKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgfSk7XG5cblxuICAgICAgICAvLyDjg5XjgqPjg7zjg6vjg4njgpLmm7jjgY/vvIg4eDjvvIlcbiAgICAgICAgLy8g5ZCE44Oe44K555uu44Gu44Ko44Oq44Ki5oOF5aCx44KS5L+d5oyB77yIc3RhcnRYLCBzdGFydFksIGVuZFgsIGVuZFnvvIlcbiAgICAgICAgLy8gICAgICDjgq/jg6rjg4Pjgq/jgZfjgZ/kvY3nva7jgahjYW52YXPkuIrjga7kvY3nva7jga7lpInmj5vjgYzlv4XopoHvvJ9cbiAgICAgICAgLy8g44OX44Os44Kk44Ok44O855m944O76buS44KS44K744OD44OIXG4gICAgICAgIC8vICAgICAg44OV44Op44Kw44Gr44GZ44KL77yfXG4gICAgICAgIC8vIOS4reWkruOBq+eZvem7kjLjgZPjgZrjgaTjgrvjg4Pjg4hcblxuICAgICAgICAvLyDlkITjg5fjg6zjgqTjg6Tjg7zjga7nva7jgYTjgZ/nn7PjgpLkv53mjIHjgZnjgovphY3liJdcbiAgICAgICAgLy9cblxuXG5cbiAgICB9KTtcblxufSgpKTtcblxuLyoqXG4gKiAvLyBUT0RPIOizquWVj1xuICpcbiAqIDEuXG4g44CM5Yik5a6a44GZ44KL44CN44Go44GE44GG6Iux6Kqe44Gv5L2V44KS5L2/44Gj44Gm44G+44GZ44GL77yfXG5cbiBmaW5kPyBqdWRnZT8gZGVjaWRlP1xuXG5cbiAyLlxuIGNocm9tZeOBrmRlduODhOODvOODq+OBp+OCpOODs+OCueOCv+ODs+OCueOBq+WFpeOBo+OBpuOBhOOCi3Tjgajjga/jgarjgpPjga7mhI/lkbPjgIHnlaXvvIjvvJ/vvInjgafjgZnjgYvvvJ/jgqTjg7Pjgrnjgr/jg7PjgrnjgpLjg63jgrDjgavlh7rjgZnjgah044Go44Gq44KL77yfXG4gYm9hcmQuc3RhcnRHYW1l44Gu5pyA5b6M44GnY29uc29sZS5sb2coc2VsZi5zdG9uZVBvc2VzKTvjgZnjgovjgajnorroqo3jgafjgY3jgotcblxuICovXG4iXX0=